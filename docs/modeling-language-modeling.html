---

title: modeling.language_modeling


keywords: fastai
sidebar: home_sidebar

summary: "This module contains custom models, custom splitters, etc... for both causal and MLM language modeling tasks. This includes things like training BERT from scratch or fine-tuning a particular pre-trained LM on your own corpus."
description: "This module contains custom models, custom splitters, etc... for both causal and MLM language modeling tasks. This includes things like training BERT from scratch or fine-tuning a particular pre-trained LM on your own corpus."
nb_path: "nbs/02_modeling-language-modeling.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/02_modeling-language-modeling.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>What we&#39;re running with at the time this documentation was generated:
torch: 1.10.1+cu111
fastai: 2.5.3
transformers: 4.16.2
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Setup">Setup<a class="anchor-link" href="#Setup"> </a></h2><p>For this example, we'll use the <code>WIKITEXT_TINY</code> dataset available from fastai to demonstrate how to configure BLURR code for language modeling</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wiki_path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">WIKITEXT_TINY</span><span class="p">)</span>

<span class="n">train_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">wiki_path</span> <span class="o">/</span> <span class="s2">&quot;train.csv&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">valid_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">wiki_path</span> <span class="o">/</span> <span class="s2">&quot;test.csv&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="n">train_df</span><span class="p">[</span><span class="s2">&quot;is_valid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">valid_df</span><span class="p">[</span><span class="s2">&quot;is_valid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train_df</span><span class="p">,</span> <span class="n">valid_df</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>662
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>is_valid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>\n = 2013 – 14 York City F.C. season = \n \n The 2013 – 14 season was the &lt;unk&gt; season of competitive association football and 77th season in the Football League played by York City Football Club , a professional football club based in York , North Yorkshire , England . Their 17th @-@ place finish in 2012 – 13 meant it was their second consecutive season in League Two . The season ran from 1 July 2013 to 30 June 2014 . \n Nigel Worthington , starting his first full season as York manager , made eight permanent summer signings . By the turn of the year York were only above the relegation z...</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>\n = Big Boy ( song ) = \n \n " Big Boy " &lt;unk&gt; " I 'm A Big Boy Now " was the first single ever recorded by the Jackson 5 , which was released by Steeltown Records in January 1968 . The group played instruments on many of their Steeltown compositions , including " Big Boy " . The song was neither a critical nor commercial success , but the Jackson family were delighted with the outcome nonetheless . \n The Jackson 5 would release a second single with Steeltown Records before moving to Motown Records . The group 's recordings at Steeltown Records were thought to be lost , but they were re...</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>\n = The Remix ( Lady Gaga album ) = \n \n The Remix is a remix album by American recording artist Lady Gaga . Released in Japan on March 3 , 2010 , it contains remixes of the songs from her first studio album , The Fame ( 2008 ) , and her third extended play , The Fame Monster ( 2009 ) . A revised version of the track list was prepared for release in additional markets , beginning with Mexico on May 3 , 2010 . A number of recording artists have produced the songs , including Pet Shop Boys , Passion Pit and The Sound of Arrows . The remixed versions feature both uptempo and &lt;unk&gt; composit...</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>\n = New Year 's Eve ( Up All Night ) = \n \n " New Year 's Eve " is the twelfth episode of the first season of the American comedy television series Up All Night . The episode originally aired on NBC in the United States on January 12 , 2012 . It was written by Erica &lt;unk&gt; and was directed by Beth McCarthy @-@ Miller . The episode also featured a guest appearance from Jason Lee as Chris and Reagan 's neighbor and Ava 's boyfriend , Kevin . \n During Reagan ( Christina Applegate ) and Chris 's ( Will &lt;unk&gt; ) first New Year 's Eve game night , Reagan 's competitiveness comes out causing Ch...</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>\n = Geopyxis carbonaria = \n \n Geopyxis carbonaria is a species of fungus in the genus Geopyxis , family &lt;unk&gt; . First described to science in 1805 , and given its current name in 1889 , the species is commonly known as the charcoal loving elf @-@ cup , dwarf &lt;unk&gt; cup , &lt;unk&gt; &lt;unk&gt; cup , or pixie cup . The small , &lt;unk&gt; @-@ shaped fruitbodies of the fungus are reddish @-@ brown with a whitish fringe and measure up to 2 cm ( 0 @.@ 8 in ) across . They have a short , tapered stalk . Fruitbodies are commonly found on soil where brush has recently been burned , sometimes in great numbers ....</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Mid-level-API">Mid-level API<a class="anchor-link" href="#Mid-level-API"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="LMMetricsCallback"><a href="/blurr/modeling-language-modeling.html#LMMetricsCallback"><code>LMMetricsCallback</code></a><a class="anchor-link" href="#LMMetricsCallback"> </a></h3><p>In this section, we'll add helpful metrics for calculating accuracy and perplexity for both causal and masked language modeling tasks.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LMMetricsCallback" class="doc_header"><code>class</code> <code>LMMetricsCallback</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/language_modeling.py#L42" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LMMetricsCallback</code>(<strong>**<code>kwargs</code></strong>) :: <code>Callback</code></p>
</blockquote>
<p>A fastai friendly metric implemented as a callback so that we can handle use cases where we don't
want to count tokens marked to be ignored or else not count batches where there are no targs</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Examples">Examples<a class="anchor-link" href="#Examples"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Causal-Language-Modeling">Causal Language Modeling<a class="anchor-link" href="#Causal-Language-Modeling"> </a></h4><p>In causal language modeling, we are attempting to predict the next token given those before it.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_cls</span> <span class="o">=</span> <span class="n">AutoModelForCausalLM</span>

<span class="n">pretrained_model_name</span> <span class="o">=</span> <span class="s2">&quot;gpt2&quot;</span>
<span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_config</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">hf_model</span> <span class="o">=</span> <span class="n">BLURR</span><span class="o">.</span><span class="n">get_hf_objects</span><span class="p">(</span><span class="n">pretrained_model_name</span><span class="p">,</span> <span class="n">model_cls</span><span class="o">=</span><span class="n">model_cls</span><span class="p">)</span>

<span class="k">if</span> <span class="n">hf_tokenizer</span><span class="o">.</span><span class="n">pad_token</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">hf_tokenizer</span><span class="o">.</span><span class="n">pad_token</span> <span class="o">=</span> <span class="s2">&quot;[PAD]&quot;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Using pad_token, but it is not set yet.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bbtfm</span> <span class="o">=</span> <span class="n">LMBatchTokenizeTransform</span><span class="p">(</span><span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_config</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">hf_model</span><span class="p">,</span> <span class="n">lm_strategy_cls</span><span class="o">=</span><span class="n">CausalLMStrategy</span><span class="p">)</span>
<span class="n">blocks</span> <span class="o">=</span> <span class="p">(</span><span class="n">TextBlock</span><span class="p">(</span><span class="n">batch_tokenize_tfm</span><span class="o">=</span><span class="n">bbtfm</span><span class="p">,</span> <span class="n">input_return_type</span><span class="o">=</span><span class="n">CausalLMTextInput</span><span class="p">),</span> <span class="n">noop</span><span class="p">)</span>

<span class="n">dblock</span> <span class="o">=</span> <span class="n">DataBlock</span><span class="p">(</span><span class="n">blocks</span><span class="o">=</span><span class="n">blocks</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">ColReader</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">splitter</span><span class="o">=</span><span class="n">ColSplitter</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s2">&quot;is_valid&quot;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">dblock</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
<span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;input_ids&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(torch.Size([2, 1024]), torch.Size([2, 1024]), torch.Size([2, 1024]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span><span class="o">.</span><span class="n">show_batch</span><span class="p">(</span><span class="n">dataloaders</span><span class="o">=</span><span class="n">dls</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">trunc_at</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>\n = Bob Dylan = \n \n Bob Dylan ( / &lt;unk&gt; / ; born Robert Allen Zimmerman, May 24, 1941 ) is an American singer @-@ songwriter, artist and writer. He has been influential in popular music and culture for more than five decades. Much of his most celebrated work dates from the 1960s when his songs chronicled social unrest, although Dylan repudiated suggestions from journalists that he was a spokesman for his generation. Nevertheless, early songs such as " Blowin'in the Wind " and " The Times They A</td>
      <td>\n = Bob Dylan = \n \n Bob Dylan ( / &lt;unk&gt; / ; born Robert Allen Zimmerman, May 24, 1941 ) is an American singer @-@ songwriter, artist and writer. He has been influential in popular music and culture for more than five decades. Much of his most celebrated work dates from the 1960s when his songs chronicled social unrest, although Dylan repudiated suggestions from journalists that he was a spokesman for his generation. Nevertheless, early songs such as " Blowin'in the Wind " and " The Times They Ar</td>
    </tr>
    <tr>
      <th>1</th>
      <td>\n = Battle of Romani = \n \n The Battle of Romani was the last ground attack of the Central Powers on the Suez Canal at the beginning of the Sinai and Palestine Campaign during the First World War. The battle was fought between 3 and 5 August 1916 near the Egyptian town of Romani and the site of ancient Pelusium on the Sinai Peninsula, 23 miles ( 37 km ) east of the Suez Canal. This victory by the 52nd ( Lowland ) Division and the Anzac Mounted Division of the Egyptian Expeditionary Force ( EEF )</td>
      <td>\n = Battle of Romani = \n \n The Battle of Romani was the last ground attack of the Central Powers on the Suez Canal at the beginning of the Sinai and Palestine Campaign during the First World War. The battle was fought between 3 and 5 August 1916 near the Egyptian town of Romani and the site of ancient Pelusium on the Sinai Peninsula, 23 miles ( 37 km ) east of the Suez Canal. This victory by the 52nd ( Lowland ) Division and the Anzac Mounted Division of the Egyptian Expeditionary Force ( EEF )</td>
    </tr>
  </tbody>
</table></div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Training">Training<a class="anchor-link" href="#Training"> </a></h5>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">BaseModelWrapper</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span>
<span class="n">fit_cbs</span> <span class="o">=</span> <span class="p">[</span><span class="n">LMMetricsCallback</span><span class="p">()]</span>

<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span>
    <span class="n">dls</span><span class="p">,</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="n">opt_func</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">Adam</span><span class="p">),</span>
    <span class="n">loss_func</span><span class="o">=</span><span class="n">PreCalculatedCrossEntropyLoss</span><span class="p">(),</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">BaseModelCallback</span><span class="p">],</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">perplexity</span><span class="p">],</span>
    <span class="n">splitter</span><span class="o">=</span><span class="n">blurr_splitter</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">to_fp16</span><span class="p">()</span>

<span class="n">learn</span><span class="o">.</span><span class="n">freeze</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># learn.summary()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># preds = learn.model(b[0])</span>
<span class="c1"># len(preds),preds[0], preds[1].shape</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">learn</span><span class="o">.</span><span class="n">opt</span><span class="o">.</span><span class="n">param_groups</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>5
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">(</span><span class="n">suggest_funcs</span><span class="o">=</span><span class="p">[</span><span class="n">minimum</span><span class="p">,</span> <span class="n">steep</span><span class="p">,</span> <span class="n">valley</span><span class="p">,</span> <span class="n">slide</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "></div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(minimum=0.002290867641568184, steep=3.311311274956097e-06, valley=0.0006918309954926372, slide=0.001737800776027143)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="mf">3e-3</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="n">fit_cbs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>perplexity</th>
      <th>lm_accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>3.024776</td>
      <td>2.801077</td>
      <td>16.462370</td>
      <td>0.457364</td>
      <td>01:50</td>
    </tr>
  </tbody>
</table></div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Showing-results">Showing results<a class="anchor-link" href="#Showing-results"> </a></h5><p>Below we'll add in additional functionality to more intuitively show the results of our model.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">learner</span><span class="o">=</span><span class="n">learn</span><span class="p">,</span> <span class="n">trunc_at</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "></div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea "><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>target</th>
      <th>prediction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>\n = Military history of Australia = \n \n The military history of Australia spans the nation's 220 @-@ year modern history, from the early Australian frontier wars between &lt;unk&gt; and Europeans to the ongoing conflicts in Iraq and Afghanistan in the ear</td>
      <td>\n = Military history of Australia = \n \n The military history of Australia spans the nation's 220 @-@ year modern history, from the early Australian frontier wars between &lt;unk&gt; and Europeans to the ongoing conflicts in Iraq and Afghanistan in the earl</td>
      <td>\n = = / = the = \n \n  Australian history of Australia is the period froms history- &lt;@ century history history. from the early 19 colonies to to theunk&gt; to &lt; to the early conflict between the and Afghanistan. the late 20st century.  the history is not,</td>
    </tr>
    <tr>
      <th>1</th>
      <td>\n = Air Rhodesia Flight &lt;unk&gt; = \n \n Air Rhodesia Flight &lt;unk&gt; was a scheduled passenger flight that was shot down by the Zimbabwe People's Revolutionary Army ( &lt;unk&gt; ) on 3 September 1978, during the Rhodesian Bush War. The aircraft involved, a Vick</td>
      <td>\n = Air Rhodesia Flight &lt;unk&gt; = \n \n Air Rhodesia Flight &lt;unk&gt; was a scheduled passenger flight that was shot down by the Zimbabwe People's Revolutionary Army ( &lt;unk&gt; ) on 3 September 1978, during the Rhodesian Bush War. The aircraft involved, a Vicke</td>
      <td>\n = = Force = = # /&gt; = \n \n  Rhodesia Flight (unk&gt; was a flight flight flight from was scheduled down by a Uan'ss Liberation Army (Zunk&gt; ) on July August,. killing the countryian militaryi. The plane was in the Boeing- 'ickersount, &lt; "unk&gt;, was a from</td>
    </tr>
  </tbody>
</table></div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Prediction">Prediction<a class="anchor-link" href="#Prediction"> </a></h5>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">blurr_generate</span><span class="p">(</span><span class="s2">&quot;Blurr is fun to work with because&quot;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">do_sample</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">top_k</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[{&#39;generated_texts&#39;: &#39; Blurr is fun to work with because it makes you feel like you are being watched – which I do think is more than ever – but it really is fun for all to play with!\n\nIf you can do an &#34;extra mile of&#39;}]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Masked-Language-Modeling">Masked Language Modeling<a class="anchor-link" href="#Masked-Language-Modeling"> </a></h4><p>In masked language modeling (MLM), we are attempting to predict the <strong><em>masked</em></strong> tokens. In Blurr, these are encapsulated by classes implementing the <a href="/blurr/data-language-modeling.html#BaseLMStrategy"><code>BaseLMStrategy</code></a> base class.</p>
<p>For a list of some of the more common strategies, see table 3 of the <a href="https://arxiv.org/abs/1910.10683">Exploring the Limits of Transfer Learning with a Unified Text-to-Text Transformer</a> paper.  When fine-tuning a MLM model. you'll want to make sure you use the same approach as the model authors should you be looking to reproduce their results ... but our approach here makes it easy to play with different strategies regardless.</p>
<p>In the example below, we'll tell Blurr we want to use the BERT-style masking strategy.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_cls</span> <span class="o">=</span> <span class="n">AutoModelForMaskedLM</span>

<span class="n">pretrained_model_name</span> <span class="o">=</span> <span class="s2">&quot;distilroberta-base&quot;</span>
<span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_config</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">hf_model</span> <span class="o">=</span> <span class="n">BLURR</span><span class="o">.</span><span class="n">get_hf_objects</span><span class="p">(</span><span class="n">pretrained_model_name</span><span class="p">,</span> <span class="n">model_cls</span><span class="o">=</span><span class="n">model_cls</span><span class="p">)</span>

<span class="k">if</span> <span class="n">hf_tokenizer</span><span class="o">.</span><span class="n">pad_token</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">hf_tokenizer</span><span class="o">.</span><span class="n">pad_token</span> <span class="o">=</span> <span class="s2">&quot;[PAD]&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bbtfm</span> <span class="o">=</span> <span class="n">LMBatchTokenizeTransform</span><span class="p">(</span><span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_config</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">hf_model</span><span class="p">,</span> <span class="n">lm_strategy_cls</span><span class="o">=</span><span class="n">BertMLMStrategy</span><span class="p">)</span>
<span class="n">blocks</span> <span class="o">=</span> <span class="p">(</span><span class="n">TextBlock</span><span class="p">(</span><span class="n">batch_tokenize_tfm</span><span class="o">=</span><span class="n">bbtfm</span><span class="p">,</span> <span class="n">input_return_type</span><span class="o">=</span><span class="n">MLMTextInput</span><span class="p">),</span> <span class="n">noop</span><span class="p">)</span>

<span class="n">dblock</span> <span class="o">=</span> <span class="n">DataBlock</span><span class="p">(</span><span class="n">blocks</span><span class="o">=</span><span class="n">blocks</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">ColReader</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">splitter</span><span class="o">=</span><span class="n">ColSplitter</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s2">&quot;is_valid&quot;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">dblock</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
<span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;input_ids&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(torch.Size([2, 512]), torch.Size([2, 512]), torch.Size([2, 512]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span><span class="o">.</span><span class="n">show_batch</span><span class="p">(</span><span class="n">dataloaders</span><span class="o">=</span><span class="n">dls</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">trunc_at</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[ ] \n  =  Bob  Dylan &lt;mask&gt;   \n   \n  Bob  Dylan &lt;mask&gt;  /    /  ; &lt;mask&gt; &lt;mask&gt;  Allen [ Zimmerman] ,  May  24 , &lt;mask&gt; &lt;mask&gt;  is  an  American  singer &lt;mask&gt; - @  song writer ,  artist &lt;mask&gt;  writer .  He  has  been [ influential]  in &lt;mask&gt;  music  and  culture  for  more  than  five  decades .  Much  of  his  most  celebrated [culosis] &lt;mask&gt;  from  the  1960 &lt;mask&gt;  when  his  songs &lt;mask&gt; led  social  unrest [whatever]  although &lt;mask&gt;  repud iated  suggestions [ from]  journalists  that  he  was  a  spokesman &lt;mask&gt;  his  generation .  Nevertheless ,  early  songs  such  as  " &lt;mask&gt; &lt;mask&gt;  ' &lt;mask&gt;  the [ invoked]  "  and  "  The  Times  They  Are  a  @ - @    '  "  became  an the ms  for  the  American  civil &lt;mask&gt;  and  anti &lt;mask&gt; - @  war  movements .  After  he  left  his  initial  base  in  the  American  folk  music &lt;mask&gt; ,  his [vag]  @ - @  minute  single  "  Like  a  Rolling  Stone  "  altered  the  range  of  popular  music  in  1965 &lt;mask&gt;  His  mid  @ - @  1960 [s]  recordings ,  backed  by  rock  musicians ,  reached  the  top [ scripture] &lt;mask&gt;  the  United  States  music  charts &lt;mask&gt;  also  attracting    and  criticism  from  others  in  the  folk  movement &lt;mask&gt;   \n  Dylan  ' s  lyrics  have  incorporated  various &lt;mask&gt; ,  social ,  philosophical ,  and  literary  influences &lt;mask&gt;  They  defied &lt;mask&gt;  pop  music  conventions  and  appealed  to &lt;mask&gt;  burgeoning  counter culture . &lt;mask&gt;  inspired &lt;mask&gt;  the  performances  of [ Little]  Richard  and  the</td>
      <td>[ ] \n  =  Bob  Dylan [ =]   \n   \n  Bob  Dylan [ (]  /    /  ; [ born] [ Robert]  Allen [ Zimmerman] ,  May  24 , [ 1941] [ )]  is  an  American  singer [ @] - @  song writer ,  artist [ and]  writer .  He  has  been [ influential]  in [ popular]  music  and  culture  for  more  than  five  decades .  Much  of  his  most  celebrated [ work] [ dates]  from  the  1960 [s]  when  his  songs [ chronic] led  social  unrest [,]  although [ Dylan]  repud iated  suggestions [ from]  journalists  that  he  was  a  spokesman [ for]  his  generation .  Nevertheless ,  early  songs  such  as  " [ Blow] [in]  ' [ in]  the [ Wind]  "  and  "  The  Times  They  Are  a  @ - @    '  "  became  an the ms  for  the  American  civil [ rights]  and  anti [ @] - @  war  movements .  After  he  left  his  initial  base  in  the  American  folk  music [ revival] ,  his [ six]  @ - @  minute  single  "  Like  a  Rolling  Stone  "  altered  the  range  of  popular  music  in  1965 [.]  His  mid  @ - @  1960 [s]  recordings ,  backed  by  rock  musicians ,  reached  the  top [ end] [ of]  the  United  States  music  charts [ while]  also  attracting    and  criticism  from  others  in  the  folk  movement [.]   \n  Dylan  ' s  lyrics  have  incorporated  various [ political] ,  social ,  philosophical ,  and  literary  influences [.]  They  defied [ existing]  pop  music  conventions  and  appealed  to [ the]  burgeoning  counter culture . [ Initially]  inspired [ by]  the  performances  of [ Little]  Richard  and  the</td>
    </tr>
    <tr>
      <th>1</th>
      <td>&lt;mask&gt; \n  =  Ireland  = &lt;mask&gt; \n &lt;mask&gt; \n  Ireland  (  /   &lt;mask&gt;  ;  Irish  : &lt;mask&gt;  [    ]  ;  Ulster  @ - @  Scots  :    [   &lt;mask&gt;  )  is  an [ island]  in  the  North  Atlantic [ shack]  It  is &lt;mask&gt;  from  Great  Britain  to  its  east &lt;mask&gt;  the &lt;mask&gt;  Channel ,  the  Irish  Sea ,  and  St  George  ' s  Channel . &lt;mask&gt;  is  the  second  @ - @  largest  island  of  the  British  Isles ,  the  third  @ - @  largest  in  Europe ,  and  the  twentieth  @ - [@]  largest [isdom]  Earth .   \n   &lt;mask&gt;  Ireland  is  divided  between  the  Republic  of  Ireland &lt;mask&gt;  officially [ruit]  Ireland  ) , [ which]  covers  five  @ - @    of  the  island ,  and  Northern  Ireland , &lt;mask&gt;  is  part &lt;mask&gt;  the  United  Kingdom ,  in &lt;mask&gt;  northeast &lt;mask&gt;  the  island .  In  2011  the  population  of [ Ireland]  was  about  6  @ . @  4  million ,  ranking  it  the  second  @ - @  most  populous  island  in [ Stamina]  after  Great  Britain .  Just  under  4  @ &lt;mask&gt; @  6  million  live  in  the  Republic  of  Ireland  and  just  over  1 &lt;mask&gt; . @  8  million  live  in  Northern &lt;mask&gt; .   \n  The  island  ' s  geography  comprises  relatively  low  @ - @  lying  mountains  surrounding  a  central  plain ,  with  several  navig [able]  rivers &lt;mask&gt;  inland .  The &lt;mask&gt;  has  lush  vegetation ,  a  product  of [ its]  mild  but  change able  climate  which</td>
      <td>[ ] \n  =  Ireland  = [ ] \n [ ] \n  Ireland  (  /   [ /]  ;  Irish  : [ ]  [    ]  ;  Ulster  @ - @  Scots  :    [   [ ]]  )  is  an [ island]  in  the  North  Atlantic [.]  It  is [ separated]  from  Great  Britain  to  its  east [ by]  the [ North]  Channel ,  the  Irish  Sea ,  and  St  George  ' s  Channel . [ Ireland]  is  the  second  @ - @  largest  island  of  the  British  Isles ,  the  third  @ - @  largest  in  Europe ,  and  the  twentieth  @ - [@]  largest [ on]  Earth .   \n   [,]  Ireland  is  divided  between  the  Republic  of  Ireland [ (]  officially [ named]  Ireland  ) , [ which]  covers  five  @ - @    of  the  island ,  and  Northern  Ireland , [ which]  is  part [ of]  the  United  Kingdom ,  in [ the]  northeast [ of]  the  island .  In  2011  the  population  of [ Ireland]  was  about  6  @ . @  4  million ,  ranking  it  the  second  @ - @  most  populous  island  in [ Europe]  after  Great  Britain .  Just  under  4  @ [.] @  6  million  live  in  the  Republic  of  Ireland  and  just  over  1 [ @] . @  8  million  live  in  Northern [ Ireland] .   \n  The  island  ' s  geography  comprises  relatively  low  @ - @  lying  mountains  surrounding  a  central  plain ,  with  several  navig [able]  rivers [ extending]  inland .  The [ island]  has  lush  vegetation ,  a  product  of [ its]  mild  but  change able  climate  which</td>
    </tr>
  </tbody>
</table></div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Training">Training<a class="anchor-link" href="#Training"> </a></h5>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">BaseModelWrapper</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span>
<span class="n">fit_cbs</span> <span class="o">=</span> <span class="p">[</span><span class="n">LMMetricsCallback</span><span class="p">()]</span>

<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span>
    <span class="n">dls</span><span class="p">,</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="n">opt_func</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">Adam</span><span class="p">,</span> <span class="n">decouple_wd</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">loss_func</span><span class="o">=</span><span class="n">PreCalculatedCrossEntropyLoss</span><span class="p">(),</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">BaseModelCallback</span><span class="p">],</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">perplexity</span><span class="p">],</span>
    <span class="n">splitter</span><span class="o">=</span><span class="n">blurr_splitter</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">to_fp16</span><span class="p">()</span>

<span class="n">learn</span><span class="o">.</span><span class="n">freeze</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># learn.summary()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">learn</span><span class="o">.</span><span class="n">opt</span><span class="o">.</span><span class="n">param_groups</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>3
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">(</span><span class="n">suggest_funcs</span><span class="o">=</span><span class="p">[</span><span class="n">minimum</span><span class="p">,</span> <span class="n">steep</span><span class="p">,</span> <span class="n">valley</span><span class="p">,</span> <span class="n">slide</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "></div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(minimum=6.309573450380412e-08, steep=6.30957365501672e-05, valley=0.0005754399462603033, slide=0.0003311311302240938)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="n">fit_cbs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>perplexity</th>
      <th>lm_accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1.826493</td>
      <td>1.792364</td>
      <td>6.003631</td>
      <td>0.638858</td>
      <td>00:30</td>
    </tr>
  </tbody>
</table></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Showing-results">Showing results<a class="anchor-link" href="#Showing-results"> </a></h5><p>Below we'll add in additional functionality to more intuitively show the results of our model.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">learner</span><span class="o">=</span><span class="n">learn</span><span class="p">,</span> <span class="n">trunc_at</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "></div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea "><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>target</th>
      <th>prediction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>=  Military &lt;mask&gt; [Maps]  Australia  =   &lt;mask&gt;   \n  The  military  history  of  Australia  spans &lt;mask&gt;  nation &lt;mask&gt; &lt;mask&gt;  220  @ - @  year  modern  history ,  from  the  early [aptop]  frontier  wars  between    and  Europeans &lt;mask&gt;  the  ongoing  conflicts  in  Iraq  and  Afghanistan  in  the &lt;mask&gt;  21 st  century .  Although  this  history  is &lt;mask&gt;  when  compared  to  that &lt;mask&gt;  many  other  nations [Priv] &lt;mask&gt;  has  been  involved  in  numerous &lt;mask&gt;  and  wars , &lt;mask&gt;  war  and  military  service  have  been &lt;mask&gt;  influences  on  Australian  society  and  national  identity , [ including]  the  An zac  spirit .  The  relationship &lt;mask&gt;  war  and [ Australian]  society  has  also  been  shaped  by  the  enduring  themes  of  Australian  strategic  culture  and  its  unique  security &lt;mask&gt; [.]   \n [ As] &lt;mask&gt; &lt;mask&gt; ,  the  Australian  colonies  participated  in  Britain  ' s [ small]  wars  of  the  19 &lt;mask&gt;  century ,  while &lt;mask&gt;  as  a   &lt;mask&gt; ,  and  then  an  independent  nation &lt;mask&gt;  Australia  fought &lt;mask&gt;  the  First  World  War  and  Second  World [ War] ,  as  well  as  in  the &lt;mask&gt;  in  Korea ,  Mal aya ,  B orne o  and  Vietnam  during  the  Cold &lt;mask&gt; .  In  the  Post  @ - @  Vietnam  era  Australian  forces  have  been  involved &lt;mask&gt;  numerous  international  peace &lt;mask&gt;  missions &lt;mask&gt;  through  the  United  Nations  and  other  agencies , &lt;mask&gt; &lt;mask&gt;  the  Sinai ,  Persian &lt;mask&gt; ,   ,  Somalia , [ Trave]  Tim or  and &lt;mask&gt;  Solomon  Islands &lt;mask&gt; &lt;mask&gt;  more  recently &lt;mask&gt; &lt;mask&gt;  also  fought</td>
      <td>=  Military [ history] [ of]  Australia  =   [\n]   \n  The  military  history  of  Australia  spans [ the]  nation [ '] [s]  220  @ - @  year  modern  history ,  from  the  early [ Australian]  frontier  wars  between    and  Europeans [ to]  the  ongoing  conflicts  in  Iraq  and  Afghanistan  in  the [ early]  21 st  century .  Although  this  history  is [ short]  when  compared  to  that [ of]  many  other  nations [,] [ Australia]  has  been  involved  in  numerous [ conflicts]  and  wars , [ and]  war  and  military  service  have  been [ significant]  influences  on  Australian  society  and  national  identity , [ including]  the  An zac  spirit .  The  relationship [ between]  war  and [ Australian]  society  has  also  been  shaped  by  the  enduring  themes  of  Australian  strategic  culture  and  its  unique  security [ dilemma] [.]   \n [ As] [ British] [ ] ,  the  Australian  colonies  participated  in  Britain  ' s [ small]  wars  of  the  19 [th]  century ,  while [ later]  as  a   [ dominion] ,  and  then  an  independent  nation [,]  Australia  fought [ in]  the  First  World  War  and  Second  World [ War] ,  as  well  as  in  the [ wars]  in  Korea ,  Mal aya ,  B orne o  and  Vietnam  during  the  Cold [ War] .  In  the  Post  @ - @  Vietnam  era  Australian  forces  have  been  involved [ in]  numerous  international  peace [keeping]  missions [,]  through  the  United  Nations  and  other  agencies , [ including] [ in]  the  Sinai ,  Persian [ Gulf] ,   ,  Somalia , [ East]  Tim or  and [ the]  Solomon  Islands [,] [ while]  more  recently [ they] [ have]  also  fought</td>
      <td>=  Military [ History] [ of]  Australia  =   [\n]   \n  The  military  history  of  Australia  spans [ the]  nation [ states] [ ]  220  @ - @  year  modern  history ,  from  the  early [ colonial]  frontier  wars  between    and  Europeans [ to]  the  ongoing  conflicts  in  Iraq  and  Afghanistan  in  the [ early]  21 st  century .  Although  this  history  is [ incomplete]  when  compared  to  that [ of]  many  other  nations [ ] [ Australia]  has  been  involved  in  numerous [ conflicts]  and  wars , [ both]  war  and  military  service  have  been [ defining]  influences  on  Australian  society  and  national  identity , [ including]  the  An zac  spirit .  The  relationship [ between]  war  and [ Australian]  society  has  also  been  shaped  by  the  enduring  themes  of  Australian  strategic  culture  and  its  unique  security [ architecture] [.]   \n [ As] [ ] [ ] ,  the  Australian  colonies  participated  in  Britain  ' s [ small]  wars  of  the  19 [th]  century ,  while [ serving]  as  a   [ nation] ,  and  then  an  independent  nation [.]  Australia  fought [ in]  the  First  World  War  and  Second  World [ War] ,  as  well  as  in  the [ conflicts]  in  Korea ,  Mal aya ,  B orne o  and  Vietnam  during  the  Cold [ War] .  In  the  Post  @ - @  Vietnam  era  Australian  forces  have  been  involved [ in]  numerous  international  peace [keeping]  missions [,]  through  the  United  Nations  and  other  agencies , [ including] [ in]  the  Sinai ,  Persian [ Gulf] ,   ,  Somalia , [ East]  Tim or  and [ the]  Solomon  Islands [.] [ and]  more  recently [,] [ have]  also  fought</td>
    </tr>
    <tr>
      <th>1</th>
      <td>=  Air  Rhodes &lt;mask&gt;  Flight   &lt;mask&gt;   \n   \n  Air  Rhodes ia  Flight   [Il]  a &lt;mask&gt; &lt;mask&gt; &lt;mask&gt;  that  was  shot  down &lt;mask&gt;  the  Zimbabwe  People  ' s  Revolutionary  Army  (    )  on  3  September  1978 , &lt;mask&gt; &lt;mask&gt; &lt;mask&gt; ian  Bush  War .  The  aircraft  involved ,  a  V ickers  V isc &lt;mask&gt;  named  the   ,  was  flying  the  last  leg  of  Air &lt;mask&gt; ia  ' &lt;mask&gt;  regular  scheduled  service  from [ marks]  Falls  to  the  capital &lt;mask&gt; &lt;mask&gt; ,  via  the  resort  town  of &lt;mask&gt; .   \n  Soon [ after]  Flight    took  off &lt;mask&gt;  a  group  of &lt;mask&gt;  gu err illas [ scored]  a  direct  hit  on  its  star board  wing  with  a  Soviet  @ - @  made &lt;mask&gt;  2  surface  @ - @ &lt;mask&gt;  @ - &lt;mask&gt; [ air]  infrared &lt;mask&gt;  missile ,  critically  damaging  the  aircraft  and  forcing  an &lt;mask&gt;  landing .  An  attempted &lt;mask&gt;  landing  in  a  cotton  field  just  west  of    was &lt;mask&gt;  by  an  unseen  ditch ,  which  caused &lt;mask&gt; &lt;mask&gt; &lt;mask&gt;  cart wheel  and  break  up .  Of  the  52  passengers  and  four  crew ,  38  died  in  this  crash  ;  the  insurgents [ then]  approached  the  wreckage ,  rounded  up  the  10 &lt;mask&gt;  they &lt;mask&gt;  see  and  massac red  them  with  automatic  gunfire .  Three  passengers  survived  by  hiding  in  the  surrounding  bush ,  while &lt;mask&gt; &lt;mask&gt;  five &lt;mask&gt;  because  they  had  gone &lt;mask&gt;  look &lt;mask&gt; &lt;mask&gt;  before  the  gu err illas  arrived .   &lt;mask&gt;</td>
      <td>=  Air  Rhodes [ia]  Flight   [ =]   \n   \n  Air  Rhodes ia  Flight   [ was]  a [ scheduled] [ passenger] [ flight]  that  was  shot  down [ by]  the  Zimbabwe  People  ' s  Revolutionary  Army  (    )  on  3  September  1978 , [ during] [ the] [ Rhodes] ian  Bush  War .  The  aircraft  involved ,  a  V ickers  V isc [ount]  named  the   ,  was  flying  the  last  leg  of  Air [ Rhodes] ia  ' [s]  regular  scheduled  service  from [ Victoria]  Falls  to  the  capital [ Sal] [isbury] ,  via  the  resort  town  of [ ] .   \n  Soon [ after]  Flight    took  off [,]  a  group  of [ ]  gu err illas [ scored]  a  direct  hit  on  its  star board  wing  with  a  Soviet  @ - @  made [ ]  2  surface  @ - @ [ to]  @ - [@] [ air]  infrared [ ]  missile ,  critically  damaging  the  aircraft  and  forcing  an [ emergency]  landing .  An  attempted [ belly]  landing  in  a  cotton  field  just  west  of    was [ ]  by  an  unseen  ditch ,  which  caused [ the] [ plane] [ to]  cart wheel  and  break  up .  Of  the  52  passengers  and  four  crew ,  38  died  in  this  crash  ;  the  insurgents [ then]  approached  the  wreckage ,  rounded  up  the  10 [ survivors]  they [ could]  see  and  massac red  them  with  automatic  gunfire .  Three  passengers  survived  by  hiding  in  the  surrounding  bush ,  while [ a] [ further]  five [ lived]  because  they  had  gone [ to]  look [ for] [ water]  before  the  gu err illas  arrived .   [\n]</td>
      <td>=  Air  Rhodes [ia]  Flight   [ ]   \n   \n  Air  Rhodes ia  Flight   [,]  a [ ] [ ] [ aircraft]  that  was  shot  down [ by]  the  Zimbabwe  People  ' s  Revolutionary  Army  (    )  on  3  September  1978 , [ during] [ the] [ Rhodes] ian  Bush  War .  The  aircraft  involved ,  a  V ickers  V isc [ount]  named  the   ,  was  flying  the  last  leg  of  Air [ Rhodes] ia  ' [s]  regular  scheduled  service  from [ Victoria]  Falls  to  the  capital [ ] [oria] ,  via  the  resort  town  of [ ] .   \n  Soon [ after]  Flight    took  off [,]  a  group  of [ ]  gu err illas [ scored]  a  direct  hit  on  its  star board  wing  with  a  Soviet  @ - @  made [ ]  2  surface  @ - @ [ made]  @ - [@] [ air]  infrared [ ]  missile ,  critically  damaging  the  aircraft  and  forcing  an [ emergency]  landing .  An  attempted [ crash]  landing  in  a  cotton  field  just  west  of    was [ fo]  by  an  unseen  ditch ,  which  caused [ ] [ ] [ to]  cart wheel  and  break  up .  Of  the  52  passengers  and  four  crew ,  38  died  in  this  crash  ;  the  insurgents [ then]  approached  the  wreckage ,  rounded  up  the  10 [ survivors]  they [ could]  see  and  massac red  them  with  automatic  gunfire .  Three  passengers  survived  by  hiding  in  the  surrounding  bush ,  while [ others] [ lost]  five [ others]  because  they  had  gone [ to]  look [ for] [ry]  before  the  gu err illas  arrived .   [\n]</td>
    </tr>
  </tbody>
</table></div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Prediction">Prediction<a class="anchor-link" href="#Prediction"> </a></h5><p>While <a href="/blurr/modeling-core.html#Learner.blurr_generate"><code>Learner.blurr_generate</code></a> will work well for causal LMs designed for text generation, it won't for MLM models designed to predict masked tokens.  To accomodate the later, we add <a href="/blurr/modeling-language-modeling.html#Learner.blurr_fill_mask"><code>Learner.blurr_fill_mask</code></a> ...</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Learner.blurr_fill_mask" class="doc_header"><code>Learner.blurr_fill_mask</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/language_modeling.py#L213" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Learner.blurr_fill_mask</code>(<strong><code>inp</code></strong>:<code>Union</code>[List[int]<code>,</code>str<code>\], **</code>n_preds<code>**:</code>int<code>=*</code>1<code>*, **\*\*</code>kwargs`**)</p>
</blockquote>
<p>For MLM models</p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>inp</code></strong></td>
<td><code>List[int], str]</code></td>
<td></td>
<td>Your input_ids or raw text string with a <code>hf_tokenizer.mask_token</code></td>
</tr>
<tr>
<td><strong><code>n_preds</code></strong></td>
<td><code>int</code></td>
<td><code>1</code></td>
<td>The number of predictions you want to return for the [MASK]ed token</td>
</tr>
<tr>
<td><strong><code>kwargs</code></strong></td>
<td></td>
<td></td>
<td><em>No Content</em></td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">blurr_fill_mask</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The best place on earth is </span><span class="si">{</span><span class="n">hf_tokenizer</span><span class="o">.</span><span class="n">mask_token</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span> <span class="n">n_preds</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;The best place on earth is here.&#39;,
 &#39;The best place on earth is home.&#39;,
 &#39;The best place on earth is Antarctica.&#39;,
 &#39;The best place on earth is America.&#39;,
 &#39;The best place on earth is heaven.&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="High-level-API">High-level API<a class="anchor-link" href="#High-level-API"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="BlearnerForLM"><a href="/blurr/modeling-language-modeling.html#BlearnerForLM"><code>BlearnerForLM</code></a><a class="anchor-link" href="#BlearnerForLM"> </a></h3><p>We can use the <a href="/blurr/modeling-language-modeling.html#BlearnerForLM"><code>BlearnerForLM</code></a> for either Causal or Masked language models.  With one line of code, we get our DataBlock, DataLoaders, and Blearner with sensible defaults and ready for training</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="BlearnerForLM" class="doc_header"><code>class</code> <code>BlearnerForLM</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/language_modeling.py#L253" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>BlearnerForLM</code>(<strong><code>dls</code></strong>:<code>DataLoaders</code>, <strong><code>hf_model</code></strong>:<code>PreTrainedModel</code>, <strong><code>base_model_cb</code></strong>:<a href="/blurr/modeling-core.html#BaseModelCallback"><code>BaseModelCallback</code></a>=<em><code>BaseModelCallback</code></em>, <strong><code>loss_func</code></strong>=<em><code>None</code></em>, <strong><code>opt_func</code></strong>=<em><code>Adam</code></em>, <strong><code>lr</code></strong>=<em><code>0.001</code></em>, <strong><code>splitter</code></strong>=<em><code>trainable_params</code></em>, <strong><code>cbs</code></strong>=<em><code>None</code></em>, <strong><code>metrics</code></strong>=<em><code>None</code></em>, <strong><code>path</code></strong>=<em><code>None</code></em>, <strong><code>model_dir</code></strong>=<em><code>'models'</code></em>, <strong><code>wd</code></strong>=<em><code>None</code></em>, <strong><code>wd_bn_bias</code></strong>=<em><code>False</code></em>, <strong><code>train_bn</code></strong>=<em><code>True</code></em>, <strong><code>moms</code></strong>=<em><code>(0.95, 0.85, 0.95)</code></em>) :: <a href="/blurr/modeling-core.html#Blearner"><code>Blearner</code></a></p>
</blockquote>
<p>Group together a <code>model</code>, some <code>dls</code> and a <code>loss_func</code> to handle training</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Example">Example<a class="anchor-link" href="#Example"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Causal-language-modeling">Causal language modeling<a class="anchor-link" href="#Causal-language-modeling"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">BlearnerForLM</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;gpt2&quot;</span><span class="p">,</span> <span class="n">text_attr</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dl_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bs&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span><span class="o">.</span><span class="n">to_fp16</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Using pad_token, but it is not set yet.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">dls</span><span class="o">.</span><span class="n">show_batch</span><span class="p">(</span><span class="n">dataloaders</span><span class="o">=</span><span class="n">learn</span><span class="o">.</span><span class="n">dls</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">trunc_at</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>\n = Bob Dylan = \n \n Bob Dylan ( / &lt;unk&gt; / ; born Robert Allen Zimmerman, May 24, 1941 ) is an American singer @-@ songwriter, artist and writer. He has been influential in popular music and culture for more than five decades. Much of his most celebrated work dates from the 1960s when his songs chronicled social unrest, although Dylan repudiated suggestions from journalists that he was a spokesman for his generation. Nevertheless, early songs such as " Blowin'in the Wind " and " The Times They A</td>
      <td>\n = Bob Dylan = \n \n Bob Dylan ( / &lt;unk&gt; / ; born Robert Allen Zimmerman, May 24, 1941 ) is an American singer @-@ songwriter, artist and writer. He has been influential in popular music and culture for more than five decades. Much of his most celebrated work dates from the 1960s when his songs chronicled social unrest, although Dylan repudiated suggestions from journalists that he was a spokesman for his generation. Nevertheless, early songs such as " Blowin'in the Wind " and " The Times They Ar</td>
    </tr>
    <tr>
      <th>1</th>
      <td>\n = Laurence Olivier = \n \n Laurence Kerr Olivier, Baron Olivier, &lt;unk&gt; ( / &lt;unk&gt; &lt;unk&gt; &lt;unk&gt; / ; 22 May 1907 – 11 July 1989 ) was an English actor who, along with his contemporaries Ralph Richardson and John Gielgud, dominated the British stage of the mid @-@ 20th century. He also worked in films throughout his career, playing more than fifty cinema roles. Late in his career, he had considerable success in television roles. \n His family had no theatrical connections, but Olivier's father, a cle</td>
      <td>\n = Laurence Olivier = \n \n Laurence Kerr Olivier, Baron Olivier, &lt;unk&gt; ( / &lt;unk&gt; &lt;unk&gt; &lt;unk&gt; / ; 22 May 1907 – 11 July 1989 ) was an English actor who, along with his contemporaries Ralph Richardson and John Gielgud, dominated the British stage of the mid @-@ 20th century. He also worked in films throughout his career, playing more than fifty cinema roles. Late in his career, he had considerable success in television roles. \n His family had no theatrical connections, but Olivier's father, a cler</td>
    </tr>
  </tbody>
</table></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="mf">3e-3</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">BlearnerForLM</span><span class="o">.</span><span class="n">get_metrics_cb</span><span class="p">()])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>perplexity</th>
      <th>lm_accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>3.552418</td>
      <td>3.123605</td>
      <td>22.728172</td>
      <td>0.427572</td>
      <td>01:52</td>
    </tr>
  </tbody>
</table></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">learner</span><span class="o">=</span><span class="n">learn</span><span class="p">,</span> <span class="n">trunc_at</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "></div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea "><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>target</th>
      <th>prediction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>\n = Military history of Australia = \n \n The military history of Australia spans the nation's 220 @-@ year modern history, from the early Australian frontier wars between &lt;unk&gt; and Europeans to the ongoing conflicts in Iraq and Afghanistan in the ear</td>
      <td>\n = Military history of Australia = \n \n The military history of Australia spans the nation's 220 @-@ year modern history, from the early Australian frontier wars between &lt;unk&gt; and Europeans to the ongoing conflicts in Iraq and Afghanistan in the earl</td>
      <td>\n\n =\n = the\n\n\n =\n = Australian history of Australia is the period froms history years 1@ years period era. from the early days military to to the 18&gt; Australia &lt; &lt; the early conflict between the and Afghanistan. the late 1980st century. The the histo</td>
    </tr>
    <tr>
      <th>1</th>
      <td>\n = Air Rhodesia Flight &lt;unk&gt; = \n \n Air Rhodesia Flight &lt;unk&gt; was a scheduled passenger flight that was shot down by the Zimbabwe People's Revolutionary Army ( &lt;unk&gt; ) on 3 September 1978, during the Rhodesian Bush War. The aircraft involved, a Vick</td>
      <td>\n = Air Rhodesia Flight &lt;unk&gt; = \n \n Air Rhodesia Flight &lt;unk&gt; was a scheduled passenger flight that was shot down by the Zimbabwe People's Revolutionary Army ( &lt;unk&gt; ) on 3 September 1978, during the Rhodesian Bush War. The aircraft involved, a Vicke</td>
      <td>\n\n =planes\n =\n\n&gt;\n Air\n =\n = Rhodesia Flight &lt;unk&gt; = a flight flight flight from was scheduled down by a Sovietan'ss Liberation Army 'Zunk&gt; ) on September August 1944. killing a liberationian civil War. The plane was in was Boeing- aircraftickersount,</td>
    </tr>
  </tbody>
</table></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">blurr_generate</span><span class="p">(</span><span class="s2">&quot;Blurr is fun to work with because&quot;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">do_sample</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">top_k</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[{&#39;generated_texts&#39;: &#39; Blurr is fun to work with because the idea behind it is that it can be to and the player who has an advantage over the player who has an advantage over the player who is being played against. The fun, fun&#39;}]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Masked-language-modeling">Masked language modeling<a class="anchor-link" href="#Masked-language-modeling"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">BlearnerForLM</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;bert-base-cased&quot;</span><span class="p">,</span> <span class="n">lm_strategy_cls</span><span class="o">=</span><span class="n">BertMLMStrategy</span><span class="p">,</span> <span class="n">text_attr</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dl_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bs&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span><span class="o">.</span><span class="n">to_fp16</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">dls</span><span class="o">.</span><span class="n">show_batch</span><span class="p">(</span><span class="n">dataloaders</span><span class="o">=</span><span class="n">learn</span><span class="o">.</span><span class="n">dls</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">trunc_at</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>= Bob Dylan = Bob Dylan ( [MASK] &lt; un [MASK] &gt; / [MASK] born Robert Allen [MASK] ##immer ##man , May 24 , 1941 ) is [MASK] American singer @ - @ songwriter , artist and writer . He has been influential in popular [MASK] and culture [MASK] more than five decades . Much of his most [MASK] work dates from the 1960s when his songs chronicle ##d social unrest , although Dylan re ##pu ##dia [marries] suggestions from journalists that he was a spokesman [##io] his generation . Nevertheless , early songs such as " B ##low [##in] ' in the Wind " and " The Times [MASK] Are a @ - @ &lt; un ##k &gt; ' " became [MASK] ##s [MASK] [MASK] American civil rights and anti @ - @ war [MASK] . [RNA] he left his initial [MASK] [in] the American folk music [MASK] , [MASK] six @ - @ minute single " Like a [MASK] Stone " altered the range of [MASK] music in 1965 . His [MASK] [MASK] - @ 1960s recordings , backed by rock musicians , reached the top end of the United States [MASK] charts while also attracting &lt; un ##k &gt; and [MASK] [MASK] [Space] in the folk [MASK] . Dylan ' s [lyrics] have [MASK] various political , social , philosophical , and literary influences . They def ##ied [MASK] pop music conventions and appealed to the b ##urge ##oning counter ##culture . Initially inspired by the [MASK]</td>
      <td>= Bob Dylan = Bob Dylan ( [/] &lt; un [##k] &gt; / [;] born Robert Allen [Z] ##immer ##man , May 24 , 1941 ) is [an] American singer @ - @ songwriter , artist and writer . He has been influential in popular [music] and culture [for] more than five decades . Much of his most [celebrated] work dates from the 1960s when his songs chronicle ##d social unrest , although Dylan re ##pu ##dia [##ted] suggestions from journalists that he was a spokesman [for] his generation . Nevertheless , early songs such as " B ##low [##in] ' in the Wind " and " The Times [They] Are a @ - @ &lt; un ##k &gt; ' " became [anthem] ##s [for] [the] American civil rights and anti @ - @ war [movements] . [After] he left his initial [base] [in] the American folk music [revival] , [his] six @ - @ minute single " Like a [Rolling] Stone " altered the range of [popular] music in 1965 . His [mid] [@] - @ 1960s recordings , backed by rock musicians , reached the top end of the United States [music] charts while also attracting &lt; un ##k &gt; and [criticism] [from] [others] in the folk [movement] . Dylan ' s [lyrics] have [incorporated] various political , social , philosophical , and literary influences . They def ##ied [existing] pop music conventions and appealed to the b ##urge ##oning counter ##culture . Initially inspired by the [performances]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>= Guitar [MASK] = The Guitar Hero [MASK] ( sometimes referred to as the [MASK] series [MASK] [MASK] a series of music rhythm games first [published] in 2005 by Red ##O ##ct ##ane and Ha ##rmon ##ix , and distributed by Act [MASK] , [MASK] which [MASK] use a guitar @ - @ shaped game controller to si ##mu ##late [MASK] lead , bass guitar , and rhythm guitar across numerous rock music songs . Players [MASK] notes that scroll on @ - @ screen to colored f ##ret buttons on the controller [MASK] [MASK] ##tr ##um ##ming the controller in time to the music [spaces] order to [MASK] points , and keep the [virtual] audience excited . The [MASK] attempt to mimic many features [MASK] [##ulator] a real guitar , including the use of fast [MASK] - @ finger ##ing hammer @ - @ &lt; un ##k &gt; and [pull] @ - @ offs and [MASK] use of the w ##ham [##my] bar to [MASK] [##7] [MASK] of notes . Most games support [MASK] player modes , typically a Career mode to play through all the songs in [MASK] [MASK] , and both competitive and cooperative multiplayer [MASK] . With the introduction of Guitar [MASK] World Tour in 2008 [MASK] the game includes support [for] a four @ - [MASK] player band including vocals and drums . The [MASK] initially used mostly cover versions [MASK] songs created by &lt; un ##k &gt; Sound , but most recent titles feature</td>
      <td>= Guitar [Hero] = The Guitar Hero [series] ( sometimes referred to as the [Hero] series [)] [is] a series of music rhythm games first [published] in 2005 by Red ##O ##ct ##ane and Ha ##rmon ##ix , and distributed by Act [##ivision] , [in] which [players] use a guitar @ - @ shaped game controller to si ##mu ##late [playing] lead , bass guitar , and rhythm guitar across numerous rock music songs . Players [match] notes that scroll on @ - @ screen to colored f ##ret buttons on the controller [,] [s] ##tr ##um ##ming the controller in time to the music [in] order to [score] points , and keep the [virtual] audience excited . The [games] attempt to mimic many features [of] [playing] a real guitar , including the use of fast [@] - @ finger ##ing hammer @ - @ &lt; un ##k &gt; and [pull] @ - @ offs and [the] use of the w ##ham [##my] bar to [alter] [the] [pitch] of notes . Most games support [single] player modes , typically a Career mode to play through all the songs in [the] [game] , and both competitive and cooperative multiplayer [modes] . With the introduction of Guitar [Hero] World Tour in 2008 [,] the game includes support [for] a four @ - [@] player band including vocals and drums . The [series] initially used mostly cover versions [of] songs created by &lt; un ##k &gt; Sound , but most recent titles feature</td>
    </tr>
  </tbody>
</table></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="mf">6e-4</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">BlearnerForLM</span><span class="o">.</span><span class="n">get_metrics_cb</span><span class="p">()])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>perplexity</th>
      <th>lm_accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>2.546926</td>
      <td>2.353400</td>
      <td>10.521276</td>
      <td>0.589866</td>
      <td>00:41</td>
    </tr>
  </tbody>
</table></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">learner</span><span class="o">=</span><span class="n">learn</span><span class="p">,</span> <span class="n">trunc_at</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "></div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea "><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>target</th>
      <th>prediction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>= Military history [MASK] Australia [MASK] The military [MASK] of Australia spans the nation ' s 220 @ - @ year modern history , from [productivity] early Australian frontier [MASK] between &lt; un ##k &gt; and Europeans to the [MASK] conflicts in [MASK] and Afghanistan in the early 21st century [MASK] Although this history is short when compared to that of [MASK] other [MASK] , Australia has [MASK] involved in [MASK] conflicts and wars [MASK] and war and [MASK] service have been significant influences on Australian [MASK] and national identity , including the An [MASK] spirit . The relationship between war and Australian society [MASK] also been shaped by the enduring [MASK] [∗] Australian strategic culture and its unique security di [MASK] . As British &lt; un ##k &gt; , the Australian colonies participated in Britain ' s small wars [MASK] the 19th century , while later as a &lt; un ##k [MASK] do [MASK] ##on , and then an independent [MASK] [MASK] [MASK] fought in the First World War [MASK] Second World War , as well as in [the] wars [MASK] Korea , Malaya , Borneo [MASK] Vietnam during the Cold War . In [MASK] Post @ - @ Vietnam era Australian forces have been involved [MASK] numerous international peace [MASK] missions , [MASK] [the] United Nations and other agencies , including [in] the Sinai , Persian Gulf , &lt; un ##k &gt; [74] Somalia , East Timor and the Solomon Islands , while more recently [##court] have [MASK]</td>
      <td>= Military history [of] Australia [=] The military [history] of Australia spans the nation ' s 220 @ - @ year modern history , from [the] early Australian frontier [wars] between &lt; un ##k &gt; and Europeans to the [ongoing] conflicts in [Iraq] and Afghanistan in the early 21st century [.] Although this history is short when compared to that of [many] other [nations] , Australia has [been] involved in [numerous] conflicts and wars [,] and war and [military] service have been significant influences on Australian [society] and national identity , including the An [##zac] spirit . The relationship between war and Australian society [has] also been shaped by the enduring [themes] [of] Australian strategic culture and its unique security di [##lemma] . As British &lt; un ##k &gt; , the Australian colonies participated in Britain ' s small wars [of] the 19th century , while later as a &lt; un ##k [&gt;] do [##mini] ##on , and then an independent [nation] [,] [Australia] fought in the First World War [and] Second World War , as well as in [the] wars [in] Korea , Malaya , Borneo [and] Vietnam during the Cold War . In [the] Post @ - @ Vietnam era Australian forces have been involved [in] numerous international peace [##keeping] missions , [through] [the] United Nations and other agencies , including [in] the Sinai , Persian Gulf , &lt; un ##k &gt; [,] Somalia , East Timor and the Solomon Islands , while more recently [they] have [also]</td>
      <td>= Military history [of] Australia [=] The military [history] of Australia spans the nation ' s 220 @ - @ year modern history , from [the] early Australian frontier [conflicts] between &lt; un ##k &gt; and Europeans to the [major] conflicts in [Iraq] and Afghanistan in the early 21st century [.] Although this history is short when compared to that of [many] other [nations] , Australia has [been] involved in [numerous] conflicts and wars [,] and war and [military] service have been significant influences on Australian [culture] and national identity , including the An [##zac] spirit . The relationship between war and Australian society [has] also been shaped by the enduring [##ly] [of] Australian strategic culture and its unique security di [##lemma] . As British &lt; un ##k &gt; , the Australian colonies participated in Britain ' s small wars [in] the 19th century , while later as a &lt; un ##k [&gt;] do [##mini] ##on , and then an independent [Australian] [,] [,] fought in the First World War [and] Second World War , as well as in [the] wars [in] Korea , Malaya , Borneo [and] Vietnam during the Cold War . In [the] Post @ - @ Vietnam era Australian forces have been involved [in] numerous international peace [##keeping] missions , [for] [the] United Nations and other agencies , including [in] the Sinai , Persian Gulf , &lt; un ##k &gt; [,] Somalia , East Timor and the Solomon Islands , while more recently [they] have [been]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>= Air [MASK] Flight &lt; un ##k &gt; = [MASK] Rhodesia Flight &lt; un [MASK] &gt; was [MASK] scheduled passenger flight that was shot down by the [MASK] [MASK] [MASK] s Revolutionary Army ( &lt; [MASK] ##k &gt; ) on 3 September 1978 , during the Rhodesia ##n Bush [MASK] [MASK] The aircraft [MASK] , a [MASK] Viscount named the &lt; un [MASK] &gt; , was flying the last leg of Air Rhodesia ' s regular [MASK] service [MASK] Victoria Falls to the capital Salisbury , via the resort town of &lt; un [urge] &gt; . Soon [MASK] Flight &lt; un ##k &gt; took off , a group of &lt; un ##k &gt; guerrilla ##s scored a direct hit on its star ##board wing with a [MASK] @ [MASK] @ made &lt; un ##k &gt; 2 surface @ - @ to @ [MASK] @ [MASK] [MASK] &lt; un ##k &gt; missile , critically [MASK] the aircraft and [MASK] an emergency [MASK] . An attempted belly landing in a cotton field just west of &lt; un ##k &gt; was &lt; un ##k &gt; by an unseen ditch , which caused the [MASK] to cart ##wheel [MASK] break up . Of the 52 passengers and four [MASK] , 38 died in this crash ; the insurgents [MASK] approached the [MASK] , rounded up the [MASK] survivors they could see and massacre ##d them with [bushes] gunfire . Three passengers survived by hiding in the surrounding bush [MASK] while a further five lived</td>
      <td>= Air [Rhodesia] Flight &lt; un ##k &gt; = [Air] Rhodesia Flight &lt; un [##k] &gt; was [a] scheduled passenger flight that was shot down by the [Zimbabwe] [People] ['] s Revolutionary Army ( &lt; [un] ##k &gt; ) on 3 September 1978 , during the Rhodesia ##n Bush [War] [.] The aircraft [involved] , a [Vickers] Viscount named the &lt; un [##k] &gt; , was flying the last leg of Air Rhodesia ' s regular [scheduled] service [from] Victoria Falls to the capital Salisbury , via the resort town of &lt; un [##k] &gt; . Soon [after] Flight &lt; un ##k &gt; took off , a group of &lt; un ##k &gt; guerrilla ##s scored a direct hit on its star ##board wing with a [Soviet] @ [-] @ made &lt; un ##k &gt; 2 surface @ - @ to @ [-] @ [air] [infrared] &lt; un ##k &gt; missile , critically [damaging] the aircraft and [forcing] an emergency [landing] . An attempted belly landing in a cotton field just west of &lt; un ##k &gt; was &lt; un ##k &gt; by an unseen ditch , which caused the [plane] to cart ##wheel [and] break up . Of the 52 passengers and four [crew] , 38 died in this crash ; the insurgents [then] approached the [wreckage] , rounded up the [10] survivors they could see and massacre ##d them with [automatic] gunfire . Three passengers survived by hiding in the surrounding bush [,] while a further five lived</td>
      <td>= Air [Rhodesia] Flight &lt; un ##k &gt; = [Air] Rhodesia Flight &lt; un [##k] &gt; was [a] scheduled passenger flight that was shot down by the [People] [People] ['] s Revolutionary Army ( &lt; [un] ##k &gt; ) on 3 September 1978 , during the Rhodesia ##n Bush [War] [.] The aircraft [involved] , a [Vickers] Viscount named the &lt; un [##k] &gt; , was flying the last leg of Air Rhodesia ' s regular [scheduled] service [from] Victoria Falls to the capital Salisbury , via the resort town of &lt; un [##k] &gt; . Soon [after] Flight &lt; un ##k &gt; took off , a group of &lt; un ##k &gt; guerrilla ##s scored a direct hit on its star ##board wing with a [@] @ [-] @ made &lt; un ##k &gt; 2 surface @ - @ to @ [-] @ [made] [&gt;] &lt; un ##k &gt; missile , critically [damaging] the aircraft and [causing] an emergency [landing] . An attempted belly landing in a cotton field just west of &lt; un ##k &gt; was &lt; un ##k &gt; by an unseen ditch , which caused the [aircraft] to cart ##wheel [and] break up . Of the 52 passengers and four [crew] , 38 died in this crash ; the insurgents [then] approached the [aircraft] , rounded up the [few] survivors they could see and massacre ##d them with [automatic] gunfire . Three passengers survived by hiding in the surrounding bush [,] while a further five lived</td>
    </tr>
  </tbody>
</table></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch_tfm</span> <span class="o">=</span> <span class="n">first_blurr_tfm</span><span class="p">(</span><span class="n">learn</span><span class="o">.</span><span class="n">dls</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">blurr_fill_mask</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The best place on earth is </span><span class="si">{</span><span class="n">batch_tfm</span><span class="o">.</span><span class="n">hf_tokenizer</span><span class="o">.</span><span class="n">mask_token</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span> <span class="n">n_preds</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;The best place on earth is heaven.&#39;,
 &#39;The best place on earth is here.&#39;,
 &#39;The best place on earth is paradise.&#39;,
 &#39;The best place on earth is Earth.&#39;,
 &#39;The best place on earth is Egypt.&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary"> </a></h2><p>Whether you're using the low, mid, or high-level APIs, the <code>modeling.language_modeling</code> provides everything you need to train causual and masked language models</p>

</div>
</div>
</div>
</div>
 

