---

title: modeling.token_classification


keywords: fastai
sidebar: home_sidebar

summary: "This module contains custom models, loss functions, custom splitters, etc... for token classification tasks like named entity recognition."
description: "This module contains custom models, loss functions, custom splitters, etc... for token classification tasks like named entity recognition."
nb_path: "nbs/03_modeling-token-classification.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/03_modeling-token-classification.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">set_device</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Using GPU #</span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">current_device</span><span class="p">()</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">get_device_name</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Using GPU #1: GeForce GTX 1080 Ti
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Token-classification">Token classification<a class="anchor-link" href="#Token-classification"> </a></h2><p>The objective of token classification is to predict the correct label for each token provided in the input. In the computer vision world, this is akin to what we do in segmentation tasks whereby we attempt to predict the class/label for each pixel in an image. Named entity recognition (NER) is an example of token classification in the NLP space</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_converters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;tokens&#39;</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">,</span> <span class="s1">&#39;labels&#39;</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">,</span> <span class="s1">&#39;nested-labels&#39;</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">}</span>

<span class="c1"># full nlp dataset</span>
<span class="c1"># germ_eval_df = pd.read_csv(&#39;./data/task-token-classification/germeval2014ner_cleaned.csv&#39;, converters=df_converters)</span>

<span class="c1"># demo nlp dataset</span>
<span class="n">germ_eval_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./germeval2014_sample.csv&#39;</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="n">df_converters</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">germ_eval_df</span><span class="p">))</span>
<span class="n">germ_eval_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1000
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>source</th>
      <th>tokens</th>
      <th>labels</th>
      <th>nested-labels</th>
      <th>ds_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>n-tv.de vom 26.02.2005 [2005-02-26]</td>
      <td>[Schartau, sagte, dem, ", Tagesspiegel, ", vom, Freitag, ,, Fischer, sei, ", in, einer, Weise, aufgetreten, ,, die, alles, andere, als, überzeugend, war, ", .]</td>
      <td>[B-PER, O, O, O, B-ORG, O, O, O, O, B-PER, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O]</td>
      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O]</td>
      <td>train</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>welt.de vom 29.10.2005 [2005-10-29]</td>
      <td>[Firmengründer, Wolf, Peter, Bree, arbeitete, Anfang, der, siebziger, Jahre, als, Möbelvertreter, ,, als, er, einen, fliegenden, Händler, aus, dem, Libanon, traf, .]</td>
      <td>[O, B-PER, I-PER, I-PER, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, B-LOC, O, O]</td>
      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O]</td>
      <td>train</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>http://www.stern.de/sport/fussball/krawalle-in-der-fussball-bundesliga-dfb-setzt-auf-falsche-konzepte-1553657.html#utm_source=standard&amp;utm_medium=rss-feed&amp;utm_campaign=sport [2010-03-25]</td>
      <td>[Ob, sie, dabei, nach, dem, Runden, Tisch, am, 23., April, in, Berlin, durch, ein, pädagogisches, Konzept, unterstützt, wird, ,, ist, allerdings, zu, bezweifeln, .]</td>
      <td>[O, O, O, O, O, O, O, O, O, O, O, B-LOC, O, O, O, O, O, O, O, O, O, O, O, O]</td>
      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O]</td>
      <td>train</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>stern.de vom 21.03.2006 [2006-03-21]</td>
      <td>[Bayern, München, ist, wieder, alleiniger, Top-, Favorit, auf, den, Gewinn, der, deutschen, Fußball-Meisterschaft, .]</td>
      <td>[B-ORG, I-ORG, O, O, O, O, O, O, O, O, O, B-LOCderiv, O, O]</td>
      <td>[B-LOC, B-LOC, O, O, O, O, O, O, O, O, O, O, O, O]</td>
      <td>train</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>http://www.fr-online.de/in_und_ausland/sport/aktuell/1618625_Frings-schaut-finster-in-die-Zukunft.html [2008-10-24]</td>
      <td>[Dabei, hätte, der, tapfere, Schlussmann, allen, Grund, gehabt, ,, sich, viel, früher, aufzuregen, .]</td>
      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O]</td>
      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O]</td>
      <td>train</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We are only going to be working with small sample from the <a href="https://sites.google.com/site/germeval2014ner/data">GermEval 2014</a> data set ... so the results might not be all that great :).</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">lbls</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">germ_eval_df</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">lbls</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">])))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;B-LOC&#39;, &#39;B-LOCderiv&#39;, &#39;B-LOCpart&#39;, &#39;B-ORG&#39;, &#39;B-ORGpart&#39;, &#39;B-OTH&#39;, &#39;B-OTHderiv&#39;, &#39;B-OTHpart&#39;, &#39;B-PER&#39;, &#39;B-PERderiv&#39;, &#39;B-PERpart&#39;, &#39;I-LOC&#39;, &#39;I-LOCderiv&#39;, &#39;I-ORG&#39;, &#39;I-ORGpart&#39;, &#39;I-OTH&#39;, &#39;I-PER&#39;, &#39;O&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_cls</span> <span class="o">=</span> <span class="n">AutoModelForTokenClassification</span>
<span class="n">pretrained_model_name</span> <span class="o">=</span> <span class="s2">&quot;bert-base-multilingual-cased&quot;</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">AutoConfig</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">pretrained_model_name</span><span class="p">)</span>

<span class="n">config</span><span class="o">.</span><span class="n">num_labels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice above how I set the <code>config.num_labels</code> attribute to the number of labels we want <em>our</em> model to be able to predict. The model will update its last layer accordingly (this concept is essentially transfer learning).</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_config</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">hf_model</span> <span class="o">=</span> <span class="n">BLURR</span><span class="o">.</span><span class="n">get_hf_objects</span><span class="p">(</span><span class="n">pretrained_model_name</span><span class="p">,</span> 
                                                                  <span class="n">model_cls</span><span class="o">=</span><span class="n">model_cls</span><span class="p">,</span> 
                                                                  <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
<span class="n">hf_arch</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_config</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&#39;bert&#39;,
 transformers.models.bert.configuration_bert.BertConfig,
 transformers.models.bert.tokenization_bert_fast.BertTokenizerFast,
 transformers.models.bert.modeling_bert.BertForTokenClassification)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="n">hf_config</span><span class="o">.</span><span class="n">num_labels</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">before_batch_tfm</span> <span class="o">=</span> <span class="n">HF_TokenClassBeforeBatchTransform</span><span class="p">(</span><span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_config</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">hf_model</span><span class="p">,</span>
                                                     <span class="n">is_split_into_words</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                                     <span class="n">tok_kwargs</span><span class="o">=</span><span class="p">{</span> <span class="s1">&#39;return_special_tokens_mask&#39;</span><span class="p">:</span> <span class="kc">True</span> <span class="p">})</span>

<span class="n">blocks</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">HF_TextBlock</span><span class="p">(</span><span class="n">before_batch_tfm</span><span class="o">=</span><span class="n">before_batch_tfm</span><span class="p">,</span> <span class="n">input_return_type</span><span class="o">=</span><span class="n">HF_TokenClassInput</span><span class="p">),</span> 
    <span class="n">HF_TokenCategoryBlock</span><span class="p">(</span><span class="n">vocab</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="p">)</span>

<span class="k">def</span> <span class="nf">get_y</span><span class="p">(</span><span class="n">inp</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span> <span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="o">.</span><span class="n">tokenize</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">entity</span><span class="p">))))</span> <span class="k">for</span> <span class="n">entity</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">inp</span><span class="o">.</span><span class="n">tokens</span><span class="p">,</span> <span class="n">inp</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span> <span class="p">]</span>

<span class="n">dblock</span> <span class="o">=</span> <span class="n">DataBlock</span><span class="p">(</span><span class="n">blocks</span><span class="o">=</span><span class="n">blocks</span><span class="p">,</span> 
                   <span class="n">get_x</span><span class="o">=</span><span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;tokens&#39;</span><span class="p">),</span>
                   <span class="n">get_y</span><span class="o">=</span><span class="n">get_y</span><span class="p">,</span>
                   <span class="n">splitter</span><span class="o">=</span><span class="n">RandomSplitter</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have to define a <code>get_y</code> that creates the same number of labels as there are subtokens for a particular token. For example, my name "Wayde" gets split up into two subtokens, "Way" and "##de". The label for "Wayde" is "B-PER" and we just repeat it for the subtokens.  This all get cleaned up when we show results and get predictions.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">dblock</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">germ_eval_df</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span><span class="o">.</span><span class="n">show_batch</span><span class="p">(</span><span class="n">dataloaders</span><span class="o">=</span><span class="n">dls</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>token / target label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[('Helbig', 'B-OTH'), ('et', 'I-OTH'), ('al.', 'I-OTH'), ('(', 'O'), ('1994', 'O'), (')', 'O'), ('S.', 'O'), ('593.', 'O'), ('Wink', 'O'), ('&amp;', 'B-OTH'), ('Seibold', 'I-OTH'), ('et', 'I-OTH'), ('al.', 'I-OTH'), ('(', 'I-OTH'), ('1998', 'O'), (')', 'O'), ('S.', 'O'), ('32', 'O'), ('Inwieweit', 'O'), ('noch', 'O'), ('andere', 'O'), ('Falken,', 'O'), ('wie', 'O'), ('der', 'O'), ('Afrikanische', 'O'), ('Baumfalke', 'O'), ('(', 'O'), ('Falco', 'B-LOCderiv'), ('cuvieri', 'O'), (')', 'O'), ('oder', 'O'), ('der', 'O'), ('Malaienbaumfalke', 'O'), ('(', 'O'), ('Falco', 'O'), ('serverus', 'O'), (')', 'O'), ('dieser', 'O'), ('Gruppe', 'O'), ('zuzuzählen', 'O'), ('sind,', 'O'), ('ist', 'O'), ('Gegenstand', 'O'), ('der', 'O'), ('Forschung.', 'O')]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[('"', 'O'), ('Es', 'O'), ('ist', 'O'), ('beabsichtigt,', 'O'), ('die', 'O'), ('Aktien', 'O'), ('im', 'O'), ('ersten', 'O'), ('Halbjahr', 'O'), ('2007', 'O'), ('von', 'O'), ('der', 'O'), ('Deka', 'O'), ('-', 'B-ORG'), ('Bank', 'O'), ('auf', 'O'), ('eine', 'O'), ('von', 'O'), ('der', 'B-ORG'), ('Sparkassen', 'O'), ('-', 'O'), ('Finanzgruppe', 'O'), ('zu', 'O'), ('errichtenden', 'O'), ('Gesellschaft', 'O'), ('zu', 'O'), ('übertragen', 'O'), ('",', 'O'), ('teilten', 'B-LOCderiv'), ('das', 'O'), ('Frankfurter', 'O'), ('Institut', 'O'), ('und', 'B-ORG'), ('der', 'I-ORG'), ('Deutsche', 'I-ORG'), ('Sparkassenund', 'O'), ('Giroverband', 'B-ORG'), ('(', 'O'), ('DSGV', 'O'), (')', 'O')]</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Metrics">Metrics<a class="anchor-link" href="#Metrics"> </a></h3><p>In this section, we'll add helpful metrics for token classification tasks</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="calculate_token_class_metrics" class="doc_header"><code>calculate_token_class_metrics</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/token_classification.py#L20" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>calculate_token_class_metrics</code>(<strong><code>pred_toks</code></strong>, <strong><code>targ_toks</code></strong>, <strong><code>metric_key</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Training">Training<a class="anchor-link" href="#Training"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="HF_TokenClassMetricsCallback" class="doc_header"><code>class</code> <code>HF_TokenClassMetricsCallback</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/token_classification.py#L30" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>HF_TokenClassMetricsCallback</code>(<strong><code>tok_metrics</code></strong>=<em><code>['accuracy', 'precision', 'recall', 'f1']</code></em>, <strong>**<code>kwargs</code></strong>) :: <code>Callback</code></p>
</blockquote>
<p>A fastai friendly callback that includes accuracy, precision, recall, and f1 metrics using the
<code>seqeval</code> library.  Additionally, this metric knows how to <em>not</em> include your 'ignore_token' in it's
calculations.</p>
<p>See <a href="https://github.com/chakki-works/seqeval">here</a> for more information on <code>seqeval</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">HF_BaseModelWrapper</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span>
<span class="n">learn_cbs</span> <span class="o">=</span> <span class="p">[</span><span class="n">HF_BaseModelCallback</span><span class="p">]</span>
<span class="n">fit_cbs</span> <span class="o">=</span> <span class="p">[</span><span class="n">HF_TokenClassMetricsCallback</span><span class="p">()]</span>

<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">opt_func</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">Adam</span><span class="p">),</span><span class="n">cbs</span><span class="o">=</span><span class="n">learn_cbs</span><span class="p">,</span><span class="n">splitter</span><span class="o">=</span><span class="n">hf_splitter</span><span class="p">)</span>

<span class="n">learn</span><span class="o">.</span><span class="n">freeze</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>HF_BaseModelWrapper (Input shape: 2)
============================================================================
Layer (type)         Output Shape         Param #    Trainable 
============================================================================
                     2 x 76 x 768        
Embedding                                 91812096   False     
Embedding                                 393216     False     
Embedding                                 1536       False     
LayerNorm                                 1536       True      
Dropout                                                        
Linear                                    590592     False     
Linear                                    590592     False     
Linear                                    590592     False     
Dropout                                                        
Linear                                    590592     False     
LayerNorm                                 1536       True      
Dropout                                                        
____________________________________________________________________________
                     2 x 76 x 3072       
Linear                                    2362368    False     
____________________________________________________________________________
                     2 x 76 x 768        
Linear                                    2360064    False     
LayerNorm                                 1536       True      
Dropout                                                        
Linear                                    590592     False     
Linear                                    590592     False     
Linear                                    590592     False     
Dropout                                                        
Linear                                    590592     False     
LayerNorm                                 1536       True      
Dropout                                                        
____________________________________________________________________________
                     2 x 76 x 3072       
Linear                                    2362368    False     
____________________________________________________________________________
                     2 x 76 x 768        
Linear                                    2360064    False     
LayerNorm                                 1536       True      
Dropout                                                        
Linear                                    590592     False     
Linear                                    590592     False     
Linear                                    590592     False     
Dropout                                                        
Linear                                    590592     False     
LayerNorm                                 1536       True      
Dropout                                                        
____________________________________________________________________________
                     2 x 76 x 3072       
Linear                                    2362368    False     
____________________________________________________________________________
                     2 x 76 x 768        
Linear                                    2360064    False     
LayerNorm                                 1536       True      
Dropout                                                        
Linear                                    590592     False     
Linear                                    590592     False     
Linear                                    590592     False     
Dropout                                                        
Linear                                    590592     False     
LayerNorm                                 1536       True      
Dropout                                                        
____________________________________________________________________________
                     2 x 76 x 3072       
Linear                                    2362368    False     
____________________________________________________________________________
                     2 x 76 x 768        
Linear                                    2360064    False     
LayerNorm                                 1536       True      
Dropout                                                        
Linear                                    590592     False     
Linear                                    590592     False     
Linear                                    590592     False     
Dropout                                                        
Linear                                    590592     False     
LayerNorm                                 1536       True      
Dropout                                                        
____________________________________________________________________________
                     2 x 76 x 3072       
Linear                                    2362368    False     
____________________________________________________________________________
                     2 x 76 x 768        
Linear                                    2360064    False     
LayerNorm                                 1536       True      
Dropout                                                        
Linear                                    590592     False     
Linear                                    590592     False     
Linear                                    590592     False     
Dropout                                                        
Linear                                    590592     False     
LayerNorm                                 1536       True      
Dropout                                                        
____________________________________________________________________________
                     2 x 76 x 3072       
Linear                                    2362368    False     
____________________________________________________________________________
                     2 x 76 x 768        
Linear                                    2360064    False     
LayerNorm                                 1536       True      
Dropout                                                        
Linear                                    590592     False     
Linear                                    590592     False     
Linear                                    590592     False     
Dropout                                                        
Linear                                    590592     False     
LayerNorm                                 1536       True      
Dropout                                                        
____________________________________________________________________________
                     2 x 76 x 3072       
Linear                                    2362368    False     
____________________________________________________________________________
                     2 x 76 x 768        
Linear                                    2360064    False     
LayerNorm                                 1536       True      
Dropout                                                        
Linear                                    590592     False     
Linear                                    590592     False     
Linear                                    590592     False     
Dropout                                                        
Linear                                    590592     False     
LayerNorm                                 1536       True      
Dropout                                                        
____________________________________________________________________________
                     2 x 76 x 3072       
Linear                                    2362368    False     
____________________________________________________________________________
                     2 x 76 x 768        
Linear                                    2360064    False     
LayerNorm                                 1536       True      
Dropout                                                        
Linear                                    590592     False     
Linear                                    590592     False     
Linear                                    590592     False     
Dropout                                                        
Linear                                    590592     False     
LayerNorm                                 1536       True      
Dropout                                                        
____________________________________________________________________________
                     2 x 76 x 3072       
Linear                                    2362368    False     
____________________________________________________________________________
                     2 x 76 x 768        
Linear                                    2360064    False     
LayerNorm                                 1536       True      
Dropout                                                        
Linear                                    590592     False     
Linear                                    590592     False     
Linear                                    590592     False     
Dropout                                                        
Linear                                    590592     False     
LayerNorm                                 1536       True      
Dropout                                                        
____________________________________________________________________________
                     2 x 76 x 3072       
Linear                                    2362368    False     
____________________________________________________________________________
                     2 x 76 x 768        
Linear                                    2360064    False     
LayerNorm                                 1536       True      
Dropout                                                        
Linear                                    590592     False     
Linear                                    590592     False     
Linear                                    590592     False     
Dropout                                                        
Linear                                    590592     False     
LayerNorm                                 1536       True      
Dropout                                                        
____________________________________________________________________________
                     2 x 76 x 3072       
Linear                                    2362368    False     
____________________________________________________________________________
                     2 x 76 x 768        
Linear                                    2360064    False     
LayerNorm                                 1536       True      
Dropout                                                        
Linear                                    590592     False     
Linear                                    590592     False     
Linear                                    590592     False     
Dropout                                                        
Linear                                    590592     False     
LayerNorm                                 1536       True      
Dropout                                                        
____________________________________________________________________________
                     2 x 76 x 3072       
Linear                                    2362368    False     
____________________________________________________________________________
                     2 x 76 x 768        
Linear                                    2360064    False     
LayerNorm                                 1536       True      
Dropout                                                        
Dropout                                                        
____________________________________________________________________________
                     2 x 76 x 18         
Linear                                    13842      True      
____________________________________________________________________________

Total params: 177,276,690
Total trainable params: 52,242
Total non-trainable params: 177,224,448

Optimizer used: functools.partial(&lt;function Adam at 0x7f31d97d8c10&gt;)
Loss function: FlattenedLoss of CrossEntropyLoss()

Model frozen up to parameter group #2

Callbacks:
  - TrainEvalCallback
  - HF_BaseModelCallback
  - Recorder
  - ProgressCallback</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
<span class="n">preds</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">len</span><span class="p">(</span><span class="n">preds</span><span class="p">),</span><span class="n">preds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(1, torch.Size([2, 76, 18]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;input_ids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(2, 3, torch.Size([2, 76]), 2, torch.Size([2, 76]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">preds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">preds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">preds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">preds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>torch.Size([152, 18]) torch.Size([152])
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">learn</span><span class="o">.</span><span class="n">opt</span><span class="o">.</span><span class="n">param_groups</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>3
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">unfreeze</span><span class="p">()</span>
<span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">(</span><span class="n">suggest_funcs</span><span class="o">=</span><span class="p">[</span><span class="n">minimum</span><span class="p">,</span> <span class="n">steep</span><span class="p">,</span> <span class="n">valley</span><span class="p">,</span> <span class="n">slide</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/wgilliam/miniconda3/envs/blurr/lib/python3.9/site-packages/fastai/callback/schedule.py:270: UserWarning: color is redundantly defined by the &#39;color&#39; keyword argument and the fmt string &#34;ro&#34; (-&gt; color=&#39;r&#39;). The keyword argument will take precedence.
  ax.plot(val, idx, &#39;ro&#39;, label=nm, c=color)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(minimum=0.00036307806149125097, steep=3.0199516913853586e-05, valley=tensor(7.5858e-05), slide=tensor(0.0191))</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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M+maTPekNN2PsnRPytI9KUv3pDTdj/LV6pYbV/P19eXf//43vr6+ZofiNnRPStP9KEv3pCzdk7J0T0rT/SifWm5ERETEo6jlRkRERDyKkhsRERHxKEpuRERExKMouRERERGPouRGREREPIqSGxNs2bKFDh06OB/+/v789NNPZodluqSkJPr27Uvr1q1JTEwkJyfH7JBM5+Xl5fw5uf32280Oxy3k5uYSFxfHww8/bHYopjt8+DBdu3alQ4cOJCYm8tFHH5kdkumSk5Pp06cPrVu3pl27dnz//fdmh+QWrrjiCurUqcNVV11ldijVQkPBTXbkyBHi4+PZtWsXgYGBZodjqgsvvJAXXniB3r17k5mZSUhICF5etW6FkFIiIyPZv3+/2WG4lbFjx7J161YaNWrE66+/bnY4prLZbOTn5xMQEEBubi5t27ZlxYoVREREmB2aaVJTU0lPT6dDhw5kZGTQqVMntmzZUus/X+fNm8eRI0f47LPP+OGHH8wOp8qp5cZk06ZNo1+/frX+F2/jxo14e3vTu3dvAMLDw2t9YiNlbd26lc2bNzNkyBCzQ3ELVquVgIAAAPLy8rDZbNT276uxsbF06NABgKioKMLDw8nMzDQ3KDfQt29fgoODzQ6j2ii5OYWFCxcydOhQ6tWrh2EYp+wyeu+992jcuDF+fn507tyZRYsWndW5vvvuO6699tpzjLjqVfU92bp1K0FBQVx22WV06tSJl156yYXRV43q+DnJzs6mc+fO9OrViwULFrgo8qpRHffj4YcfZty4cS6KuOpVxz05dOgQ7du3p0GDBjz66KNERka6KPqqUZ2frytXrsRut9OwYcNzjLpqVec9qS2U3JxCTk4O7du355133jnl699++y0PPPAAY8eOZc2aNfTu3ZvBgweze/du5z6dO3embdu2ZR579+517pOdnc3vv/9eI76FVvU9KSwsZNGiRbz77rv88ccfzJkzhzlz5lTX5Z2V6vg52blzJ6tWreKDDz7g5ptvJjs7u1qu7WxU9f34+eefad68Oc2bN6+uSzpn1fEzEhYWxrp160hKSmLy5Mmkp6dXy7Wdrer6fD1w4AA333wzH374YZVf07mqrntSqzikXIDjxx9/LLWtW7dujrvvvrvUtpYtWzoef/zxSr33559/7rjxxhvPNcRqVxX3ZMmSJY6BAwc6n7/66quO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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span> <span class="mf">3e-5</span><span class="p">,</span> <span class="n">moms</span><span class="o">=</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.8</span><span class="p">),</span> <span class="n">cbs</span><span class="o">=</span><span class="n">fit_cbs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>precision</th>
      <th>recall</th>
      <th>f1</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.206672</td>
      <td>0.144148</td>
      <td>0.960996</td>
      <td>0.652672</td>
      <td>0.655172</td>
      <td>0.653920</td>
      <td>00:36</td>
    </tr>
  </tbody>
</table>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/wgilliam/miniconda3/envs/blurr/lib/python3.9/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">learn</span><span class="o">.</span><span class="n">token_classification_report</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>              precision    recall  f1-score   support

         LOC       0.89      0.76      0.82        78
    LOCderiv       0.70      0.88      0.78        16
     LOCpart       0.00      0.00      0.00         0
         ORG       0.51      0.29      0.37        79
     ORGpart       0.00      0.00      0.00         0
         OTH       0.21      0.56      0.30         9
     OTHpart       0.00      0.00      0.00         0
         PER       0.88      0.89      0.88        79
    PERderiv       0.00      0.00      0.00         0
     PERpart       0.00      0.00      0.00         0

   micro avg       0.65      0.66      0.65       261
   macro avg       0.32      0.34      0.32       261
weighted avg       0.74      0.66      0.68       261

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Showing-results">Showing results<a class="anchor-link" href="#Showing-results"> </a></h3><p>Below we'll add in additional functionality to more intuitively show the results of our model.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">learner</span><span class="o">=</span><span class="n">learn</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">trunc_at</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>token / target label / predicted label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[('Zugang', 'O', 'O'), ('und', 'O', 'O'), ('Engagement', 'O', 'O'), (':', 'O', 'O'), ('das', 'O', 'O'), ('eigentlich', 'O', 'O'), ('Neue', 'O', 'O'), ('an', 'O', 'O'), ('der', 'O', 'O'), ('Netz', 'O', 'O')]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[('Eine', 'O', 'O'), ('Sonderform', 'O', 'O'), ('der', 'O', 'O'), ('reduplizierten', 'O', 'O'), ('Komposita', 'O', 'O'), ('sind', 'O', 'O'), ('die', 'O', 'O'), ('sogenannten', 'O', 'O'), ('Echowörter,', 'O', 'O'), ('bei', 'O', 'O')]</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">blurr_predict</span><span class="p">(</span><span class="s1">&#39;My name is Wayde and I live in San Diego&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(&#34;[&#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;B-PER&#39;, &#39;B-PER&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;B-LOC&#39;, &#39;B-LOC&#39;, &#39;O&#39;]&#34;,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The default <code>Learner.predict</code> method returns a prediction per subtoken, including the special tokens for each architecture's tokenizer.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Learner.blurr_predict_tokens" class="doc_header"><code>Learner.blurr_predict_tokens</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/token_classification.py#L192" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Learner.blurr_predict_tokens</code>(<strong><code>items</code></strong>, <strong>**<code>kargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">txt</span> <span class="o">=</span><span class="s2">&quot;Hi! My name is Wayde Gilliam from ohmeow.com. I live in California.&quot;</span>
<span class="n">txt2</span> <span class="o">=</span> <span class="s2">&quot;I wish covid was over so I could go to Germany and watch Bayern Munich play in the Bundesliga.&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">blurr_predict_tokens</span><span class="p">(</span><span class="n">txt</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="p">[(</span><span class="n">tok</span><span class="p">,</span> <span class="n">lbl</span><span class="p">)</span> <span class="k">for</span> <span class="n">tok</span><span class="p">,</span><span class="n">lbl</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(&#39;Hi!&#39;, &#39;O&#39;), (&#39;My&#39;, &#39;O&#39;), (&#39;name&#39;, &#39;O&#39;), (&#39;is&#39;, &#39;O&#39;), (&#39;Wayde&#39;, &#39;B-PER&#39;), (&#39;Gilliam&#39;, &#39;I-PER&#39;), (&#39;from&#39;, &#39;O&#39;), (&#39;ohmeow.com.&#39;, &#39;B-ORG&#39;), (&#39;I&#39;, &#39;O&#39;), (&#39;live&#39;, &#39;O&#39;), (&#39;in&#39;, &#39;O&#39;), (&#39;California.&#39;, &#39;B-LOC&#39;)]

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">blurr_predict_tokens</span><span class="p">([</span><span class="n">txt</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="n">txt2</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="p">[(</span><span class="n">tok</span><span class="p">,</span> <span class="n">lbl</span><span class="p">)</span> <span class="k">for</span> <span class="n">tok</span><span class="p">,</span><span class="n">lbl</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(&#39;Hi!&#39;, &#39;O&#39;), (&#39;My&#39;, &#39;O&#39;), (&#39;name&#39;, &#39;O&#39;), (&#39;is&#39;, &#39;O&#39;), (&#39;Wayde&#39;, &#39;B-PER&#39;), (&#39;Gilliam&#39;, &#39;I-PER&#39;), (&#39;from&#39;, &#39;O&#39;), (&#39;ohmeow.com.&#39;, &#39;B-ORG&#39;), (&#39;I&#39;, &#39;O&#39;), (&#39;live&#39;, &#39;O&#39;), (&#39;in&#39;, &#39;O&#39;), (&#39;California.&#39;, &#39;B-LOC&#39;)]

[(&#39;I&#39;, &#39;O&#39;), (&#39;wish&#39;, &#39;O&#39;), (&#39;covid&#39;, &#39;O&#39;), (&#39;was&#39;, &#39;O&#39;), (&#39;over&#39;, &#39;O&#39;), (&#39;so&#39;, &#39;O&#39;), (&#39;I&#39;, &#39;O&#39;), (&#39;could&#39;, &#39;O&#39;), (&#39;go&#39;, &#39;O&#39;), (&#39;to&#39;, &#39;O&#39;), (&#39;Germany&#39;, &#39;B-LOC&#39;), (&#39;and&#39;, &#39;O&#39;), (&#39;watch&#39;, &#39;O&#39;), (&#39;Bayern&#39;, &#39;B-ORG&#39;), (&#39;Munich&#39;, &#39;I-ORG&#39;), (&#39;play&#39;, &#39;O&#39;), (&#39;in&#39;, &#39;O&#39;), (&#39;the&#39;, &#39;O&#39;), (&#39;Bundesliga.&#39;, &#39;B-ORG&#39;)]

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It's interesting (and very cool) how well this model performs on English even thought it was trained against a German corpus.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Inference">Inference<a class="anchor-link" href="#Inference"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">export_fname</span> <span class="o">=</span> <span class="s1">&#39;tok_class_learn_export&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">export_fname</span><span class="si">}</span><span class="s1">.pkl&#39;</span><span class="p">)</span>
<span class="n">inf_learn</span> <span class="o">=</span> <span class="n">load_learner</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">export_fname</span><span class="si">}</span><span class="s1">.pkl&#39;</span><span class="p">)</span>

<span class="n">res</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">blurr_predict_tokens</span><span class="p">([</span><span class="n">txt</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="n">txt2</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="p">[(</span><span class="n">tok</span><span class="p">,</span> <span class="n">lbl</span><span class="p">)</span> <span class="k">for</span> <span class="n">tok</span><span class="p">,</span><span class="n">lbl</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(&#39;Hi!&#39;, &#39;O&#39;), (&#39;My&#39;, &#39;O&#39;), (&#39;name&#39;, &#39;O&#39;), (&#39;is&#39;, &#39;O&#39;), (&#39;Wayde&#39;, &#39;B-PER&#39;), (&#39;Gilliam&#39;, &#39;I-PER&#39;), (&#39;from&#39;, &#39;O&#39;), (&#39;ohmeow.com.&#39;, &#39;B-ORG&#39;), (&#39;I&#39;, &#39;O&#39;), (&#39;live&#39;, &#39;O&#39;), (&#39;in&#39;, &#39;O&#39;), (&#39;California.&#39;, &#39;B-LOC&#39;)]

[(&#39;I&#39;, &#39;O&#39;), (&#39;wish&#39;, &#39;O&#39;), (&#39;covid&#39;, &#39;O&#39;), (&#39;was&#39;, &#39;O&#39;), (&#39;over&#39;, &#39;O&#39;), (&#39;so&#39;, &#39;O&#39;), (&#39;I&#39;, &#39;O&#39;), (&#39;could&#39;, &#39;O&#39;), (&#39;go&#39;, &#39;O&#39;), (&#39;to&#39;, &#39;O&#39;), (&#39;Germany&#39;, &#39;B-LOC&#39;), (&#39;and&#39;, &#39;O&#39;), (&#39;watch&#39;, &#39;O&#39;), (&#39;Bayern&#39;, &#39;B-ORG&#39;), (&#39;Munich&#39;, &#39;I-ORG&#39;), (&#39;play&#39;, &#39;O&#39;), (&#39;in&#39;, &#39;O&#39;), (&#39;the&#39;, &#39;O&#39;), (&#39;Bundesliga.&#39;, &#39;B-ORG&#39;)]

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>... and onnx</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># @patch</span>
<span class="c1"># def predict_tokens(self:blurrONNX, items, **kargs):</span>
<span class="c1">#     hf_before_batch_tfm = get_blurr_tfm(self.dls.before_batch)</span>
<span class="c1">#     return _blurr_predict_tokens(self.predict, items, hf_before_batch_tfm)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># learn.blurr_to_onnx(export_fname, quantize=True)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># onnx_inf = blurrONNX(export_fname)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># res = onnx_inf.predict_tokens(txt.split())</span>
<span class="c1"># for r in res: print(f&#39;{[(tok, lbl) for tok,lbl in zip(r[0],r[1]) ]}\n&#39;)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tests">Tests<a class="anchor-link" href="#Tests"> </a></h2><p>The tests below to ensure the token classification training code above works for <strong>all</strong> pretrained token classification models available in huggingface.  These tests are excluded from the CI workflow because of how long they would take to run and the amount of data that would be required to download.</p>
<p><strong>Note</strong>: Feel free to modify the code below to test whatever pretrained token classification models you are working with ... and if any of your pretrained token classification models fail, please submit a github issue <em>(or a PR if you'd like to fix it yourself)</em></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">try</span><span class="p">:</span> <span class="k">del</span> <span class="n">learn</span><span class="p">;</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">empty_cache</span><span class="p">()</span>
<span class="k">except</span><span class="p">:</span> <span class="k">pass</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span> <span class="n">model_type</span> <span class="k">for</span> <span class="n">model_type</span> <span class="ow">in</span> <span class="n">BLURR</span><span class="o">.</span><span class="n">get_models</span><span class="p">(</span><span class="n">task</span><span class="o">=</span><span class="s1">&#39;TokenClassification&#39;</span><span class="p">)</span> 
 <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">model_type</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;TF&#39;</span><span class="p">))</span> <span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[transformers.models.albert.modeling_albert.AlbertForTokenClassification,
 transformers.models.bert.modeling_bert.BertForTokenClassification,
 transformers.models.big_bird.modeling_big_bird.BigBirdForTokenClassification,
 transformers.models.camembert.modeling_camembert.CamembertForTokenClassification,
 transformers.models.convbert.modeling_convbert.ConvBertForTokenClassification,
 transformers.models.deberta.modeling_deberta.DebertaForTokenClassification,
 transformers.models.deberta_v2.modeling_deberta_v2.DebertaV2ForTokenClassification,
 transformers.models.distilbert.modeling_distilbert.DistilBertForTokenClassification,
 transformers.models.electra.modeling_electra.ElectraForTokenClassification,
 transformers.models.flaubert.modeling_flaubert.FlaubertForTokenClassification,
 transformers.models.funnel.modeling_funnel.FunnelForTokenClassification,
 transformers.models.ibert.modeling_ibert.IBertForTokenClassification,
 transformers.models.layoutlm.modeling_layoutlm.LayoutLMForTokenClassification,
 transformers.models.longformer.modeling_longformer.LongformerForTokenClassification,
 transformers.models.mpnet.modeling_mpnet.MPNetForTokenClassification,
 transformers.models.megatron_bert.modeling_megatron_bert.MegatronBertForTokenClassification,
 transformers.models.mobilebert.modeling_mobilebert.MobileBertForTokenClassification,
 transformers.models.roberta.modeling_roberta.RobertaForTokenClassification,
 transformers.models.squeezebert.modeling_squeezebert.SqueezeBertForTokenClassification,
 transformers.models.xlm.modeling_xlm.XLMForTokenClassification,
 transformers.models.xlm_roberta.modeling_xlm_roberta.XLMRobertaForTokenClassification,
 transformers.models.xlnet.modeling_xlnet.XLNetForTokenClassification]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pretrained_model_names</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;albert-base-v1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;bert-base-multilingual-cased&#39;</span><span class="p">,</span>
    <span class="s1">&#39;camembert-base&#39;</span><span class="p">,</span>
    <span class="s1">&#39;distilbert-base-uncased&#39;</span><span class="p">,</span>
    <span class="s1">&#39;google/electra-small-discriminator&#39;</span><span class="p">,</span>
    <span class="s1">&#39;flaubert/flaubert_small_cased&#39;</span><span class="p">,</span>
    <span class="s1">&#39;huggingface/funnel-small-base&#39;</span><span class="p">,</span>
    <span class="s1">&#39;allenai/longformer-base-4096&#39;</span><span class="p">,</span>
    <span class="s1">&#39;microsoft/mpnet-base&#39;</span><span class="p">,</span>
    <span class="s1">&#39;google/mobilebert-uncased&#39;</span><span class="p">,</span>
    <span class="s1">&#39;roberta-base&#39;</span><span class="p">,</span>
    <span class="s1">&#39;squeezebert/squeezebert-uncased&#39;</span><span class="p">,</span>
    <span class="s1">&#39;xlm-mlm-en-2048&#39;</span><span class="p">,</span>
    <span class="s1">&#39;xlm-roberta-base&#39;</span><span class="p">,</span>
    <span class="s1">&#39;xlnet-base-cased&#39;</span>
<span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#hide_output</span>
<span class="n">model_cls</span> <span class="o">=</span> <span class="n">AutoModelForTokenClassification</span>
<span class="n">bsz</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">seq_sz</span> <span class="o">=</span> <span class="mi">64</span>

<span class="n">test_results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">model_name</span> <span class="ow">in</span> <span class="n">pretrained_model_names</span><span class="p">:</span>
    <span class="n">error</span><span class="o">=</span><span class="kc">None</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;=== </span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s1"> ===</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="n">config</span> <span class="o">=</span> <span class="n">AutoConfig</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>
    <span class="n">config</span><span class="o">.</span><span class="n">num_labels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
    
    <span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_config</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">hf_model</span> <span class="o">=</span> <span class="n">BLURR</span><span class="o">.</span><span class="n">get_hf_objects</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> 
                                                                      <span class="n">model_cls</span><span class="o">=</span><span class="n">model_cls</span><span class="p">,</span> 
                                                                      <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;architecture:</span><span class="se">\t</span><span class="si">{</span><span class="n">hf_arch</span><span class="si">}</span><span class="se">\n</span><span class="s1">tokenizer:</span><span class="se">\t</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="c1"># not all architectures include a native pad_token (e.g., gpt2, ctrl, etc...), so we add one here</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">hf_tokenizer</span><span class="o">.</span><span class="n">pad_token</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span> 
        <span class="n">hf_tokenizer</span><span class="o">.</span><span class="n">add_special_tokens</span><span class="p">({</span><span class="s1">&#39;pad_token&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;pad&gt;&#39;</span><span class="p">})</span>  
        <span class="n">hf_config</span><span class="o">.</span><span class="n">pad_token_id</span> <span class="o">=</span> <span class="n">hf_tokenizer</span><span class="o">.</span><span class="n">get_vocab</span><span class="p">()[</span><span class="s1">&#39;&lt;pad&gt;&#39;</span><span class="p">]</span>
        <span class="n">hf_model</span><span class="o">.</span><span class="n">resize_token_embeddings</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="p">))</span> 
    
    <span class="n">before_batch_tfm</span> <span class="o">=</span> <span class="n">HF_TokenClassBeforeBatchTransform</span><span class="p">(</span><span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_config</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">hf_model</span><span class="p">,</span>
                                                         <span class="n">max_length</span><span class="o">=</span><span class="n">seq_sz</span><span class="p">,</span>
                                                         <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;max_length&#39;</span><span class="p">,</span>
                                                         <span class="n">is_split_into_words</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                                         <span class="n">tok_kwargs</span><span class="o">=</span><span class="p">{</span> <span class="s1">&#39;return_special_tokens_mask&#39;</span><span class="p">:</span> <span class="kc">True</span> <span class="p">})</span>

    <span class="n">blocks</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">HF_TextBlock</span><span class="p">(</span><span class="n">before_batch_tfm</span><span class="o">=</span><span class="n">before_batch_tfm</span><span class="p">,</span> <span class="n">input_return_type</span><span class="o">=</span><span class="n">HF_TokenClassInput</span><span class="p">),</span> 
        <span class="n">HF_TokenCategoryBlock</span><span class="p">(</span><span class="n">vocab</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">dblock</span> <span class="o">=</span> <span class="n">DataBlock</span><span class="p">(</span><span class="n">blocks</span><span class="o">=</span><span class="n">blocks</span><span class="p">,</span> 
                       <span class="n">get_x</span><span class="o">=</span><span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;tokens&#39;</span><span class="p">),</span>
                       <span class="n">get_y</span><span class="o">=</span> <span class="k">lambda</span> <span class="n">inp</span><span class="p">:</span> <span class="p">[</span> 
                           <span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="o">.</span><span class="n">tokenize</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">entity</span><span class="p">))))</span> 
                           <span class="k">for</span> <span class="n">entity</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">inp</span><span class="o">.</span><span class="n">tokens</span><span class="p">,</span> <span class="n">inp</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span> 
                       <span class="p">],</span>
                       <span class="n">splitter</span><span class="o">=</span><span class="n">RandomSplitter</span><span class="p">())</span>
    
    <span class="n">dls</span> <span class="o">=</span> <span class="n">dblock</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">germ_eval_df</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="n">bsz</span><span class="p">)</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">HF_BaseModelWrapper</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span>
    <span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> 
                <span class="n">model</span><span class="p">,</span>
                <span class="n">opt_func</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">Adam</span><span class="p">),</span>
                <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">HF_BaseModelCallback</span><span class="p">],</span>
                <span class="n">splitter</span><span class="o">=</span><span class="n">hf_splitter</span><span class="p">)</span><span class="o">.</span><span class="n">to_fp16</span><span class="p">()</span>

    <span class="n">learn</span><span class="o">.</span><span class="n">create_opt</span><span class="p">()</span>             <span class="c1"># -&gt; will create your layer groups based on your &quot;splitter&quot; function</span>
    <span class="n">learn</span><span class="o">.</span><span class="n">freeze</span><span class="p">()</span>
    
    <span class="n">b</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*** TESTING DataLoaders ***&#39;</span><span class="p">)</span>
        <span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;input_ids&#39;</span><span class="p">]),</span> <span class="n">bsz</span><span class="p">)</span>
        <span class="n">test_eq</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;input_ids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="n">bsz</span><span class="p">,</span> <span class="n">seq_sz</span><span class="p">]))</span>
        <span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">bsz</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*** TESTING Training/Results ***&#39;</span><span class="p">)</span>
        <span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span> <span class="mf">3e-5</span><span class="p">,</span> <span class="n">moms</span><span class="o">=</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.8</span><span class="p">),</span> 
                            <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">HF_TokenClassMetricsCallback</span><span class="p">(</span><span class="n">tok_metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])])</span>

        <span class="n">test_results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">hf_arch</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="s1">&#39;PASSED&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
        <span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">learner</span><span class="o">=</span><span class="n">learn</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">trunc_at</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="n">test_results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">hf_arch</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="s1">&#39;FAILED&#39;</span><span class="p">,</span> <span class="n">err</span><span class="p">))</span>
        
    <span class="k">finally</span><span class="p">:</span>
        <span class="c1"># cleanup</span>
        <span class="k">del</span> <span class="n">learn</span><span class="p">;</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">empty_cache</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>arch</th>
      <th>tokenizer</th>
      <th>model_name</th>
      <th>result</th>
      <th>error</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>albert</td>
      <td>AlbertTokenizerFast</td>
      <td>AlbertForTokenClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>bert</td>
      <td>BertTokenizerFast</td>
      <td>BertForTokenClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>camembert</td>
      <td>CamembertTokenizerFast</td>
      <td>CamembertForTokenClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>distilbert</td>
      <td>DistilBertTokenizerFast</td>
      <td>DistilBertForTokenClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>electra</td>
      <td>ElectraTokenizerFast</td>
      <td>ElectraForTokenClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>5</th>
      <td>flaubert</td>
      <td>FlaubertTokenizer</td>
      <td>FlaubertForTokenClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>6</th>
      <td>funnel</td>
      <td>FunnelTokenizerFast</td>
      <td>FunnelForTokenClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>7</th>
      <td>longformer</td>
      <td>LongformerTokenizerFast</td>
      <td>LongformerForTokenClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>8</th>
      <td>mpnet</td>
      <td>MPNetTokenizerFast</td>
      <td>MPNetForTokenClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>9</th>
      <td>mobilebert</td>
      <td>MobileBertTokenizerFast</td>
      <td>MobileBertForTokenClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>10</th>
      <td>roberta</td>
      <td>RobertaTokenizerFast</td>
      <td>RobertaForTokenClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>11</th>
      <td>squeezebert</td>
      <td>SqueezeBertTokenizerFast</td>
      <td>SqueezeBertForTokenClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>12</th>
      <td>xlm</td>
      <td>XLMTokenizer</td>
      <td>XLMForTokenClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>13</th>
      <td>xlm_roberta</td>
      <td>XLMRobertaTokenizerFast</td>
      <td>XLMRobertaForTokenClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>14</th>
      <td>xlnet</td>
      <td>XLNetTokenizerFast</td>
      <td>XLNetForTokenClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Cleanup">Cleanup<a class="anchor-link" href="#Cleanup"> </a></h2>
</div>
</div>
</div>
</div>
 

