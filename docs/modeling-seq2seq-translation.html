---

title: modeling.seq2seq.translation


keywords: fastai
sidebar: home_sidebar

summary: "This module contains custom models, custom splitters, etc... translation tasks."
description: "This module contains custom models, custom splitters, etc... translation tasks."
nb_path: "nbs/12_modeling-seq2seq-translation.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/12_modeling-seq2seq-translation.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">set_device</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Using GPU #</span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">current_device</span><span class="p">()</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">get_device_name</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Using GPU #1: GeForce GTX 1080 Ti
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Translation">Translation<a class="anchor-link" href="#Translation"> </a></h2><p>Translation tasks attempt to convert text in one language into another</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Prepare-the-data">Prepare the data<a class="anchor-link" href="#Prepare-the-data"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;wmt16&#39;</span><span class="p">,</span> <span class="s1">&#39;de-en&#39;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s1">&#39;train[:1%]&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Reusing dataset wmt16 (/home/wgilliam/.cache/huggingface/datasets/wmt16/de-en/1.0.0/0d9fb3e814712c785176ad8cdb9f465fbe6479000ee6546725db30ad8a8b5f8a)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="p">)</span>
<span class="n">wmt_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;translation&#39;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;de&#39;</span><span class="p">,</span> <span class="s1">&#39;en&#39;</span><span class="p">]);</span> <span class="nb">len</span><span class="p">(</span><span class="n">wmt_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>45489</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wmt_df</span> <span class="o">=</span> <span class="n">wmt_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">1000</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wmt_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>de</th>
      <th>en</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Wiederaufnahme der Sitzungsperiode</td>
      <td>Resumption of the session</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ich erkläre die am Freitag, dem 17. Dezember unterbrochene Sitzungsperiode des Europäischen Parlaments für wiederaufgenommen, wünsche Ihnen nochmals alles Gute zum Jahreswechsel und hoffe, daß Sie schöne Ferien hatten.</td>
      <td>I declare resumed the session of the European Parliament adjourned on Friday 17 December 1999, and I would like once again to wish you a happy new year in the hope that you enjoyed a pleasant festive period.</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pretrained_model_name</span> <span class="o">=</span> <span class="s2">&quot;facebook/bart-large-cnn&quot;</span>
<span class="n">model_cls</span> <span class="o">=</span> <span class="n">AutoModelForSeq2SeqLM</span>

<span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_config</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">hf_model</span> <span class="o">=</span> <span class="n">BLURR</span><span class="o">.</span><span class="n">get_hf_objects</span><span class="p">(</span><span class="n">pretrained_model_name</span><span class="p">,</span> <span class="n">model_cls</span><span class="o">=</span><span class="n">model_cls</span><span class="p">)</span>
<span class="n">hf_arch</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_config</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&#39;bart&#39;,
 transformers.models.bart.tokenization_bart_fast.BartTokenizerFast,
 transformers.models.bart.configuration_bart.BartConfig,
 transformers.models.bart.modeling_bart.BartForConditionalGeneration)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">blocks</span> <span class="o">=</span> <span class="p">(</span><span class="n">HF_Seq2SeqBlock</span><span class="p">(</span><span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_config</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">hf_model</span><span class="p">),</span> <span class="n">noop</span><span class="p">)</span>
<span class="n">dblock</span> <span class="o">=</span> <span class="n">DataBlock</span><span class="p">(</span><span class="n">blocks</span><span class="o">=</span><span class="n">blocks</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;de&#39;</span><span class="p">),</span> <span class="n">get_y</span><span class="o">=</span><span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;en&#39;</span><span class="p">),</span> <span class="n">splitter</span><span class="o">=</span><span class="n">RandomSplitter</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">dblock</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">wmt_df</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;input_ids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(2, torch.Size([2, 325]), torch.Size([2, 86]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span><span class="o">.</span><span class="n">show_batch</span><span class="p">(</span><span class="n">dataloaders</span><span class="o">=</span><span class="n">dls</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">input_trunc_at</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">target_trunc_at</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>&lt;s&gt; Angesichts dieser Situation muß aus dem Bericht, den das Parlament annimmt, klar hervorgehen, daß Maßnahmen notwendig sind, die eindeutig auf die Bekämpfung der relativen Armut und der Arbeitslosigkeit gerichtet sind. Maßnahmen wie die für diese</td>
      <td>Given this situation, the report approved by Parliament must highlight the need for measures that aim unequivocally to fight relative poverty and unemployment: measures such as the appropriate use of structural funds for these purposes, which are of</td>
    </tr>
    <tr>
      <th>1</th>
      <td>&lt;s&gt; Aus diesem Grund ist es eines der wichtigsten und weitreichendsten Ziele, die wir uns in der Europäischen Union stellen sollten, Anstrengungen zur Schaffung neuer Arbeitsplätze in den ländlichen Gebieten außerhalb des Agrarsektors zu unternehmen,</td>
      <td>For this reason, one of the most important and essential objectives which we should set in the European Union is to make efforts to create new jobs in rural areas, outside of the agricultural sector, in sectors such as rural tourism, sport, culture,</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Train-model">Train model<a class="anchor-link" href="#Train-model"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq2seq_metrics</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;bleu&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;returns&#39;</span><span class="p">:</span> <span class="s2">&quot;bleu&quot;</span> <span class="p">},</span>
    <span class="s1">&#39;meteor&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;returns&#39;</span><span class="p">:</span> <span class="s2">&quot;meteor&quot;</span> <span class="p">},</span>
    <span class="s1">&#39;sacrebleu&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;returns&#39;</span><span class="p">:</span> <span class="s2">&quot;score&quot;</span> <span class="p">}</span>
<span class="p">}</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">HF_BaseModelWrapper</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span>

<span class="n">learn_cbs</span> <span class="o">=</span> <span class="p">[</span><span class="n">HF_BaseModelCallback</span><span class="p">]</span>
<span class="n">fit_cbs</span> <span class="o">=</span> <span class="p">[</span><span class="n">HF_Seq2SeqMetricsCallback</span><span class="p">(</span><span class="n">custom_metrics</span><span class="o">=</span><span class="n">seq2seq_metrics</span><span class="p">)]</span>

<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> 
                <span class="n">model</span><span class="p">,</span>
                <span class="n">opt_func</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">Adam</span><span class="p">),</span>
                <span class="n">loss_func</span><span class="o">=</span><span class="n">CrossEntropyLossFlat</span><span class="p">(),</span> <span class="c1">#HF_PreCalculatedLoss()</span>
                <span class="n">cbs</span><span class="o">=</span><span class="n">learn_cbs</span><span class="p">,</span>
                <span class="n">splitter</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">seq2seq_splitter</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="n">hf_arch</span><span class="p">))</span> <span class="c1">#.to_native_fp16() #.to_fp16()</span>

<span class="n">learn</span><span class="o">.</span><span class="n">freeze</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>[nltk_data] Downloading package wordnet to /home/wgilliam/nltk_data...
[nltk_data]   Package wordnet is already up-to-date!
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>HF_BaseModelWrapper (Input shape: 2)
============================================================================
Layer (type)         Output Shape         Param #    Trainable 
============================================================================
                     2 x 115 x 1024      
Embedding                                 51470336   False     
Embedding                                 51470336   False     
____________________________________________________________________________
                     2 x 1024            
BartLearnedPositionalEmbedding                      1050624    False     
Linear                                    1049600    False     
Linear                                    1049600    False     
Linear                                    1049600    False     
Linear                                    1049600    False     
LayerNorm                                 2048       True      
____________________________________________________________________________
                     2 x 325 x 4096      
Linear                                    4198400    False     
____________________________________________________________________________
                     2 x 325 x 1024      
Linear                                    4195328    False     
LayerNorm                                 2048       True      
Linear                                    1049600    False     
Linear                                    1049600    False     
Linear                                    1049600    False     
Linear                                    1049600    False     
LayerNorm                                 2048       True      
____________________________________________________________________________
                     2 x 325 x 4096      
Linear                                    4198400    False     
____________________________________________________________________________
                     2 x 325 x 1024      
Linear                                    4195328    False     
LayerNorm                                 2048       True      
Linear                                    1049600    False     
Linear                                    1049600    False     
Linear                                    1049600    False     
Linear                                    1049600    False     
LayerNorm                                 2048       True      
____________________________________________________________________________
                     2 x 325 x 4096      
Linear                                    4198400    False     
____________________________________________________________________________
                     2 x 325 x 1024      
Linear                                    4195328    False     
LayerNorm                                 2048       True      
Linear                                    1049600    False     
Linear                                    1049600    False     
Linear                                    1049600    False     
Linear                                    1049600    False     
LayerNorm                                 2048       True      
____________________________________________________________________________
                     2 x 325 x 4096      
Linear                                    4198400    False     
____________________________________________________________________________
                     2 x 325 x 1024      
Linear                                    4195328    False     
LayerNorm                                 2048       True      
Linear                                    1049600    False     
Linear                                    1049600    False     
Linear                                    1049600    False     
Linear                                    1049600    False     
LayerNorm                                 2048       True      
____________________________________________________________________________
                     2 x 325 x 4096      
Linear                                    4198400    False     
____________________________________________________________________________
                     2 x 325 x 1024      
Linear                                    4195328    False     
LayerNorm                                 2048       True      
Linear                                    1049600    False     
Linear                                    1049600    False     
Linear                                    1049600    False     
Linear                                    1049600    False     
LayerNorm                                 2048       True      
____________________________________________________________________________
                     2 x 325 x 4096      
Linear                                    4198400    False     
____________________________________________________________________________
                     2 x 325 x 1024      
Linear                                    4195328    False     
LayerNorm                                 2048       True      
Linear                                    1049600    False     
Linear                                    1049600    False     
Linear                                    1049600    False     
Linear                                    1049600    False     
LayerNorm                                 2048       True      
____________________________________________________________________________
                     2 x 325 x 4096      
Linear                                    4198400    False     
____________________________________________________________________________
                     2 x 325 x 1024      
Linear                                    4195328    False     
LayerNorm                                 2048       True      
Linear                                    1049600    False     
Linear                                    1049600    False     
Linear                                    1049600    False     
Linear                                    1049600    False     
LayerNorm                                 2048       True      
____________________________________________________________________________
                     2 x 325 x 4096      
Linear                                    4198400    False     
____________________________________________________________________________
                     2 x 325 x 1024      
Linear                                    4195328    False     
LayerNorm                                 2048       True      
Linear                                    1049600    False     
Linear                                    1049600    False     
Linear                                    1049600    False     
Linear                                    1049600    False     
LayerNorm                                 2048       True      
____________________________________________________________________________
                     2 x 325 x 4096      
Linear                                    4198400    False     
____________________________________________________________________________
                     2 x 325 x 1024      
Linear                                    4195328    False     
LayerNorm                                 2048       True      
Linear                                    1049600    False     
Linear                                    1049600    False     
Linear                                    1049600    False     
Linear                                    1049600    False     
LayerNorm                                 2048       True      
____________________________________________________________________________
                     2 x 325 x 4096      
Linear                                    4198400    False     
____________________________________________________________________________
                     2 x 325 x 1024      
Linear                                    4195328    False     
LayerNorm                                 2048       True      
Linear                                    1049600    False     
Linear                                    1049600    False     
Linear                                    1049600    False     
Linear                                    1049600    False     
LayerNorm                                 2048       True      
____________________________________________________________________________
                     2 x 325 x 4096      
Linear                                    4198400    False     
____________________________________________________________________________
                     2 x 325 x 1024      
Linear                                    4195328    False     
LayerNorm                                 2048       True      
Linear                                    1049600    False     
Linear                                    1049600    False     
Linear                                    1049600    False     
Linear                                    1049600    False     
LayerNorm                                 2048       True      
____________________________________________________________________________
                     2 x 325 x 4096      
Linear                                    4198400    False     
____________________________________________________________________________
                     2 x 325 x 1024      
Linear                                    4195328    False     
LayerNorm                                 2048       True      
LayerNorm                                 2048       True      
____________________________________________________________________________
                     2 x 115 x 1024      
Embedding                                 51470336   False     
____________________________________________________________________________
                     2 x 1024            
BartLearnedPositionalEmbedding                      1050624    False     
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
LayerNorm                                 2048       True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
LayerNorm                                 2048       True      
____________________________________________________________________________
                     2 x 115 x 4096      
Linear                                    4198400    True      
____________________________________________________________________________
                     2 x 115 x 1024      
Linear                                    4195328    True      
LayerNorm                                 2048       True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
LayerNorm                                 2048       True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
LayerNorm                                 2048       True      
____________________________________________________________________________
                     2 x 115 x 4096      
Linear                                    4198400    True      
____________________________________________________________________________
                     2 x 115 x 1024      
Linear                                    4195328    True      
LayerNorm                                 2048       True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
LayerNorm                                 2048       True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
LayerNorm                                 2048       True      
____________________________________________________________________________
                     2 x 115 x 4096      
Linear                                    4198400    True      
____________________________________________________________________________
                     2 x 115 x 1024      
Linear                                    4195328    True      
LayerNorm                                 2048       True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
LayerNorm                                 2048       True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
LayerNorm                                 2048       True      
____________________________________________________________________________
                     2 x 115 x 4096      
Linear                                    4198400    True      
____________________________________________________________________________
                     2 x 115 x 1024      
Linear                                    4195328    True      
LayerNorm                                 2048       True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
LayerNorm                                 2048       True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
LayerNorm                                 2048       True      
____________________________________________________________________________
                     2 x 115 x 4096      
Linear                                    4198400    True      
____________________________________________________________________________
                     2 x 115 x 1024      
Linear                                    4195328    True      
LayerNorm                                 2048       True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
LayerNorm                                 2048       True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
LayerNorm                                 2048       True      
____________________________________________________________________________
                     2 x 115 x 4096      
Linear                                    4198400    True      
____________________________________________________________________________
                     2 x 115 x 1024      
Linear                                    4195328    True      
LayerNorm                                 2048       True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
LayerNorm                                 2048       True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
LayerNorm                                 2048       True      
____________________________________________________________________________
                     2 x 115 x 4096      
Linear                                    4198400    True      
____________________________________________________________________________
                     2 x 115 x 1024      
Linear                                    4195328    True      
LayerNorm                                 2048       True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
LayerNorm                                 2048       True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
LayerNorm                                 2048       True      
____________________________________________________________________________
                     2 x 115 x 4096      
Linear                                    4198400    True      
____________________________________________________________________________
                     2 x 115 x 1024      
Linear                                    4195328    True      
LayerNorm                                 2048       True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
LayerNorm                                 2048       True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
LayerNorm                                 2048       True      
____________________________________________________________________________
                     2 x 115 x 4096      
Linear                                    4198400    True      
____________________________________________________________________________
                     2 x 115 x 1024      
Linear                                    4195328    True      
LayerNorm                                 2048       True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
LayerNorm                                 2048       True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
LayerNorm                                 2048       True      
____________________________________________________________________________
                     2 x 115 x 4096      
Linear                                    4198400    True      
____________________________________________________________________________
                     2 x 115 x 1024      
Linear                                    4195328    True      
LayerNorm                                 2048       True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
LayerNorm                                 2048       True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
LayerNorm                                 2048       True      
____________________________________________________________________________
                     2 x 115 x 4096      
Linear                                    4198400    True      
____________________________________________________________________________
                     2 x 115 x 1024      
Linear                                    4195328    True      
LayerNorm                                 2048       True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
LayerNorm                                 2048       True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
Linear                                    1049600    True      
LayerNorm                                 2048       True      
____________________________________________________________________________
                     2 x 115 x 4096      
Linear                                    4198400    True      
____________________________________________________________________________
                     2 x 115 x 1024      
Linear                                    4195328    True      
LayerNorm                                 2048       True      
LayerNorm                                 2048       True      
____________________________________________________________________________
                     2 x 115 x 50264     
Linear                                    51470336   False     
____________________________________________________________________________

Total params: 560,701,440
Total trainable params: 201,613,312
Total non-trainable params: 359,088,128

Optimizer used: functools.partial(&lt;function Adam at 0x7f7f53c86700&gt;)
Loss function: FlattenedLoss of CrossEntropyLoss()

Model frozen up to parameter group #2

Callbacks:
  - TrainEvalCallback
  - HF_BaseModelCallback
  - Recorder
  - ProgressCallback</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># preds = learn.model(b[0])</span>

<span class="c1"># len(preds),preds[&#39;loss&#39;].shape, preds[&#39;logits&#39;].shape</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;input_ids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(2, 3, torch.Size([2, 325]), 2, torch.Size([2, 86]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">learn</span><span class="o">.</span><span class="n">opt</span><span class="o">.</span><span class="n">param_groups</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>3
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">(</span><span class="n">suggest_funcs</span><span class="o">=</span><span class="p">[</span><span class="n">minimum</span><span class="p">,</span> <span class="n">steep</span><span class="p">,</span> <span class="n">valley</span><span class="p">,</span> <span class="n">slide</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/wgilliam/miniconda3/envs/blurr/lib/python3.9/site-packages/fastai/callback/schedule.py:270: UserWarning: color is redundantly defined by the &#39;color&#39; keyword argument and the fmt string &#34;ro&#34; (-&gt; color=&#39;r&#39;). The keyword argument will take precedence.
  ax.plot(val, idx, &#39;ro&#39;, label=nm, c=color)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(minimum=4.786300996784121e-05, steep=6.918309736647643e-06, valley=tensor(3.6308e-05), slide=tensor(3.0200e-05))</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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l5mIiIi4q7zCktXuXTtlcO27ExERkctiG3avFiIRERFxVyqqFhEREbd3roXItVMG1747ERERuSwlo8x8NVO1iIiIuKs8dZmJiIiIuzs3D5FaiERERMRNqahaRERE3J5tYka1EImIiIi70iizC0hOTubw4cO21+vXr+fRRx9lxowZdgtMREREnM82U7USorJuu+02li1bBkBqaipXXXUV69ev5+mnn+aFF16wa4AiIiLiPLYWInWZlbV9+3a6du0KwFdffUXr1q1Zs2YNn332GbNnz7ZnfCIiIuIkhmFQoC6z8yssLMTHxweApUuXcu211wLQvHlzUlJS7BediIiIOE1J6xCoqLpcrVq1Yvr06axatYolS5YwZMgQAI4ePUp4eLhdAxQRERHn+GNCpBaicrz66qu8//779OvXj1tvvZV27doBsHDhQltXmoiIiNRs+WcLqs0m8DSbnByNY3leykH9+vXj+PHjZGZmUqtWLdv2e++9F39/f7sFJyIiIs5zbsi9ByaTaydEl9RCdObMGfLz823J0KFDh5g2bRoJCQlERkbaNUARERFxDtss1V6u3V0Gl5gQDR8+nDlz5gBw+vRpunXrxuuvv851113He++9Z9cARURExDnySla693Ttgmq4xIRo8+bN9O7dG4Cvv/6aqKgoDh06xJw5c3j77bftGqCIiIg4h1qILiI3N5egoCAAFi9ezIgRIzCbzVxxxRUcOnTIrgGKiIiIc9hWunfxEWZwiQlR48aNWbBgAcnJyfz4448MGjQIgPT0dIKDg+0aoIiIiDjHH4uqXd0lJUTPPfccEydOJC4ujq5du9K9e3eguLWoQ4cOdg1QREREnMPWZeYGLUSXNOz+xhtvpFevXqSkpNjmIAIYMGAA119/vd2CExEREecpaSFy9Vmq4RITIoA6depQp04dDh8+jMlkol69epqUUURExIW4y0r3cIldZlarlRdeeIGQkBBiY2Np0KABoaGhvPjii1it1oufQERERKq9cyvdu35CdEktRM888wwfffQRr7zyCj179sQwDFavXs3zzz9PXl4eL7/8sr3jFBERkSp2bpSZuszK9fHHH/Phhx/aVrkHaNeuHfXq1eOBBx5QQiQiIuICSoqqfd2gheiS7vDkyZM0b968zPbmzZtz8uTJyw5KREREnE/D7i+iXbt2/Oc//ymz/T//+Q9t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3+sXer+i2//8Ws+9YvvouVf+HNX9uQcFBZGVlUXdunUxm+1f8eN2LURms5n69esD4OHhUe43dmW2l7ctODi4yv7DnC9WR56jIvtfaB8998qfo6L76rnb9xyX+71+ofcruv18++m567nb+xw14bk7omWohFsXVY8fP/6yt59v36pij+tX9hwV2f9C++i5V/4cFd1Xz92+57jc7/ULvV/R7c5+5vaKQc+98vTcq5bbdZk5kqNX4pXy6bk7h567c+i5O4eeu3NU5XN36xYie/Px8eEf//gHPj4+zg7Frei5O4eeu3PouTuHnrtzVOVzVwuRiIiIuD21EImIiIjbU0IkIiIibk8JkYiIiLg9JUQiIiLi9pQQiYiIiNtTQuQECQkJtG/f3vbl5+fHggULnB2WWzhw4AD9+/enZcuWtGnThpycHGeH5BY8PT1t3+/33HOPs8NxK7m5ucTGxjJx4kRnh+IWsrKy6NKlC+3bt6dNmzZ88MEHzg7JLSQnJ9OvXz9atmxJ27Zt+e9//1vpc2jYvZNlZ2cTFxfHoUOHCAgIcHY4Lq9v37689NJL9O7dm5MnTxIcHIynp9utYFPlateuzfHjx50dhlt65plnSExMpEGDBkydOtXZ4bg8i8VCfn4+/v7+5Obm0rp1azZs2EB4eLizQ3NpKSkppKWl0b59e9LT0+nYsSMJCQmV+lxVC5GTLVy4kAEDBigZqgI7duzAy8uL3r17AxAWFqZkSFxaYmIiu3fvZujQoc4OxW14eHjg7+8PQF5eHhaLBbU7OF50dDTt27cHIDIykrCwME6ePFmpcyghKsfKlSsZNmwYdevWxWQyldud9e677xIfH4+vry+dOnVi1apVl3Str776iltuueUyI3YNjn7uiYmJBAYGcu2119KxY0cmT55sx+hrrqr4fs/MzKRTp0706tWLFStW2Cnymq0qnvvEiROZMmWKnSJ2DVXx3E+fPk27du2oX78+TzzxBLVr17ZT9DVXVX6ubty4EavVSkxMTKWO06/H5cjJyaFdu3bcdddd3HDDDWXe//LLL3n00Ud599136dmzJ++//z5XX301O3fupEGDBgB06tSJ/Pz8MscuXryYunXrAsUfEqtXr+aLL75w7A3VEI5+7oWFhaxatYqtW7cSGRnJkCFD6NKlC1dddZXD7606q4rv94MHD1K3bl22b9/ONddcw7Zt29x+PShHP/cNGzbQtGlTmjZtypo1axx+PzVFVXy/h4aG8ttvv5GWlsaIESO48cYbiYqKcvi9VWdV9bl64sQJ7rzzTj788MPKB2nIBQHGN998U2pb165djXHjxpXa1rx5c+Opp56q1LnnzJljjBw58nJDdEmOeO5r1qwxBg8ebHv92muvGa+99tplx+pKHPn9XmLIkCHGhg0bLjVEl+SI5/7UU08Z9evXN2JjY43w8HAjODjY+Oc//2mvkF1CVXy/jxs3zvjqq68uNUSX5KjnnpeXZ/Tu3duYM2fOJcWlLrNKKigoYNOmTQwaNKjU9kGDBlX6tzB1l1WcPZ57ly5dSEtL49SpU1itVlauXEmLFi0cEa7LsMdzP3XqlO23usOHD7Nz504aNmxo91hdiT2e+5QpU0hOTubgwYNMnTqVsWPH8txzzzkiXJdhj+eelpZGZmYmUNwLsHLlSpo1a2b3WF2JPZ67YRiMHj2aK6+8kjvuuOOS4lCXWSUdP34ci8VSpvkzKiqK1NTUCp8nIyOD9evXM2/ePHuH6JLs8dw9PT2ZPHkyffr0wTAMBg0axF/+8hdHhOsy7PHcd+3axX333YfZbMZkMvHWW28RFhbmiHBdhr1+zkjl2OO5Hz58mLvvvhvDMDAMgwcffJC2bds6IlyXYY/nvnr1ar788kvatm1rq0/65JNPaNOmTYXjUEJ0iUwmU6nXhmGU2XYhISEhpKWl2Tssl3e5z/3qq6/m6quvtndYLu9ynnuPHj3Ytm2bI8JyeZf7/V5i9OjRdorIPVzOc+/UqRNbt251QFSu73Kee69evbBarZd1fXWZVVLt2rXx8PAok7Wmp6e7fdGcI+m5O4eeu3PouTuHnrtzVJfnroSokry9venUqRNLliwptX3JkiX06NHDSVG5Pj1359Bzdw49d+fQc3eO6vLc1WVWjuzsbPbu3Wt7feDAAbZu3UpYWBgNGjRgwoQJ3HHHHXTu3Jnu3bszY8YMkpKSGDdunBOjrvn03J1Dz9059NydQ8/dOWrEc7+ksWkubtmyZQZQ5mvUqFG2fd555x0jNjbW8Pb2Njp27GisWLHCeQG7CD1359Bzdw49d+fQc3eOmvDctZaZiIiIuD3VEImIiIjbU0IkIiIibk8JkYiIiLg9JUQiIiLi9pQQiYiIiNtTQiQiIiJuTwmRiIiIuD0lRCIiIuL2lBCJSI0SFxfHtGnTnB2GiLgYJUQiUsbo0aO57rrrnB1GuTZs2MC9997r8OvExcVhMpkwmUz4+fnRvHlz/vWvf1HZyf2VwInUDFrcVUSqhcLCQry8vC66X0RERBVEU+yFF15g7Nix5OXlsXTpUu6//36Cg4O57777qiwGEakaaiESkUrbuXMnQ4cOJTAwkKioKO644w6OHz9ue3/RokX06tWL0NBQwsPD+ctf/sK+ffts7x88eBCTycRXX31Fv3798PX1Ze7cubaWqalTpxIdHU14eDjjx4+nsLDQduyfW1xMJhMffvgh119/Pf7+/jRp0oSFCxeWinfhwoU0adIEPz8/+vfvz8cff4zJZOL06dMXvM+goCDq1KlDXFwc99xzD23btmXx4sW29/ft28fw4cOJiooiMDCQLl26sHTpUtv7/fr149ChQzz22GO21qYSa9asoU+fPvj5+RETE8PDDz9MTk5Ohf8NRMS+lBCJSKWkpKTQt29f2rdvz8aNG1m0aBFpaWncfPPNtn1ycnKYMGECGzZs4KeffsJsNnP99ddjtVpLnevJJ5/k4YcfZteuXQwePBiAZcuWsW/fPpYtW8bHH3/M7NmzmT179gVj+uc//8nNN9/M77//ztChQxk5ciQnT54EipOvG2+8keuuu46tW7dy33338cwzz1Tqng3DYPny5ezatatUK1Z2djZDhw5l6dKlbNmyhcGDBzNs2DCSkpIAmD9/PvXr1+eFF14gJSWFlJQUALZt28bgwYMZMWIEv//+O19++SW//PILDz74YKXiEhE7MkRE/mTUqFHG8OHDy33v73//uzFo0KBS25KTkw3ASEhIKPeY9PR0AzC2bdtmGIZhHDhwwACMadOmlblubGysUVRUZNt20003GbfccovtdWxsrPHmm2/aXgPGs88+a3udnZ1tmEwm44cffjAMwzCefPJJo3Xr1qWu88wzzxiAcerUqfIfwNnreHt7GwEBAYaXl5cBGL6+vsbq1avPe4xhGEbLli2Nf//73+eN1zAM44477jDuvffeUttWrVplmM1m48yZMxc8v4g4hlqIRKRSNm3axLJlywgMDLR9NW/eHMDWLbZv3z5uu+02GjZsSHBwMPHx8QC2lpMSnTt3LnP+Vq1a4eHhYXsdHR1Nenr6BWNq27at7e8BAQEEBQXZjklISKBLly6l9u/atWuF7vXxxx9n69atrFixgv79+/PMM8/Qo0cP2/s5OTk88cQTtGzZktDQUAIDA9m9e3eZ+/yzTZs2MXv27FLPcPDgwVitVg4cOFCh2ETEvlRULSKVYrVaGTZsGK+++mqZ96KjowEYNmwYMTExfPDBB9StWxer1Urr1q0pKCgotX9AQECZc/y5sNpkMpXpaqvMMYZhlKrdKdlWEbVr16Zx48Y0btyYefPm0bhxY6644goGDhwIFCdMP/74I1OnTqVx48b4+flx4403lrnPP7Nardx33308/PDDZd5r0KBBhWITEftSQiQildKxY0fmzZtHXFwcnp5lf4ScOHGCXbt28f7779O7d28Afvnll6oO06Z58+Z8//33pbZt3Lix0uepVasWDz30EBMnTmTLli2YTCZWrVrF6NGjuf7664HimqKDBw+WOs7b2xuLxVJqW8eOHdmxYweNGzeudBwi4hjqMhORcmVkZLB169ZSX0lJSYwfP56TJ09y6623sn79evbv38/ixYsZM2YMFouFWrVqER4ezowZM9i7dy8///wzEyZMcNp93HfffezevZsnn3ySPXv28NVXX9mKtP/ccnQx48ePJyEhgXnz5gHQuHFj5s+fz9atW/ntt9+47bbbyrRmxcXFsXLlSo4cOWIbiffkk0+ydu1axo8fz9atW0lMTGThwoU89NBDl3/DInJJlBCJSLmWL19Ohw4dSn0999xz1K1bl9WrV2OxWBg8eDCtW7fmkUceISQkBLPZjNls5osvvmDTpk20bt2axx57jH/9619Ou4/4+Hi+/vpr5s+fT9u2bXnvvfdso8x8fHwqda6IiAjuuOMOnn/+eaxWK2+++Sa1atWiR48eDBs2jMGDB9OxY8dSx7zwwgscPHiQRo0a2eZQatu2LStWrCAxMZHevXvToUMH/v73v9u6HEWk6pmMinami4i4iJdffpnp06eTnJzs7FBEpJpQDZGIuLx3332XLl26EB4ezurVq/nXv/6lOX9EpBQlRCLi8hITE3nppZc4efIkDRo04G9/+xuTJk1ydlgiUo2oy0xERETcnoqqRURExO0pIRIRERG3p4RIRERE3J4SIhEREXF7SohERETE7SkhEhEREbenhEhERETcnhIiERERcXtKiERERMTt/T8wjUeDcsCBcQAAAABJRU5ErkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="mf">4e-5</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="n">fit_cbs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>bleu</th>
      <th>meteor</th>
      <th>sacrebleu</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>2.214521</td>
      <td>2.120290</td>
      <td>0.082260</td>
      <td>0.293250</td>
      <td>7.733167</td>
      <td>02:32</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">learner</span><span class="o">=</span><span class="n">learn</span><span class="p">,</span> <span class="n">input_trunc_at</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">target_trunc_at</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>target</th>
      <th>prediction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Nach meiner Ansicht würde diese zweite Hypothese einem Verzicht auf unsere Verantwortung als Parlament und darüber hinaus dem Aufwerfen einer originellen These, einer unbekannten Methode gleichkommen, die darin bestände, den Fraktionen die programmatische Rede der Kommission in schriftlicher Form eine Woche vorher - und nicht, wie vereinbart, am Tag zuvor - zur Kenntnis zu geben, wobei zu berücksichtigen ist, daß das Legislativprogramm im Februar diskutiert werden wird, so daß wir auf die Aussp</td>
      <td>In my opinion, this second hypothesis would imply the failure of Parliament in its duty as a Parliament, as well as introducing an original thesis, an unknown method which consists of making political groups aware, in writing, of a speech concerning the Commission' s programme a week earlier - and not a day earlier, as had been agreed - bearing in mind that the legislative programme will be discussed in February, so we could forego the debate, since on the next day our citizens will hear about</td>
      <td>Madam Speaker, this is a second Hypothese of our responsibility as a Parliament and of the fact that the Commission' s second point of order is that the Parliament should have been able to present its program to the Commission a week ago - and not just today, as it was, as I have suggested - to the press and the Internet, so that all citizens would have been informed and Parliament would have no reason not to be able to deal with the agenda on February 14th, and also with the issue of an unbeka</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Die Verkehrssicherheit bestimmte in letzter Zeit häufig die Negativschlagzeilen: Das Eisenbahnunglück nahe dem Londoner Bahnhof Paddington, das furchtbare Eisenbahnunglück in Norwegen, zwei Flugzeugabstürze, bei denen EU-Bürger zu Schaden kamen, und die von der Erika vor der bretonischen Küste verursachte Naturkatastrophe sind Ereignisse, die allein in den letzten vier Monaten zu verzeichnen waren. Sie machen deutlich, daß Verkehrssicherheit keine Selbstverständlichkeit ist und daß diejenigen,</td>
      <td>Transport safety has sadly been in the news recently: the Paddington rail crash in London, the terrible rail crash in Norway, the two aviation crashes involving EU citizens and the natural disaster involving the Erika off Brittany - all within the last four months - remind us that transport safety can never be taken for granted and that those charged with protecting the public must be highly motivated and highly qualified.</td>
      <td>In the past few months there have been a number of high-profile incidents, such as the one near Paddington, the one in Norwegen, two airlifts, and the storm of the Erika, which caused a natural disaster, have all occurred in the last four months. They show that safety is not a priority and that those who are responsible for protecting the safety of the public transport system must be more ambitious and more qualified.</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_de</span> <span class="o">=</span> <span class="s2">&quot;Ich trinke gerne Bier&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">outputs</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">blurr_generate</span><span class="p">(</span><span class="n">test_de</span><span class="p">,</span> <span class="n">num_return_sequences</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">outputs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;=== Prediction </span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1"> ===</span><span class="se">\n</span><span class="si">{</span><span class="n">o</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>=== Prediction 1 ===
 I would like to talk about the production of beer first of all, and then on to the product itself, which is a product of the beer industry, and so far, it has been very successful in the beer market in the past few years and is still going strong.

=== Prediction 2 ===
 I would like to talk about the production of beer first of all, and then on to the product itself, which is a product of the beer industry, and so far, it has been very successful in the beer market in the past few years, as you have seen.

=== Prediction 3 ===
 I would like to talk about the production of beer first of all, and then on to the product itself, which is a product of the beer industry, and so far, it has been very successful in the beer market in the past few years, as you know.

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Inference">Inference<a class="anchor-link" href="#Inference"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">export_fname</span> <span class="o">=</span> <span class="s1">&#39;translation_export&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">learn</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">export_fname</span><span class="si">}</span><span class="s1">.pkl&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inf_learn</span> <span class="o">=</span> <span class="n">load_learner</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">export_fname</span><span class="si">}</span><span class="s1">.pkl&#39;</span><span class="p">)</span>
<span class="n">inf_learn</span><span class="o">.</span><span class="n">blurr_generate</span><span class="p">(</span><span class="n">test_de</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39; I would like to talk about the production of beer first of all, and then on to the product itself, which is a product of the beer industry, and so far, it has been very successful in the beer market in the past few years and is still going strong.&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tests">Tests<a class="anchor-link" href="#Tests"> </a></h2><p>The purpose of the following tests is to ensure as much as possible, that the core training code works for the pretrained <strong>summarization models</strong> below.  These tests are excluded from the CI workflow because of how long they would take to run and the amount of data that would be required to download.</p>
<p><strong>Note</strong>: Feel free to modify the code below to test whatever pretrained summarization models you are working with ... and if any of your pretrained summarization models fail, please submit a github issue <em>(or a PR if you'd like to fix it yourself)</em></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">try</span><span class="p">:</span> <span class="k">del</span> <span class="n">learn</span><span class="p">;</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">empty_cache</span><span class="p">()</span>
<span class="k">except</span><span class="p">:</span> <span class="k">pass</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span> <span class="n">model_type</span> <span class="k">for</span> <span class="n">model_type</span> <span class="ow">in</span> <span class="n">BLURR</span><span class="o">.</span><span class="n">get_models</span><span class="p">(</span><span class="n">task</span><span class="o">=</span><span class="s1">&#39;ConditionalGeneration&#39;</span><span class="p">)</span> 
 <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">model_type</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;TF&#39;</span><span class="p">))</span> <span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[transformers.models.bart.modeling_bart.BartForConditionalGeneration,
 transformers.models.bigbird_pegasus.modeling_bigbird_pegasus.BigBirdPegasusForConditionalGeneration,
 transformers.models.blenderbot.modeling_blenderbot.BlenderbotForConditionalGeneration,
 transformers.models.blenderbot_small.modeling_blenderbot_small.BlenderbotSmallForConditionalGeneration,
 transformers.models.fsmt.modeling_fsmt.FSMTForConditionalGeneration,
 transformers.models.led.modeling_led.LEDForConditionalGeneration,
 transformers.models.m2m_100.modeling_m2m_100.M2M100ForConditionalGeneration,
 transformers.models.mbart.modeling_mbart.MBartForConditionalGeneration,
 transformers.models.mt5.modeling_mt5.MT5ForConditionalGeneration,
 transformers.models.pegasus.modeling_pegasus.PegasusForConditionalGeneration,
 transformers.models.prophetnet.modeling_prophetnet.ProphetNetForConditionalGeneration,
 transformers.models.speech_to_text.modeling_speech_to_text.Speech2TextForConditionalGeneration,
 transformers.models.t5.modeling_t5.T5ForConditionalGeneration,
 transformers.models.xlm_prophetnet.modeling_xlm_prophetnet.XLMProphetNetForConditionalGeneration]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pretrained_model_names</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;facebook/bart-base&#39;</span><span class="p">,</span>
    <span class="s1">&#39;facebook/wmt19-de-en&#39;</span><span class="p">,</span>                      <span class="c1"># FSMT</span>
    <span class="s1">&#39;Helsinki-NLP/opus-mt-de-en&#39;</span><span class="p">,</span>                <span class="c1"># MarianMT</span>
    <span class="c1">#&#39;sshleifer/tiny-mbart&#39;,</span>
    <span class="c1">#&#39;google/mt5-small&#39;,</span>
    <span class="s1">&#39;t5-small&#39;</span>
<span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="p">)</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;wmt16&#39;</span><span class="p">,</span> <span class="s1">&#39;de-en&#39;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s1">&#39;train[:1%]&#39;</span><span class="p">)</span>
<span class="n">wmt_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;translation&#39;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;de&#39;</span><span class="p">,</span> <span class="s1">&#39;en&#39;</span><span class="p">]);</span> <span class="nb">len</span><span class="p">(</span><span class="n">wmt_df</span><span class="p">)</span>
<span class="n">wmt_df</span> <span class="o">=</span> <span class="n">wmt_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">1000</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Reusing dataset wmt16 (/home/wgilliam/.cache/huggingface/datasets/wmt16/de-en/1.0.0/0d9fb3e814712c785176ad8cdb9f465fbe6479000ee6546725db30ad8a8b5f8a)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#hide_output</span>
<span class="n">model_cls</span> <span class="o">=</span> <span class="n">AutoModelForSeq2SeqLM</span>
<span class="n">bsz</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">inp_seq_sz</span> <span class="o">=</span> <span class="mi">128</span><span class="p">;</span> <span class="n">trg_seq_sz</span> <span class="o">=</span> <span class="mi">128</span>

<span class="n">test_results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">model_name</span> <span class="ow">in</span> <span class="n">pretrained_model_names</span><span class="p">:</span>
    <span class="n">error</span><span class="o">=</span><span class="kc">None</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;=== </span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s1"> ===</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="n">hf_tok_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">model_name</span> <span class="o">==</span> <span class="s1">&#39;sshleifer/tiny-mbart&#39;</span><span class="p">):</span>
        <span class="n">hf_tok_kwargs</span><span class="p">[</span><span class="s1">&#39;src_lang&#39;</span><span class="p">],</span> <span class="n">hf_tok_kwargs</span><span class="p">[</span><span class="s1">&#39;tgt_lang&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;de_DE&quot;</span><span class="p">,</span> <span class="s2">&quot;en_XX&quot;</span>
            
    
    <span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_config</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">hf_model</span> <span class="o">=</span> <span class="n">BLURR</span><span class="o">.</span><span class="n">get_hf_objects</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> 
                                                                      <span class="n">model_cls</span><span class="o">=</span><span class="n">model_cls</span><span class="p">,</span> 
                                                                      <span class="n">tokenizer_kwargs</span><span class="o">=</span><span class="n">hf_tok_kwargs</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;architecture:</span><span class="se">\t</span><span class="si">{</span><span class="n">hf_arch</span><span class="si">}</span><span class="se">\n</span><span class="s1">tokenizer:</span><span class="se">\t</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="se">\n</span><span class="s1">model:</span><span class="se">\t\t</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="c1"># 1. build your DataBlock</span>
    <span class="n">text_gen_kwargs</span> <span class="o">=</span> <span class="n">default_text_gen_kwargs</span><span class="p">(</span><span class="n">hf_config</span><span class="p">,</span> <span class="n">hf_model</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="s1">&#39;translation&#39;</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">add_t5_prefix</span><span class="p">(</span><span class="n">inp</span><span class="p">):</span> <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;translate German to English: </span><span class="si">{</span><span class="n">inp</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">hf_arch</span> <span class="o">==</span> <span class="s1">&#39;t5&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">inp</span>
    
    <span class="n">before_batch_tfm</span> <span class="o">=</span> <span class="n">HF_Seq2SeqBeforeBatchTransform</span><span class="p">(</span><span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_config</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">hf_model</span><span class="p">,</span>
                                                      <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;max_length&#39;</span><span class="p">,</span> 
                                                      <span class="n">max_length</span><span class="o">=</span><span class="n">inp_seq_sz</span><span class="p">,</span> 
                                                      <span class="n">max_target_length</span><span class="o">=</span><span class="n">trg_seq_sz</span><span class="p">,</span> 
                                                      <span class="n">text_gen_kwargs</span><span class="o">=</span><span class="n">text_gen_kwargs</span><span class="p">)</span>
    
    <span class="n">blocks</span> <span class="o">=</span> <span class="p">(</span><span class="n">HF_Seq2SeqBlock</span><span class="p">(</span><span class="n">before_batch_tfm</span><span class="o">=</span><span class="n">before_batch_tfm</span><span class="p">),</span> <span class="n">noop</span><span class="p">)</span>
    <span class="n">dblock</span> <span class="o">=</span> <span class="n">DataBlock</span><span class="p">(</span><span class="n">blocks</span><span class="o">=</span><span class="n">blocks</span><span class="p">,</span> 
                   <span class="n">get_x</span><span class="o">=</span><span class="n">Pipeline</span><span class="p">([</span><span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;de&#39;</span><span class="p">),</span> <span class="n">add_t5_prefix</span><span class="p">]),</span> 
                   <span class="n">get_y</span><span class="o">=</span><span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;en&#39;</span><span class="p">),</span> 
                   <span class="n">splitter</span><span class="o">=</span><span class="n">RandomSplitter</span><span class="p">())</span>

    <span class="n">dls</span> <span class="o">=</span> <span class="n">dblock</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">wmt_df</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="n">bsz</span><span class="p">)</span> 
    <span class="n">b</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>

    <span class="c1"># 2. build your Learner</span>
    <span class="n">seq2seq_metrics</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="n">model</span> <span class="o">=</span> <span class="n">HF_BaseModelWrapper</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span>
    <span class="n">fit_cbs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">ShortEpochCallback</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">short_valid</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> 
        <span class="n">HF_Seq2SeqMetricsCallback</span><span class="p">(</span><span class="n">custom_metrics</span><span class="o">=</span><span class="n">seq2seq_metrics</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> 
                    <span class="n">model</span><span class="p">,</span>
                    <span class="n">opt_func</span><span class="o">=</span><span class="n">ranger</span><span class="p">,</span>
                    <span class="n">loss_func</span><span class="o">=</span><span class="n">HF_PreCalculatedLoss</span><span class="p">(),</span>
                    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">HF_BaseModelCallback</span><span class="p">],</span>
                    <span class="n">splitter</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">seq2seq_splitter</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="n">hf_arch</span><span class="p">))</span><span class="o">.</span><span class="n">to_fp16</span><span class="p">()</span>

    <span class="n">learn</span><span class="o">.</span><span class="n">create_opt</span><span class="p">()</span> 
    <span class="n">learn</span><span class="o">.</span><span class="n">freeze</span><span class="p">()</span>
    
    <span class="c1"># 3. Run your tests</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*** TESTING DataLoaders ***</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;input_ids&#39;</span><span class="p">]),</span> <span class="n">bsz</span><span class="p">)</span>
        <span class="n">test_eq</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;input_ids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="n">bsz</span><span class="p">,</span> <span class="n">inp_seq_sz</span><span class="p">]))</span>
        <span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">bsz</span><span class="p">)</span>

<span class="c1">#         print(&#39;*** TESTING One pass through the model ***&#39;)</span>
<span class="c1">#         preds = learn.model(b[0])</span>
<span class="c1">#         test_eq(preds[1].shape[0], bsz)</span>
<span class="c1">#         test_eq(preds[1].shape[2], hf_config.vocab_size)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*** TESTING Training/Results ***&#39;</span><span class="p">)</span>
        <span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="n">fit_cbs</span><span class="p">)</span>

        <span class="n">test_results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">hf_arch</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="s1">&#39;PASSED&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
        <span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">learner</span><span class="o">=</span><span class="n">learn</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">input_trunc_at</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">target_trunc_at</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="n">test_results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">hf_arch</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="s1">&#39;FAILED&#39;</span><span class="p">,</span> <span class="n">err</span><span class="p">))</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="c1"># cleanup</span>
        <span class="k">del</span> <span class="n">learn</span><span class="p">;</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">empty_cache</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>arch</th>
      <th>tokenizer</th>
      <th>model_name</th>
      <th>result</th>
      <th>error</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>bart</td>
      <td>BartTokenizerFast</td>
      <td>BartForConditionalGeneration</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>fsmt</td>
      <td>FSMTTokenizer</td>
      <td>FSMTForConditionalGeneration</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>marian</td>
      <td>MarianTokenizer</td>
      <td>MarianMTModel</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>t5</td>
      <td>T5TokenizerFast</td>
      <td>T5ForConditionalGeneration</td>
      <td>PASSED</td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Cleanup">Cleanup<a class="anchor-link" href="#Cleanup"> </a></h2>
</div>
</div>
</div>
</div>
 

