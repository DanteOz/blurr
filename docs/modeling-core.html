---

title: modeling.core


keywords: fastai
sidebar: home_sidebar

summary: "This module contains core custom models, loss functions, and a default layer group splitter for use in applying discriminiative learning rates to your huggingface models trained via fastai"
description: "This module contains core custom models, loss functions, and a default layer group splitter for use in applying discriminiative learning rates to your huggingface models trained via fastai"
nb_path: "nbs/02_modeling-core.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/02_modeling-core.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">set_device</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Using GPU #</span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">current_device</span><span class="p">()</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">get_device_name</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Using GPU #1: GeForce GTX 1080 Ti
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Base-splitter,-model-wrapper,-and-model-callback">Base splitter, model wrapper, and model callback<a class="anchor-link" href="#Base-splitter,-model-wrapper,-and-model-callback"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="hf_splitter" class="doc_header"><code>hf_splitter</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/core.py#L19" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>hf_splitter</code>(<strong><code>m</code></strong>)</p>
</blockquote>
<p>Splits the huggingface model based on various model architecture conventions</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="HF_BaseModelWrapper" class="doc_header"><code>class</code> <code>HF_BaseModelWrapper</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/core.py#L31" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>HF_BaseModelWrapper</code>(<strong><code>hf_model</code></strong>, <strong><code>output_hidden_states</code></strong>=<em><code>False</code></em>, <strong><code>output_attentions</code></strong>=<em><code>False</code></em>, <strong><code>hf_model_kwargs</code></strong>=<em><code>{}</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Same as <code>nn.Module</code>, but no need for subclasses to call <code>super().__init__</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that <a href="/blurr/modeling-core.html#HF_BaseModelWrapper"><code>HF_BaseModelWrapper</code></a> includes some nifty code for just passing in the things your model needs, as not all transformer architectures require/use the same information.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="HF_PreCalculatedLoss" class="doc_header"><code>class</code> <code>HF_PreCalculatedLoss</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/core.py#L51" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>HF_PreCalculatedLoss</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If you want to let your huggingface model calculate the loss for you, make sure you include the <code>labels</code> argument in your inputs and use <a href="/blurr/modeling-core.html#HF_PreCalculatedLoss"><code>HF_PreCalculatedLoss</code></a> as your loss function. Even though we don't really need a loss function per se, we have to provide a custom loss class/function for fastai to function properly (e.g. one with a <code>decodes</code> and <code>activation</code> methods).  Why?  Because these methods will get called in methods like <code>show_results</code> to get the actual predictions.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="HF_BaseModelCallback" class="doc_header"><code>class</code> <code>HF_BaseModelCallback</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/core.py#L57" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>HF_BaseModelCallback</code>(<strong><code>after_create</code></strong>=<em><code>None</code></em>, <strong><code>before_fit</code></strong>=<em><code>None</code></em>, <strong><code>before_epoch</code></strong>=<em><code>None</code></em>, <strong><code>before_train</code></strong>=<em><code>None</code></em>, <strong><code>before_batch</code></strong>=<em><code>None</code></em>, <strong><code>after_pred</code></strong>=<em><code>None</code></em>, <strong><code>after_loss</code></strong>=<em><code>None</code></em>, <strong><code>before_backward</code></strong>=<em><code>None</code></em>, <strong><code>after_backward</code></strong>=<em><code>None</code></em>, <strong><code>after_step</code></strong>=<em><code>None</code></em>, <strong><code>after_cancel_batch</code></strong>=<em><code>None</code></em>, <strong><code>after_batch</code></strong>=<em><code>None</code></em>, <strong><code>after_cancel_train</code></strong>=<em><code>None</code></em>, <strong><code>after_train</code></strong>=<em><code>None</code></em>, <strong><code>before_validate</code></strong>=<em><code>None</code></em>, <strong><code>after_cancel_validate</code></strong>=<em><code>None</code></em>, <strong><code>after_validate</code></strong>=<em><code>None</code></em>, <strong><code>after_cancel_epoch</code></strong>=<em><code>None</code></em>, <strong><code>after_epoch</code></strong>=<em><code>None</code></em>, <strong><code>after_cancel_fit</code></strong>=<em><code>None</code></em>, <strong><code>after_fit</code></strong>=<em><code>None</code></em>) :: <code>Callback</code></p>
</blockquote>
<p>Basic class handling tweaks of the training loop by changing a <code>Learner</code> in various events</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We use a <code>Callback</code> for handling what is returned from the huggingface model. The return type is (<code>ModelOutput</code>)[<a href="https://huggingface.co/transformers/main_classes/output.html#transformers.file_utils.ModelOutput">https://huggingface.co/transformers/main_classes/output.html#transformers.file_utils.ModelOutput</a>] which makes it easy to return all the goodies we asked for.</p>
<p>Note that your <code>Learner</code>'s loss will be set for you only if the huggingface model returns one <em>and</em> you are using the <a href="/blurr/modeling-core.html#HF_PreCalculatedLoss"><code>HF_PreCalculatedLoss</code></a> loss function.</p>
<p>Also note that anything else you asked the model to return (for example, last hidden state, etc..) will be available for you via the <code>blurr_model_outputs</code> property attached to your <code>Learner</code>. For example, assuming you are using BERT for a classification task ... if you have told your <a href="/blurr/modeling-core.html#HF_BaseModelWrapper"><code>HF_BaseModelWrapper</code></a> instance to return attentions, you'd be able to access them via <code>learn.blurr_model_outputs['attentions']</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Sequence-classification">Sequence classification<a class="anchor-link" href="#Sequence-classification"> </a></h2><p>Below demonstrates how to setup your <code>blurr</code> pipeline for a sequence classification task (e.g., a model that requires a single text input)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">IMDB_SAMPLE</span><span class="p">)</span>
<span class="n">imdb_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;texts.csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">imdb_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>label</th>
      <th>text</th>
      <th>is_valid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>negative</td>
      <td>Un-bleeping-believable! Meg Ryan doesn't even look her usual pert lovable self in this, which normally makes me forgive her shallow ticky acting schtick. Hard to believe she was the producer on this dog. Plus Kevin Kline: what kind of suicide trip has his career been on? Whoosh... Banzai!!! Finally this was directed by the guy who did Big Chill? Must be a replay of Jonestown - hollywood style. Wooofff!</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>positive</td>
      <td>This is a extremely well-made film. The acting, script and camera-work are all first-rate. The music is good, too, though it is mostly early in the film, when things are still relatively cheery. There are no really superstars in the cast, though several faces will be familiar. The entire cast does an excellent job with the script.&lt;br /&gt;&lt;br /&gt;But it is hard to watch, because there is no good end to a situation like the one presented. It is now fashionable to blame the British for setting Hindus and Muslims against each other, and then cruelly separating them into two countries. There is som...</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>negative</td>
      <td>Every once in a long while a movie will come along that will be so awful that I feel compelled to warn people. If I labor all my days and I can save but one soul from watching this movie, how great will be my joy.&lt;br /&gt;&lt;br /&gt;Where to begin my discussion of pain. For starters, there was a musical montage every five minutes. There was no character development. Every character was a stereotype. We had swearing guy, fat guy who eats donuts, goofy foreign guy, etc. The script felt as if it were being written as the movie was being shot. The production value was so incredibly low that it felt li...</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>positive</td>
      <td>Name just says it all. I watched this movie with my dad when it came out and having served in Korea he had great admiration for the man. The disappointing thing about this film is that it only concentrate on a short period of the man's life - interestingly enough the man's entire life would have made such an epic bio-pic that it is staggering to imagine the cost for production.&lt;br /&gt;&lt;br /&gt;Some posters elude to the flawed characteristics about the man, which are cheap shots. The theme of the movie "Duty, Honor, Country" are not just mere words blathered from the lips of a high-brassed offic...</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>negative</td>
      <td>This movie succeeds at being one of the most unique movies you've seen. However this comes from the fact that you can't make heads or tails of this mess. It almost seems as a series of challenges set up to determine whether or not you are willing to walk out of the movie and give up the money you just paid. If you don't want to feel slighted you'll sit through this horrible film and develop a real sense of pity for the actors involved, they've all seen better days, but then you realize they actually got paid quite a bit of money to do this and you'll lose pity for them just like you've alr...</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">task</span> <span class="o">=</span> <span class="n">HF_TASKS_AUTO</span><span class="o">.</span><span class="n">SequenceClassification</span>

<span class="n">pretrained_model_name</span> <span class="o">=</span> <span class="s2">&quot;roberta-base&quot;</span> <span class="c1"># &quot;distilbert-base-uncased&quot; &quot;bert-base-uncased&quot;</span>
<span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_config</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">hf_model</span> <span class="o">=</span> <span class="n">BLURR_MODEL_HELPER</span><span class="o">.</span><span class="n">get_hf_objects</span><span class="p">(</span><span class="n">pretrained_model_name</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="n">task</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">blocks</span> <span class="o">=</span> <span class="p">(</span><span class="n">HF_TextBlock</span><span class="p">(</span><span class="n">hf_arch</span><span class="o">=</span><span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="o">=</span><span class="n">hf_tokenizer</span><span class="p">),</span> <span class="n">CategoryBlock</span><span class="p">)</span>

<span class="n">dblock</span> <span class="o">=</span> <span class="n">DataBlock</span><span class="p">(</span><span class="n">blocks</span><span class="o">=</span><span class="n">blocks</span><span class="p">,</span> 
                   <span class="n">get_x</span><span class="o">=</span><span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">),</span> 
                   <span class="n">get_y</span><span class="o">=</span><span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">),</span> 
                   <span class="n">splitter</span><span class="o">=</span><span class="n">ColSplitter</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s1">&#39;is_valid&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">dblock</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">imdb_df</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span><span class="o">.</span><span class="n">show_batch</span><span class="p">(</span><span class="n">dataloaders</span><span class="o">=</span><span class="n">dls</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>category</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Raising Victor Vargas: A Review&lt;br /&gt;&lt;br /&gt;You know, Raising Victor Vargas is like sticking your hands into a big, steaming bowl of oatmeal. It's warm and gooey, but you're not sure if it feels right. Try as I might, no matter how warm and gooey Raising Victor Vargas became I was always aware that something didn't quite feel right. Victor Vargas suffers from a certain overconfidence on the director's part. Apparently, the director thought that the ethnic backdrop of a Latino family on the lower east side, and an idyllic storyline would make the film critic proof. He was right, but it didn't fool me. Raising Victor Vargas is the story about a seventeen-year old boy called, you guessed it, Victor Vargas (Victor Rasuk) who lives his teenage years chasing more skirt than the Rolling Stones could do in all the years they've toured. The movie starts off in `Ugly Fat' Donna's bedroom where Victor is sure to seduce her, but a cry from outside disrupts his plans when his best-friend Harold (Kevin Rivera) comes-a-looking for him. Caught in the attempt by Harold and his sister, Victor Vargas runs off for damage control. Yet even with the embarrassing implication that he's been boffing the homeliest girl in the neighborhood, nothing dissuades young Victor from going off on the hunt for more fresh meat. On a hot, New York City day they make way to the local public swimming pool where Victor's eyes catch a glimpse of the lovely young nymph Judy (Judy Marte), who's not just pretty, but a strong and independent too. The relationship that develops between Victor and Judy becomes the focus of the film. The story also focuses on Victor's family that is comprised of his grandmother or abuelita (Altagracia Guzman), his brother Nino (also played by real life brother to Victor, Silvestre Rasuk) and his sister Vicky (Krystal Rodriguez). The action follows Victor between scenes with Judy and scenes with his family. Victor tries to cope with being an oversexed pimp-daddy, his feelings for Judy and his grandmother's conservative Catholic upbringing.&lt;br /&gt;&lt;br /&gt;The problems that arise from Raising Victor Vargas are a few, but glaring errors. Throughout the film you get to know certain characters like Vicky, Nino, Grandma,</td>
      <td>negative</td>
    </tr>
    <tr>
      <th>1</th>
      <td>The year 2005 saw no fewer than 3 filmed productions of H. G. Wells' great novel, "War of the Worlds". This is perhaps the least well-known and very probably the best of them. No other version of WotW has ever attempted not only to present the story very much as Wells wrote it, but also to create the atmosphere of the time in which it was supposed to take place: the last year of the 19th Century, 1900  using Wells' original setting, in and near Woking, England.&lt;br /&gt;&lt;br /&gt;IMDb seems unfriendly to what they regard as "spoilers". That might apply with some films, where the ending might actually be a surprise, but with regard to one of the most famous novels in the world, it seems positively silly. I have no sympathy for people who have neglected to read one of the seminal works in English literature, so let's get right to the chase. The aliens are destroyed through catching an Earth disease, against which they have no immunity. If that's a spoiler, so be it; after a book and 3 other films (including the 1953 classic), you ought to know how this ends.&lt;br /&gt;&lt;br /&gt;This film, which follows Wells' plot in the main, is also very cleverly presented  in a way that might put many viewers off due to their ignorance of late 19th/early 20th Century photography. Although filmed in a widescreen aspect, the film goes to some lengths to give an impression of contemporaneity. The general coloration of skin and clothes display a sepia tint often found in old photographs (rather than black). Colors are often reminiscent of hand-tinting. At other times, colors are washed out. These variations are typical of early films, which didn't use standardized celluloid stock and therefore presented a good many changes in print quality, even going from black/white to sepia/white to blue/white to reddish/white and so on  as you'll see on occasion here. The special effects are deliberately retrograde, of a sort seen even as late as the 1920s  and yet the Martians and their machines are very much as Wells described them and have a more nearly realistic "feel". Some of effects are really awkward  such as the destruction of Big Ben. The acting is often more in the style of that period than ours. Some aspects of Victorian dress may appear odd, particularly the use of pomade or</td>
      <td>positive</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Training">Training<a class="anchor-link" href="#Training"> </a></h3><p>We'll also add in custom summary methods for blurr learners/models that work with dictionary inputs</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">HF_BaseModelWrapper</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span>

<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> 
                <span class="n">model</span><span class="p">,</span>
                <span class="n">opt_func</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">Adam</span><span class="p">),</span>
                <span class="n">loss_func</span><span class="o">=</span><span class="n">CrossEntropyLossFlat</span><span class="p">(),</span>
                <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy</span><span class="p">],</span>
                <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">HF_BaseModelCallback</span><span class="p">],</span>
                <span class="n">splitter</span><span class="o">=</span><span class="n">hf_splitter</span><span class="p">)</span>

<span class="n">learn</span><span class="o">.</span><span class="n">create_opt</span><span class="p">()</span>             <span class="c1"># -&gt; will create your layer groups based on your &quot;splitter&quot; function</span>
<span class="n">learn</span><span class="o">.</span><span class="n">freeze</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>.to_fp16()</code> requires a GPU so had to remove for tests to run on github.  Let's check that we can get predictions.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SequenceClassifierOutput(loss=None, logits=tensor([[-0.0036, -0.0534],
        [ 0.0017, -0.0455],
        [-0.0068, -0.0423],
        [-0.0100, -0.0215]], device=&#39;cuda:1&#39;, grad_fn=&lt;AddmmBackward&gt;), hidden_states=None, attentions=None)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="blurr_module_summary" class="doc_header"><code>blurr_module_summary</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/core.py#L81" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>blurr_module_summary</code>(<strong><code>learn</code></strong>, <strong>*<code>xb</code></strong>)</p>
</blockquote>
<p>Print a summary of <code>model</code> using <code>xb</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Learner.blurr_summary" class="doc_header"><code>Learner.blurr_summary</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/core.py#L114" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Learner.blurr_summary</code>()</p>
</blockquote>
<p>Print a summary of the model, optimizer and loss function.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have to create our own <code>summary</code> methods above because fastai only works where things are represented by a <em>single tensor</em>.  But in the case of huggingface transformers, a <em>single</em> sequence is represented by <em>multiple tensors</em> (in a dictionary).</p>
<p>The change to make this work is so minor I think that the fastai library can/will hopefully be updated to support this use case.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">learn</span><span class="o">.</span><span class="n">opt</span><span class="o">.</span><span class="n">param_groups</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>3
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">(</span><span class="n">suggestions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(lr_min=8.317637839354575e-05, lr_steep=0.0006918309954926372)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.337360</td>
      <td>0.273024</td>
      <td>0.900000</td>
      <td>00:21</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Showing-results">Showing results<a class="anchor-link" href="#Showing-results"> </a></h3><p>And here we creat a @typedispatched impelmentation of <code>Learner.show_results</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">learner</span><span class="o">=</span><span class="n">learn</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">trunc_at</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>category</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>The trouble with the book, "Memoirs of a Geisha" is that it had Japanese surfaces but underneath the surfaces it was all an American man's way of thinking. Reading the book is like watching a magnificent ballet with great music, sets, and costumes yet performed by barnyard animals dressed in those costumesso far from Japanese ways of thinking were the characters.&lt;br /&gt;&lt;br /&gt;The movie isn't about Japan or real geisha. It is a story about a few American men's mistaken ideas about Japan and geish</td>
      <td>negative</td>
      <td>negative</td>
    </tr>
    <tr>
      <th>1</th>
      <td>&lt;br /&gt;&lt;br /&gt;I'm sure things didn't exactly go the same way in the real life of Homer Hickam as they did in the film adaptation of his book, Rocket Boys, but the movie "October Sky" (an anagram of the book's title) is good enough to stand alone. I have not read Hickam's memoirs, but I am still able to enjoy and understand their film adaptation. The film, directed by Joe Johnston and written by Lewis Colick, records the story of teenager Homer Hickam (Jake Gyllenhaal), beginning in October of 195</td>
      <td>positive</td>
      <td>positive</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Learner.blurr_predict" class="doc_header"><code>Learner.blurr_predict</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/core.py#L145" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Learner.blurr_predict</code>(<strong><code>items</code></strong>, <strong><code>rm_type_tfms</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Same as with <code>summary</code>, we need to replace fastai's <code>Learner.predict</code> method with the one above which is able to work with inputs that are represented by multiple tensors included in a dictionary.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">blurr_predict</span><span class="p">(</span><span class="s1">&#39;I really liked the movie&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[((&#39;positive&#39;,), (#1) [tensor(1)], (#1) [tensor([0.0891, 0.9109])])]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">blurr_predict</span><span class="p">([</span><span class="s1">&#39;I really liked the movie&#39;</span><span class="p">,</span> <span class="s1">&#39;I really hated the movie&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[((&#39;positive&#39;,), (#1) [tensor(1)], (#1) [tensor([0.0891, 0.9109])]),
 ((&#39;negative&#39;,), (#1) [tensor(0)], (#1) [tensor([0.6578, 0.3422])])]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">unfreeze</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mf">1e-7</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.290937</td>
      <td>0.235788</td>
      <td>0.905000</td>
      <td>00:33</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.141400</td>
      <td>0.237351</td>
      <td>0.915000</td>
      <td>00:33</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.118035</td>
      <td>0.263154</td>
      <td>0.920000</td>
      <td>00:33</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">recorder</span><span class="o">.</span><span class="n">plot_loss</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">learner</span><span class="o">=</span><span class="n">learn</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">trunc_at</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>category</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>The trouble with the book, "Memoirs of a Geisha" is that it had Japanese surfaces but underneath the surfaces it was all an American man's way of thinking. Reading the book is like watching a magnificent ballet with great music, sets, and costumes yet performed by barnyard animals dressed in those costumesso far from Japanese ways of thinking were the characters.&lt;br /&gt;&lt;br /&gt;The movie isn't about Japan or real geisha. It is a story about a few American men's mistaken ideas about Japan and geish</td>
      <td>negative</td>
      <td>negative</td>
    </tr>
    <tr>
      <th>1</th>
      <td>&lt;br /&gt;&lt;br /&gt;I'm sure things didn't exactly go the same way in the real life of Homer Hickam as they did in the film adaptation of his book, Rocket Boys, but the movie "October Sky" (an anagram of the book's title) is good enough to stand alone. I have not read Hickam's memoirs, but I am still able to enjoy and understand their film adaptation. The film, directed by Joe Johnston and written by Lewis Colick, records the story of teenager Homer Hickam (Jake Gyllenhaal), beginning in October of 195</td>
      <td>positive</td>
      <td>positive</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">blurr_predict</span><span class="p">(</span><span class="s2">&quot;This was a really good movie&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[((&#39;positive&#39;,), (#1) [tensor(1)], (#1) [tensor([0.0768, 0.9232])])]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">blurr_predict</span><span class="p">(</span><span class="s2">&quot;Acting was so bad it was almost funny.&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[((&#39;negative&#39;,), (#1) [tensor(0)], (#1) [tensor([0.9510, 0.0490])])]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Inference">Inference<a class="anchor-link" href="#Inference"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">export_fname</span> <span class="o">=</span> <span class="s1">&#39;seq_class_learn_export&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Using-fast.ai-Learner.export-and-load_learner">Using fast.ai <code>Learner.export</code> and <code>load_learner</code><a class="anchor-link" href="#Using-fast.ai-Learner.export-and-load_learner"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">export_fname</span><span class="si">}</span><span class="s1">.pkl&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inf_learn</span> <span class="o">=</span> <span class="n">load_learner</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">export_fname</span><span class="si">}</span><span class="s1">.pkl&#39;</span><span class="p">)</span>
<span class="n">inf_learn</span><span class="o">.</span><span class="n">blurr_predict</span><span class="p">(</span><span class="s2">&quot;This movie should not be seen by anyone!!!!&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[((&#39;negative&#39;,), (#1) [tensor(0)], (#1) [tensor([0.9130, 0.0870])])]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Using-ONNX">Using ONNX<a class="anchor-link" href="#Using-ONNX"> </a></h4><p>Much of the inspiration for the code below comes from Zach Mueller's excellent <a href="https://muellerzr.github.io/fastinference/">fastinference library</a>, and in many places I simply adapted his code to work with blurr and the various huggingface transformers tasks.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Learner.blurr_to_onnx" class="doc_header"><code>Learner.blurr_to_onnx</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/core.py#L174" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Learner.blurr_to_onnx</code>(<strong><code>fname</code></strong>=<em><code>'export'</code></em>, <strong><code>path</code></strong>=<em><code>None</code></em>, <strong><code>quantize</code></strong>=<em><code>False</code></em>, <strong><code>excluded_input_names</code></strong>=<em><code>[]</code></em>)</p>
</blockquote>
<p>Export model to <code>ONNX</code> format</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">blurr_to_onnx</span><span class="p">(</span><span class="n">export_fname</span><span class="p">,</span> <span class="n">quantize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/wgilliam/anaconda3/envs/blurr/lib/python3.7/site-packages/transformers/modeling_utils.py:1673: TracerWarning: Converting a tensor to a Python boolean might cause the trace to be incorrect. We can&#39;t record the data flow of Python values, so this value will be treated as a constant in the future. This means that the trace might not generalize to other inputs!
  input_tensor.shape[chunk_dim] == tensor_shape for input_tensor in input_tensors
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="blurrONNX" class="doc_header"><code>class</code> <code>blurrONNX</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/core.py#L211" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>blurrONNX</code>(<strong><code>fname</code></strong>=<em><code>'export'</code></em>, <strong><code>path</code></strong>=<em><code>Path('.')</code></em>, <strong><code>use_quant_version</code></strong>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">onnx_inf</span> <span class="o">=</span> <span class="n">blurrONNX</span><span class="p">(</span><span class="n">export_fname</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">onnx_inf</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="s1">&#39;I really liked the movie&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[((&#39;positive&#39;,), (#1) [tensor(1)], (#1) [tensor([0.0478, 0.9522])])]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">timeit</span> inf_learn.blurr_predict([&#39;I really liked the movie&#39;, &#39;I hated everything in it&#39;])
<span class="o">%</span><span class="k">timeit</span> onnx_inf.predict([&#39;I really liked the movie&#39;, &#39;I hated everything in it&#39;])
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>61.6 ms ± 2.27 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
4.12 ms ± 44.5 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">onnx_inf</span> <span class="o">=</span> <span class="n">blurrONNX</span><span class="p">(</span><span class="n">export_fname</span><span class="p">,</span> <span class="n">use_quant_version</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">onnx_inf</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="s1">&#39;I hated everything in it&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[((&#39;negative&#39;,), (#1) [tensor(0)], (#1) [tensor([0.6806, 0.3194])])]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">timeit</span> inf_learn.blurr_predict([&#39;I really liked the movie&#39;, &#39;I hated everything in it&#39;])
<span class="o">%</span><span class="k">timeit</span> onnx_inf.predict([&#39;I really liked the movie&#39;, &#39;I hated everything in it&#39;])
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>62.7 ms ± 2.84 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
22.1 ms ± 393 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tests">Tests<a class="anchor-link" href="#Tests"> </a></h2><p>The tests below to ensure the core training code above works for <strong>all</strong> pretrained sequence classification models available in huggingface.  These tests are excluded from the CI workflow because of how long they would take to run and the amount of data that would be required to download.</p>
<p><strong>Note</strong>: Feel free to modify the code below to test whatever pretrained classification models you are working with ... and if any of your pretrained sequence classification models fail, please submit a github issue <em>(or a PR if you'd like to fix it yourself)</em></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">try</span><span class="p">:</span> <span class="k">del</span> <span class="n">learn</span><span class="p">;</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">empty_cache</span><span class="p">()</span>
<span class="k">except</span><span class="p">:</span> <span class="k">pass</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">BLURR_MODEL_HELPER</span><span class="o">.</span><span class="n">get_models</span><span class="p">(</span><span class="n">task</span><span class="o">=</span><span class="s1">&#39;SequenceClassification&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[transformers.models.albert.modeling_albert.AlbertForSequenceClassification,
 transformers.models.auto.modeling_auto.AutoModelForSequenceClassification,
 transformers.models.bart.modeling_bart.BartForSequenceClassification,
 transformers.models.bert.modeling_bert.BertForSequenceClassification,
 transformers.models.camembert.modeling_camembert.CamembertForSequenceClassification,
 transformers.models.deberta.modeling_deberta.DebertaForSequenceClassification,
 transformers.models.distilbert.modeling_distilbert.DistilBertForSequenceClassification,
 transformers.models.electra.modeling_electra.ElectraForSequenceClassification,
 transformers.models.flaubert.modeling_flaubert.FlaubertForSequenceClassification,
 transformers.models.funnel.modeling_funnel.FunnelForSequenceClassification,
 transformers.models.gpt2.modeling_gpt2.GPT2ForSequenceClassification,
 transformers.models.longformer.modeling_longformer.LongformerForSequenceClassification,
 transformers.models.mobilebert.modeling_mobilebert.MobileBertForSequenceClassification,
 transformers.models.openai.modeling_openai.OpenAIGPTForSequenceClassification,
 transformers.models.reformer.modeling_reformer.ReformerForSequenceClassification,
 transformers.models.roberta.modeling_roberta.RobertaForSequenceClassification,
 transformers.models.squeezebert.modeling_squeezebert.SqueezeBertForSequenceClassification,
 transformers.models.xlm.modeling_xlm.XLMForSequenceClassification,
 transformers.models.xlm_roberta.modeling_xlm_roberta.XLMRobertaForSequenceClassification,
 transformers.models.xlnet.modeling_xlnet.XLNetForSequenceClassification]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pretrained_model_names</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;albert-base-v1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;facebook/bart-base&#39;</span><span class="p">,</span>
    <span class="s1">&#39;bert-base-uncased&#39;</span><span class="p">,</span>
    <span class="s1">&#39;camembert-base&#39;</span><span class="p">,</span>
    <span class="s1">&#39;microsoft/deberta-base&#39;</span><span class="p">,</span>
    <span class="s1">&#39;distilbert-base-uncased&#39;</span><span class="p">,</span>
    <span class="s1">&#39;monologg/electra-small-finetuned-imdb&#39;</span><span class="p">,</span>
    <span class="s1">&#39;flaubert/flaubert_small_cased&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;funnel-transformer/small-base&#39;</span><span class="p">,</span>
    <span class="c1"># &#39;sshleifer/tiny-gpt2&#39;,                # works, but requires setting pad_token manually</span>
    <span class="s1">&#39;allenai/longformer-base-4096&#39;</span><span class="p">,</span>
    <span class="s1">&#39;google/mobilebert-uncased&#39;</span><span class="p">,</span>
    <span class="c1"># &#39;openai-gpt&#39;,                         # works, but requires setting pad_token manually</span>
    <span class="c1"># &#39;google/reformer-enwik8&#39;,             # TODO</span>
    <span class="s1">&#39;roberta-base&#39;</span><span class="p">,</span>
    <span class="s1">&#39;squeezebert/squeezebert-uncased&#39;</span><span class="p">,</span>
    <span class="s1">&#39;xlm-mlm-en-2048&#39;</span><span class="p">,</span>
    <span class="s1">&#39;xlm-roberta-base&#39;</span><span class="p">,</span>
    <span class="s1">&#39;xlnet-base-cased&#39;</span>
<span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">IMDB_SAMPLE</span><span class="p">)</span>

<span class="n">model_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;models&#39;</span><span class="p">)</span>
<span class="n">imdb_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;texts.csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#hide_output</span>
<span class="n">task</span> <span class="o">=</span> <span class="n">HF_TASKS_AUTO</span><span class="o">.</span><span class="n">SequenceClassification</span>
<span class="n">bsz</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">seq_sz</span> <span class="o">=</span> <span class="mi">128</span>

<span class="n">test_results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">model_name</span> <span class="ow">in</span> <span class="n">pretrained_model_names</span><span class="p">:</span>
    <span class="n">error</span><span class="o">=</span><span class="kc">None</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;=== </span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s1"> ===</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_config</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">hf_model</span> <span class="o">=</span> <span class="n">BLURR_MODEL_HELPER</span><span class="o">.</span><span class="n">get_hf_objects</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> 
                                                                                   <span class="n">task</span><span class="o">=</span><span class="n">task</span><span class="p">,</span> 
                                                                                   <span class="n">config_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;num_labels&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;architecture:</span><span class="se">\t</span><span class="si">{</span><span class="n">hf_arch</span><span class="si">}</span><span class="se">\n</span><span class="s1">tokenizer:</span><span class="se">\t</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="se">\n</span><span class="s1">model:</span><span class="se">\t\t</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

                    
    <span class="n">blocks</span> <span class="o">=</span> <span class="p">(</span><span class="n">HF_TextBlock</span><span class="p">(</span><span class="n">hf_arch</span><span class="o">=</span><span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="o">=</span><span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="n">seq_sz</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;max_length&#39;</span><span class="p">),</span> 
              <span class="n">CategoryBlock</span><span class="p">)</span>

    <span class="n">dblock</span> <span class="o">=</span> <span class="n">DataBlock</span><span class="p">(</span><span class="n">blocks</span><span class="o">=</span><span class="n">blocks</span><span class="p">,</span> 
                       <span class="n">get_x</span><span class="o">=</span><span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">),</span> 
                       <span class="n">get_y</span><span class="o">=</span><span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">),</span> 
                       <span class="n">splitter</span><span class="o">=</span><span class="n">ColSplitter</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s1">&#39;is_valid&#39;</span><span class="p">))</span>
    
    <span class="n">dls</span> <span class="o">=</span> <span class="n">dblock</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">imdb_df</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="n">bsz</span><span class="p">)</span>
    
    <span class="n">model</span> <span class="o">=</span> <span class="n">HF_BaseModelWrapper</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span>
    <span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> 
                    <span class="n">model</span><span class="p">,</span>
                    <span class="n">opt_func</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">Adam</span><span class="p">),</span>
                    <span class="n">loss_func</span><span class="o">=</span><span class="n">CrossEntropyLossFlat</span><span class="p">(),</span>
                    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy</span><span class="p">],</span>
                    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">HF_BaseModelCallback</span><span class="p">],</span>
                    <span class="n">splitter</span><span class="o">=</span><span class="n">hf_splitter</span><span class="p">)</span><span class="o">.</span><span class="n">to_fp16</span><span class="p">()</span>

    <span class="n">learn</span><span class="o">.</span><span class="n">create_opt</span><span class="p">()</span>             <span class="c1"># -&gt; will create your layer groups based on your &quot;splitter&quot; function</span>
    <span class="n">learn</span><span class="o">.</span><span class="n">freeze</span><span class="p">()</span>
    
    <span class="n">b</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*** TESTING DataLoaders ***&#39;</span><span class="p">)</span>
        <span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="n">bsz</span><span class="p">)</span>
        <span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;input_ids&#39;</span><span class="p">]),</span> <span class="n">bsz</span><span class="p">)</span>
        <span class="n">test_eq</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;input_ids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="n">bsz</span><span class="p">,</span> <span class="n">seq_sz</span><span class="p">]))</span>
        <span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">bsz</span><span class="p">)</span>

<span class="c1">#         print(&#39;*** TESTING One pass through the model ***&#39;)</span>
<span class="c1">#         preds = learn.model(b[0])</span>
<span class="c1">#         test_eq(len(preds[0]), bsz)</span>
<span class="c1">#         test_eq(preds[0].shape, torch.Size([bsz, 2]))</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*** TESTING Training/Results ***&#39;</span><span class="p">)</span>
        <span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>

        <span class="n">test_results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">hf_arch</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="s1">&#39;PASSED&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
        <span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">learner</span><span class="o">=</span><span class="n">learn</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">trunc_at</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="n">test_results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">hf_arch</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="s1">&#39;FAILED&#39;</span><span class="p">,</span> <span class="n">err</span><span class="p">))</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="c1"># cleanup</span>
        <span class="k">del</span> <span class="n">learn</span><span class="p">;</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">empty_cache</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>arch</th>
      <th>tokenizer</th>
      <th>model</th>
      <th>result</th>
      <th>error</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>albert</td>
      <td>AlbertTokenizerFast</td>
      <td>AlbertForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>bart</td>
      <td>BartTokenizerFast</td>
      <td>BartForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>bert</td>
      <td>BertTokenizerFast</td>
      <td>BertForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>camembert</td>
      <td>CamembertTokenizerFast</td>
      <td>CamembertForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>deberta</td>
      <td>DebertaTokenizer</td>
      <td>DebertaForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>5</th>
      <td>distilbert</td>
      <td>DistilBertTokenizerFast</td>
      <td>DistilBertForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>6</th>
      <td>electra</td>
      <td>ElectraTokenizerFast</td>
      <td>ElectraForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>7</th>
      <td>flaubert</td>
      <td>FlaubertTokenizer</td>
      <td>FlaubertForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>8</th>
      <td>funnel</td>
      <td>FunnelTokenizerFast</td>
      <td>FunnelForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>9</th>
      <td>longformer</td>
      <td>LongformerTokenizerFast</td>
      <td>LongformerForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>10</th>
      <td>mobilebert</td>
      <td>MobileBertTokenizerFast</td>
      <td>MobileBertForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>11</th>
      <td>roberta</td>
      <td>RobertaTokenizerFast</td>
      <td>RobertaForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>12</th>
      <td>squeezebert</td>
      <td>SqueezeBertTokenizerFast</td>
      <td>SqueezeBertForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>13</th>
      <td>xlm</td>
      <td>XLMTokenizer</td>
      <td>XLMForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>14</th>
      <td>xlm_roberta</td>
      <td>XLMRobertaTokenizerFast</td>
      <td>XLMRobertaForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>15</th>
      <td>xlnet</td>
      <td>XLNetTokenizerFast</td>
      <td>XLNetForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Cleanup">Cleanup<a class="anchor-link" href="#Cleanup"> </a></h2>
</div>
</div>
</div>
</div>
 

