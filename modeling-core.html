---

title: modeling.core


keywords: fastai
sidebar: home_sidebar

summary: "This module contains core custom models, loss functions, and a default layer group splitter for use in applying discriminiative learning rates to your Hugging Face models trained via fastai"
description: "This module contains core custom models, loss functions, and a default layer group splitter for use in applying discriminiative learning rates to your Hugging Face models trained via fastai"
nb_path: "nbs/01_modeling-core.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/01_modeling-core.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>What we&#39;re running with at the time this documentation was generated:
torch: 1.10.1+cu102
fastai: 2.5.3
transformers: 4.15.0
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Base-splitter,-model-wrapper,-and-model-callback">Base splitter, model wrapper, and model callback<a class="anchor-link" href="#Base-splitter,-model-wrapper,-and-model-callback"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="hf_splitter"><a href="/blurr/modeling-core.html#hf_splitter"><code>hf_splitter</code></a><a class="anchor-link" href="#hf_splitter"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="hf_splitter" class="doc_header"><code>hf_splitter</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/core.py#L31" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>hf_splitter</code>(<strong><code>m</code></strong>:<code>Module</code>)</p>
</blockquote>
<p>Splits the Hugging Face model based on various model architecture conventions</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>m</code></strong> : <em><code>&lt;class 'fastai.torch_core.Module'&gt;</code></em></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="HF_BaseModelWrapper"><a href="/blurr/modeling-core.html#HF_BaseModelWrapper"><code>HF_BaseModelWrapper</code></a><a class="anchor-link" href="#HF_BaseModelWrapper"> </a></h3><p>Note that <a href="/blurr/modeling-core.html#HF_BaseModelWrapper"><code>HF_BaseModelWrapper</code></a> includes some nifty code for just passing in the things your model needs, as not all transformer architectures require/use the same information.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="HF_BaseModelWrapper" class="doc_header"><code>class</code> <code>HF_BaseModelWrapper</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/core.py#L44" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>HF_BaseModelWrapper</code>(<strong><code>hf_model</code></strong>:<code>PreTrainedModel</code>, <strong><code>output_hidden_states</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>output_attentions</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>hf_model_kwargs</code></strong>=<em><code>{}</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Same as <code>nn.Module</code>, but no need for subclasses to call <code>super().__init__</code></p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>hf_model</code></strong> : <em><code>&lt;class 'transformers.modeling_utils.PreTrainedModel'&gt;</code></em>   <p>Your Hugging Face model</p></li>
</ul>
<ul>
<li><strong><code>output_hidden_states</code></strong> : <em><code>&lt;class 'bool'&gt;</code></em>, <em>optional</em>  <p>If True, hidden_states will be returned and accessed from Learner</p></li>
</ul>
<ul>
<li><strong><code>output_attentions</code></strong> : <em><code>&lt;class 'bool'&gt;</code></em>, <em>optional</em> <p>If True, attentions will be returned and accessed from Learner</p></li>
</ul>
<ul>
<li><strong><code>hf_model_kwargs</code></strong> : <em><code>&lt;class 'dict'&gt;</code></em>, <em>optional</em>   <p>Any additional keyword arguments you want passed into your models forward method</p></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="HF_PreCalculatedLoss"><a href="/blurr/modeling-core.html#HF_PreCalculatedLoss"><code>HF_PreCalculatedLoss</code></a><a class="anchor-link" href="#HF_PreCalculatedLoss"> </a></h3><p>If you want to let your Hugging Face model calculate the loss for you, make sure you include the <code>labels</code> argument in your inputs and use <a href="/blurr/modeling-core.html#HF_PreCalculatedLoss"><code>HF_PreCalculatedLoss</code></a> as your loss function. Even though we don't really need a loss function per se, we have to provide a custom loss class/function for fastai to function properly (e.g. one with a <code>decodes</code> and <code>activation</code> methods).  Why?  Because these methods will get called in methods like <code>show_results</code> to get the actual predictions.</p>
<p><strong>Note</strong>: The Hugging Face models <strong><em>will always</em></strong> calculate the loss for you <strong><em>if</em></strong> you pass a <code>labels</code> dictionary along with your other inputs (so only include it if that is what you intend to happen)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="HF_PreCalculatedLoss" class="doc_header"><code>class</code> <code>HF_PreCalculatedLoss</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/core.py#L78" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>HF_PreCalculatedLoss</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="HF_BaseModelCallback"><a href="/blurr/modeling-core.html#HF_BaseModelCallback"><code>HF_BaseModelCallback</code></a><a class="anchor-link" href="#HF_BaseModelCallback"> </a></h3><p>We use a <code>Callback</code> for handling what is returned from the Hugging Face model. The return type is (<code>ModelOutput</code>)[<a href="https://huggingface.co/transformers/main_classes/output.html#transformers.file_utils.ModelOutput">https://huggingface.co/transformers/main_classes/output.html#transformers.file_utils.ModelOutput</a>] which makes it easy to return all the goodies we asked for.</p>
<p>Note that your <code>Learner</code>'s loss will be set for you only if the Hugging Face model returns one <em>and</em> you are using the <a href="/blurr/modeling-core.html#HF_PreCalculatedLoss"><code>HF_PreCalculatedLoss</code></a> loss function.</p>
<p>Also note that anything else you asked the model to return (for example, last hidden state, etc..) will be available for you via the <code>blurr_model_outputs</code> property attached to your <code>Learner</code>. For example, assuming you are using BERT for a classification task ... if you have told your <a href="/blurr/modeling-core.html#HF_BaseModelWrapper"><code>HF_BaseModelWrapper</code></a> instance to return attentions, you'd be able to access them via <code>learn.blurr_model_outputs['attentions']</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="HF_BaseModelCallback" class="doc_header"><code>class</code> <code>HF_BaseModelCallback</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/core.py#L90" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>HF_BaseModelCallback</code>(<strong><code>after_create</code></strong>=<em><code>None</code></em>, <strong><code>before_fit</code></strong>=<em><code>None</code></em>, <strong><code>before_epoch</code></strong>=<em><code>None</code></em>, <strong><code>before_train</code></strong>=<em><code>None</code></em>, <strong><code>before_batch</code></strong>=<em><code>None</code></em>, <strong><code>after_pred</code></strong>=<em><code>None</code></em>, <strong><code>after_loss</code></strong>=<em><code>None</code></em>, <strong><code>before_backward</code></strong>=<em><code>None</code></em>, <strong><code>before_step</code></strong>=<em><code>None</code></em>, <strong><code>after_cancel_step</code></strong>=<em><code>None</code></em>, <strong><code>after_step</code></strong>=<em><code>None</code></em>, <strong><code>after_cancel_batch</code></strong>=<em><code>None</code></em>, <strong><code>after_batch</code></strong>=<em><code>None</code></em>, <strong><code>after_cancel_train</code></strong>=<em><code>None</code></em>, <strong><code>after_train</code></strong>=<em><code>None</code></em>, <strong><code>before_validate</code></strong>=<em><code>None</code></em>, <strong><code>after_cancel_validate</code></strong>=<em><code>None</code></em>, <strong><code>after_validate</code></strong>=<em><code>None</code></em>, <strong><code>after_cancel_epoch</code></strong>=<em><code>None</code></em>, <strong><code>after_epoch</code></strong>=<em><code>None</code></em>, <strong><code>after_cancel_fit</code></strong>=<em><code>None</code></em>, <strong><code>after_fit</code></strong>=<em><code>None</code></em>) :: <code>Callback</code></p>
</blockquote>
<p>Basic class handling tweaks of the training loop by changing a <code>Learner</code> in various events</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>after_create</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>before_fit</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>before_epoch</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>before_train</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>before_batch</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>after_pred</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>after_loss</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>before_backward</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>before_step</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>after_cancel_step</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>after_step</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>after_cancel_batch</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>after_batch</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>after_cancel_train</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>after_train</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>before_validate</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>after_cancel_validate</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>after_validate</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>after_cancel_epoch</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>after_epoch</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>after_cancel_fit</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>after_fit</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Sequence-classification">Sequence classification<a class="anchor-link" href="#Sequence-classification"> </a></h2><p>Below demonstrates how to setup your <code>blurr</code> pipeline for a sequence classification task (e.g., a model that requires a single text input) using the mid, high, and low-level API</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Using-the-mid-level-API">Using the mid-level API<a class="anchor-link" href="#Using-the-mid-level-API"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">raw_datasets</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;imdb&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">])</span>
<span class="n">raw_datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw_datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s1">&#39;is_valid&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">raw_datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">raw_datasets</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw_datasets</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s1">&#39;is_valid&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">raw_datasets</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

<span class="n">final_ds</span> <span class="o">=</span> <span class="n">concatenate_datasets</span><span class="p">([</span><span class="n">raw_datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shuffle</span><span class="p">()</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)),</span> <span class="n">raw_datasets</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shuffle</span><span class="p">()</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">))])</span>
<span class="n">imdb_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">final_ds</span><span class="p">)</span>
<span class="n">imdb_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Reusing dataset imdb (/home/wgilliam/.cache/huggingface/datasets/imdb/plain_text/1.0.0/4ea52f2e58a08dbc12c2bd52d0d92b30b88c00230b4522801b3636782f625c5b)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>label</th>
      <th>text</th>
      <th>is_valid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>While the original 1932 version, with Preston Foster, was good, there's no remake more worthy than this 1959 one, or more impossible to find anywhere, just as I strongly suspect Mickey Rooney to have had something to do with that. Never could a mere performance have ever been so masterfully brilliant, or a script more thought-provoking, as well as an improvement upon the original. Many years after the last of my several viewings of this film, in 1970, I read an article in which Mickey Rooney was recounting a visit he'd made to death row, and which had apparently very drastically eliminated...</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Ironically the most talked-about American film in the 2008 New York Film Festival is 98% in Spanish. The extra-long film's controversy began at the Cannes Festival. There were love-hate notices, and considerable doubts about commercial prospects. As consolation the star, Benicio Del Toro, got the Best Actor award there. I'm talking about Steven Soderbergh's 'Che,' of course. That's the name it's going by in this version, shown in New York as at Cannes in two 2-hour-plus segments without opening title or end credits. 'Che' is certainly appropriate since Ernesto "Che" Guevara is in almost ev...</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>Bingo is the game, bullshit is the name. Rarely has the screen been smeared with such a blown-up hodgepodge of half-baked conspiracy theories, puritan prudery, and new-age gibberish. The bulk of the story is set at Viciente, a Cristian resort in the Peruvian jungle. Think Tolkien's Rivendell meets Star Trek's Planet Baku, inhabited by dimwitted followers of a not-so-mysterious, but surprisingly narrow-minded cult of love and peace. Thanks to gruesome acting and tacky production design (the rainbow-colored visualization of the mysterious all-healing "energy" is particularly hideous), "The C...</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>There are so many reasons as to why I rate the sopranos so highly, one of its biggest triumphs being the cast and character building. Each character unfolds more and more each series. Also each series has an array of different 'small time characters' as well as the main. A good example of a character (who was only in three episodes) who you can feel for is David the compulsive gambler played brilliantly by Robert Patrick. Every little detail builds the perfect TV series. The show revolves round mob boss Tony Soprano (James Gandolfini) who attempts to balance his life of crime with his role...</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>I thought watching employment videos on corporate compliance was tedious. This movie went nowhere fast. What could have been a somewhat cheesy half hour twilight zone episode turned into a seemingly endless waste of film on people parking their cars, a picture of some dude's swimming pool (he really needs to answer his phone by the way) a dot matrix printer doing its job, and Heuy and Louey sitting in a yellow lighted control room repeating "T minus 10 and counting" as if something exciting is going to happen. It doesn't so don't get your hopes up. The best thing about this movie is to see...</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="n">raw_datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">features</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">names</span>
<span class="n">labels</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;neg&#39;, &#39;pos&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_cls</span> <span class="o">=</span> <span class="n">AutoModelForSequenceClassification</span>

<span class="n">pretrained_model_name</span> <span class="o">=</span> <span class="s2">&quot;distilroberta-base&quot;</span>  <span class="c1"># &quot;distilbert-base-uncased&quot; &quot;bert-base-uncased&quot;</span>
<span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_config</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">hf_model</span> <span class="o">=</span> <span class="n">BLURR</span><span class="o">.</span><span class="n">get_hf_objects</span><span class="p">(</span><span class="n">pretrained_model_name</span><span class="p">,</span> <span class="n">model_cls</span><span class="o">=</span><span class="n">model_cls</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">set_seed</span><span class="p">()</span>
<span class="n">blocks</span> <span class="o">=</span> <span class="p">(</span><span class="n">HF_TextBlock</span><span class="p">(</span><span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_config</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">hf_model</span><span class="p">,</span> <span class="n">before_batch_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="n">labels</span><span class="p">}),</span> <span class="n">CategoryBlock</span><span class="p">)</span>
<span class="n">dblock</span> <span class="o">=</span> <span class="n">DataBlock</span><span class="p">(</span><span class="n">blocks</span><span class="o">=</span><span class="n">blocks</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">ColReader</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">),</span> <span class="n">get_y</span><span class="o">=</span><span class="n">ColReader</span><span class="p">(</span><span class="s2">&quot;label&quot;</span><span class="p">),</span> <span class="n">splitter</span><span class="o">=</span><span class="n">RandomSplitter</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">dblock</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">imdb_df</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Training">Training<a class="anchor-link" href="#Training"> </a></h4><p>We'll also add in custom summary methods for blurr learners/models that work with dictionary inputs</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">set_seed</span><span class="p">()</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">HF_BaseModelWrapper</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span>
    <span class="n">dls</span><span class="p">,</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="n">opt_func</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">OptimWrapper</span><span class="p">,</span> <span class="n">opt</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">),</span>
    <span class="n">loss_func</span><span class="o">=</span><span class="n">CrossEntropyLossFlat</span><span class="p">(),</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy</span><span class="p">],</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">HF_BaseModelCallback</span><span class="p">],</span>
    <span class="n">splitter</span><span class="o">=</span><span class="n">hf_splitter</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">learn</span><span class="o">.</span><span class="n">freeze</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>.to_fp16()</code> requires a GPU so had to remove for tests to run on github.  Let's check that we can get predictions.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># learn.summary()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">(</span><span class="n">suggest_funcs</span><span class="o">=</span><span class="p">[</span><span class="n">minimum</span><span class="p">,</span> <span class="n">steep</span><span class="p">,</span> <span class="n">valley</span><span class="p">,</span> <span class="n">slide</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(minimum=2.290867705596611e-05, steep=0.0063095735386013985, valley=1.737800812406931e-05, slide=0.00363078061491251)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">set_seed</span><span class="p">()</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.313980</td>
      <td>0.297055</td>
      <td>0.879167</td>
      <td>00:13</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>epoch   train_loss  valid_loss  accuracy    time
0   0.324516    0.294210    0.885000    00:11</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Showing-results">Showing results<a class="anchor-link" href="#Showing-results"> </a></h4><p>And here we create a @typedispatched implementation of <code>Learner.show_results</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">learner</span><span class="o">=</span><span class="n">learn</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">trunc_at</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>target</th>
      <th>prediction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>SPOILERS HEREIN&lt;br /&gt;&lt;br /&gt;My High School did all they could to try and motivate us for exams. But the most memorable method they used to get us into the right state of mind was a guest speaker, who was none other than Australian Kickboxing's favorite son, Stan "The Man" Longinidis. The first mistake they made was giving this guy a microphone, because he was screaming half the time despite us sitting no more than 3 or 4 feet away from him. Now, his speech was full of the usual "if you fail to p</td>
      <td>neg</td>
      <td>neg</td>
    </tr>
    <tr>
      <th>1</th>
      <td>To anyone who hasn't seen this film yet, I have a friendly warning: don't watch "La Casa dell'Orco" expecting any demons at all, because you won't find them here. This film is not a third installment to the "Demons" series and it has nothing to do with it whatsoever, except the fact that Lamberto Bava directed them. As a matter of fact, Michele Soavi's "The Church" is also known an unofficial "Demons 3" and it's a deceptive title in that case as well, so go figure. It is obvious that due to the</td>
      <td>pos</td>
      <td>pos</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">unfreeze</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">set_seed</span><span class="p">()</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mf">1e-7</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.257101</td>
      <td>0.288754</td>
      <td>0.879167</td>
      <td>00:20</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.222599</td>
      <td>0.256741</td>
      <td>0.900000</td>
      <td>00:20</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">recorder</span><span class="o">.</span><span class="n">plot_loss</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">learner</span><span class="o">=</span><span class="n">learn</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">trunc_at</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>target</th>
      <th>prediction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>SPOILERS HEREIN&lt;br /&gt;&lt;br /&gt;My High School did all they could to try and motivate us for exams. But the most memorable method they used to get us into the right state of mind was a guest speaker, who was none other than Australian Kickboxing's favorite son, Stan "The Man" Longinidis. The first mistake they made was giving this guy a microphone, because he was screaming half the time despite us sitting no more than 3 or 4 feet away from him. Now, his speech was full of the usual "if you fail to p</td>
      <td>neg</td>
      <td>neg</td>
    </tr>
    <tr>
      <th>1</th>
      <td>To anyone who hasn't seen this film yet, I have a friendly warning: don't watch "La Casa dell'Orco" expecting any demons at all, because you won't find them here. This film is not a third installment to the "Demons" series and it has nothing to do with it whatsoever, except the fact that Lamberto Bava directed them. As a matter of fact, Michele Soavi's "The Church" is also known an unofficial "Demons 3" and it's a deceptive title in that case as well, so go figure. It is obvious that due to the</td>
      <td>pos</td>
      <td>pos</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Learner.blurr_predict" class="doc_header"><code>Learner.blurr_predict</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/core.py#L185" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Learner.blurr_predict</code>(<strong><code>items</code></strong>, <strong><code>rm_type_tfms</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>items</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>rm_type_tfms</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We need to replace fastai's <code>Learner.predict</code> method with the one above which is able to work with inputs that are represented by multiple tensors included in a dictionary.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">blurr_predict</span><span class="p">(</span><span class="s2">&quot;I really liked the movie&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[([&#39;pos&#39;], (#1) [tensor(1)], (#1) [tensor([0.0693, 0.9307])])]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">blurr_predict</span><span class="p">(</span><span class="s2">&quot;Acting was so bad it was almost funny.&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[([&#39;neg&#39;], (#1) [tensor(0)], (#1) [tensor([0.8087, 0.1913])])]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">blurr_predict</span><span class="p">([</span><span class="s2">&quot;I really liked the movie&quot;</span><span class="p">,</span> <span class="s2">&quot;I really hated the movie&quot;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[([&#39;pos&#39;], (#1) [tensor(1)], (#1) [tensor([0.0693, 0.9307])]),
 ([&#39;neg&#39;], (#1) [tensor(0)], (#1) [tensor([0.6696, 0.3304])])]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Though not useful in sequence classification, we will also add a <code>blurr_generate</code> method to <code>Learner</code> that uses Hugging Face's <code>PreTrainedModel.generate</code> for text generation tasks.</p>
<p>For the full list of arguments you can pass in see <a href="https://huggingface.co/transformers/main_classes/model.html#transformers.PreTrainedModel.generate">here</a>. You can also check out their <a href="https://github.com/huggingface/blog/blob/master/notebooks/02_how_to_generate.ipynb">"How To Generate"</a> notebook for more information about how it all works.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Learner.blurr_generate" class="doc_header"><code>Learner.blurr_generate</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/core.py#L218" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Learner.blurr_generate</code>(<strong><code>inp</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Uses the built-in <code>generate</code> method to generate the text
(see <a href="https://huggingface.co/transformers/main_classes/model.html#transformers.PreTrainedModel.generate">here</a>
for a list of arguments you can pass in)</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>inp</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>kwargs</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Inference">Inference<a class="anchor-link" href="#Inference"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">export_fname</span> <span class="o">=</span> <span class="s2">&quot;seq_class_learn_export&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Using-fast.ai-Learner.export-and-load_learner">Using fast.ai <code>Learner.export</code> and <code>load_learner</code><a class="anchor-link" href="#Using-fast.ai-Learner.export-and-load_learner"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="n">f</span><span class="s2">&quot;</span><span class="si">{export_fname}</span><span class="s2">.pkl&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inf_learn</span> <span class="o">=</span> <span class="n">load_learner</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="n">f</span><span class="s2">&quot;</span><span class="si">{export_fname}</span><span class="s2">.pkl&quot;</span><span class="p">)</span>
<span class="n">inf_learn</span><span class="o">.</span><span class="n">blurr_predict</span><span class="p">(</span><span class="s2">&quot;This movie should not be seen by anyone!!!!&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[([&#39;neg&#39;], (#1) [tensor(0)], (#1) [tensor([0.9229, 0.0771])])]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Using-the-high-level-API">Using the high-level API<a class="anchor-link" href="#Using-the-high-level-API"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Blearner">Blearner<a class="anchor-link" href="#Blearner"> </a></h4><p>Instead of constructing our low-level <code>Learner</code>, we can use the <a href="/blurr/modeling-core.html#Blearner"><code>Blearner</code></a> class which provides sensible defaults for training</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_cls</span> <span class="o">=</span> <span class="n">AutoModelForSequenceClassification</span>

<span class="n">pretrained_model_name</span> <span class="o">=</span> <span class="s2">&quot;distilroberta-base&quot;</span>  <span class="c1"># &quot;distilbert-base-uncased&quot; &quot;bert-base-uncased&quot;</span>
<span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_config</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">hf_model</span> <span class="o">=</span> <span class="n">BLURR</span><span class="o">.</span><span class="n">get_hf_objects</span><span class="p">(</span><span class="n">pretrained_model_name</span><span class="p">,</span> <span class="n">model_cls</span><span class="o">=</span><span class="n">model_cls</span><span class="p">)</span>

<span class="n">dls</span> <span class="o">=</span> <span class="n">dblock</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">imdb_df</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Blearner" class="doc_header"><code>class</code> <code>Blearner</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/core.py#L254" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Blearner</code>(<strong><code>dls</code></strong>:<code>DataLoaders</code>, <strong><code>hf_model</code></strong>:<code>PreTrainedModel</code>, <strong><code>base_model_cb</code></strong>:<a href="/blurr/modeling-core.html#HF_BaseModelCallback"><code>HF_BaseModelCallback</code></a>=<em><code>HF_BaseModelCallback</code></em>, <strong><code>loss_func</code></strong>=<em><code>None</code></em>, <strong><code>opt_func</code></strong>=<em><code>Adam</code></em>, <strong><code>lr</code></strong>=<em><code>0.001</code></em>, <strong><code>splitter</code></strong>=<em><code>trainable_params</code></em>, <strong><code>cbs</code></strong>=<em><code>None</code></em>, <strong><code>metrics</code></strong>=<em><code>None</code></em>, <strong><code>path</code></strong>=<em><code>None</code></em>, <strong><code>model_dir</code></strong>=<em><code>'models'</code></em>, <strong><code>wd</code></strong>=<em><code>None</code></em>, <strong><code>wd_bn_bias</code></strong>=<em><code>False</code></em>, <strong><code>train_bn</code></strong>=<em><code>True</code></em>, <strong><code>moms</code></strong>=<em><code>(0.95, 0.85, 0.95)</code></em>) :: <code>Learner</code></p>
</blockquote>
<p>Group together a <code>model</code>, some <code>dls</code> and a <code>loss_func</code> to handle training</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>dls</code></strong> : <em><code>&lt;class 'fastai.data.core.DataLoaders'&gt;</code></em>   <p>Your fast.ai DataLoaders</p></li>
</ul>
<ul>
<li><strong><code>hf_model</code></strong> : <em><code>&lt;class 'transformers.modeling_utils.PreTrainedModel'&gt;</code></em>   <p>Your pretrained Hugging Face transformer</p></li>
</ul>
<ul>
<li><strong><code>base_model_cb</code></strong> : <em><code>&lt;class 'blurr.modeling.core.HF_BaseModelCallback'&gt;</code></em>, <em>optional</em> <p>Your `HF_BaseModelCallback`</p></li>
</ul>
<ul>
<li><strong><code>kwargs</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">Blearner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">hf_model</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.346937</td>
      <td>0.309959</td>
      <td>0.866667</td>
      <td>00:13</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">learner</span><span class="o">=</span><span class="n">learn</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">trunc_at</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>target</th>
      <th>prediction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>SPOILERS HEREIN&lt;br /&gt;&lt;br /&gt;My High School did all they could to try and motivate us for exams. But the most memorable method they used to get us into the right state of mind was a guest speaker, who was none other than Australian Kickboxing's favorite son, Stan "The Man" Longinidis. The first mistake they made was giving this guy a microphone, because he was screaming half the time despite us sitting no more than 3 or 4 feet away from him. Now, his speech was full of the usual "if you fail to p</td>
      <td>neg</td>
      <td>pos</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ironically the most talked-about American film in the 2008 New York Film Festival is 98% in Spanish. The extra-long film's controversy began at the Cannes Festival. There were love-hate notices, and considerable doubts about commercial prospects. As consolation the star, Benicio Del Toro, got the Best Actor award there. I'm talking about Steven Soderbergh's 'Che,' of course. That's the name it's going by in this version, shown in New York as at Cannes in two 2-hour-plus segments without opening</td>
      <td>pos</td>
      <td>pos</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">blurr_predict</span><span class="p">(</span><span class="s2">&quot;This was a really good movie&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[([&#39;pos&#39;], (#1) [tensor(1)], (#1) [tensor([0.2306, 0.7694])])]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="n">f</span><span class="s2">&quot;</span><span class="si">{export_fname}</span><span class="s2">.pkl&quot;</span><span class="p">)</span>
<span class="n">inf_learn</span> <span class="o">=</span> <span class="n">load_learner</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="n">f</span><span class="s2">&quot;</span><span class="si">{export_fname}</span><span class="s2">.pkl&quot;</span><span class="p">)</span>
<span class="n">inf_learn</span><span class="o">.</span><span class="n">blurr_predict</span><span class="p">(</span><span class="s2">&quot;This movie should not be seen by anyone!!!!&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[([&#39;neg&#39;], (#1) [tensor(0)], (#1) [tensor([0.8056, 0.1944])])]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="BlearnerForSequenceClassification">BlearnerForSequenceClassification<a class="anchor-link" href="#BlearnerForSequenceClassification"> </a></h4><p>We also introduce a task specific <a href="/blurr/modeling-core.html#Blearner"><code>Blearner</code></a> that get you your DataBlock, DataLoaders, and BLearner in one line of code!</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="BlearnerForSequenceClassification" class="doc_header"><code>class</code> <code>BlearnerForSequenceClassification</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/core.py#L278" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>BlearnerForSequenceClassification</code>(<strong><code>dls</code></strong>:<code>DataLoaders</code>, <strong><code>hf_model</code></strong>:<code>PreTrainedModel</code>, <strong><code>base_model_cb</code></strong>:<a href="/blurr/modeling-core.html#HF_BaseModelCallback"><code>HF_BaseModelCallback</code></a>=<em><code>HF_BaseModelCallback</code></em>, <strong><code>loss_func</code></strong>=<em><code>None</code></em>, <strong><code>opt_func</code></strong>=<em><code>Adam</code></em>, <strong><code>lr</code></strong>=<em><code>0.001</code></em>, <strong><code>splitter</code></strong>=<em><code>trainable_params</code></em>, <strong><code>cbs</code></strong>=<em><code>None</code></em>, <strong><code>metrics</code></strong>=<em><code>None</code></em>, <strong><code>path</code></strong>=<em><code>None</code></em>, <strong><code>model_dir</code></strong>=<em><code>'models'</code></em>, <strong><code>wd</code></strong>=<em><code>None</code></em>, <strong><code>wd_bn_bias</code></strong>=<em><code>False</code></em>, <strong><code>train_bn</code></strong>=<em><code>True</code></em>, <strong><code>moms</code></strong>=<em><code>(0.95, 0.85, 0.95)</code></em>) :: <a href="/blurr/modeling-core.html#Blearner"><code>Blearner</code></a></p>
</blockquote>
<p>Group together a <code>model</code>, some <code>dls</code> and a <code>loss_func</code> to handle training</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>dls</code></strong> : <em><code>&lt;class 'fastai.data.core.DataLoaders'&gt;</code></em></p>
</li>
<li><p><strong><code>hf_model</code></strong> : <em><code>&lt;class 'transformers.modeling_utils.PreTrainedModel'&gt;</code></em></p>
</li>
<li><p><strong><code>kwargs</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">BlearnerForSequenceClassification</span><span class="o">.</span><span class="n">from_dataframe</span><span class="p">(</span>
    <span class="n">imdb_df</span><span class="p">,</span> <span class="s2">&quot;distilroberta-base&quot;</span><span class="p">,</span> <span class="n">text_attr</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">label_attr</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">dl_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bs&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>f1_score</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.341678</td>
      <td>0.333333</td>
      <td>0.832487</td>
      <td>0.835000</td>
      <td>00:13</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">learner</span><span class="o">=</span><span class="n">learn</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">trunc_at</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>target</th>
      <th>prediction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Pete's Meteor. I seen this referred to as "authentic" and a "gem." I caught this movie on a Saturday afternoon. I kinda wished that I didn't.&lt;br /&gt;&lt;br /&gt;Apparently this was noted as being Mike Myers' first dramatic role. Unfortunately it had to be this movie. The first thing you'll notice that Pete's Meteor suffers from is a complete lack of plot. Or rather, a bunch of little subplots that aren't really connected and don't go anywhere. Young orphan Mickey lives with his younger brother and sist</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>I remember seeing the very first trailer for Underdog back last March, I also remember at the time smiling to myself ever so slightly. Sure it was a cheesy idea, but I genuinely thought at the time the concept might work, hell it couldn't be any worse than the disappointing Cats and Dogs could it? Then by December and I suddenly remembered the film I realised how likely the film was to suck, the fact it had been delayed in the UK made it seem inevitable it would be terrible, but the horrendous</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">blurr_predict</span><span class="p">(</span><span class="s2">&quot;This was a really good movie&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[((&#39;1&#39;,), (#1) [tensor(1)], (#1) [tensor([0.1480, 0.8520])])]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="n">f</span><span class="s2">&quot;</span><span class="si">{export_fname}</span><span class="s2">.pkl&quot;</span><span class="p">)</span>
<span class="n">inf_learn</span> <span class="o">=</span> <span class="n">load_learner</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="n">f</span><span class="s2">&quot;</span><span class="si">{export_fname}</span><span class="s2">.pkl&quot;</span><span class="p">)</span>
<span class="n">inf_learn</span><span class="o">.</span><span class="n">blurr_predict</span><span class="p">(</span><span class="s2">&quot;This movie should not be seen by anyone!!!!&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[((&#39;0&#39;,), (#1) [tensor(0)], (#1) [tensor([0.7404, 0.2596])])]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Using-the-low-level-API">Using the low-level API<a class="anchor-link" href="#Using-the-low-level-API"> </a></h3><p>Thanks to the <a href="/blurr/data-core.html#BlurrDataLoader"><code>BlurrDataLoader</code></a>, there isn't really anything you have to do to use plain ol' PyTorch or fast.ai <code>Dataset</code>s and <code>DataLoaders</code> with Blurr.  Let's take a look at fine-tuning a model against Glue's MRPC dataset ...</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_cls</span> <span class="o">=</span> <span class="n">AutoModelForSequenceClassification</span>

<span class="n">pretrained_model_name</span> <span class="o">=</span> <span class="s2">&quot;distilroberta-base&quot;</span>  <span class="c1"># &quot;distilbert-base-uncased&quot; &quot;bert-base-uncased&quot;</span>
<span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_config</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">hf_model</span> <span class="o">=</span> <span class="n">BLURR</span><span class="o">.</span><span class="n">get_hf_objects</span><span class="p">(</span><span class="n">pretrained_model_name</span><span class="p">,</span> <span class="n">model_cls</span><span class="o">=</span><span class="n">model_cls</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">datasets</span> <span class="k">import</span> <span class="n">load_dataset</span>
<span class="kn">from</span> <span class="nn">blurr.data.core</span> <span class="k">import</span> <span class="n">preproc_hf_dataset</span>

<span class="n">raw_datasets</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;glue&quot;</span><span class="p">,</span> <span class="s2">&quot;mrpc&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Reusing dataset glue (/home/wgilliam/.cache/huggingface/datasets/glue/mrpc/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">tokenize_function</span><span class="p">(</span><span class="n">example</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">hf_tokenizer</span><span class="p">(</span><span class="n">example</span><span class="p">[</span><span class="s2">&quot;sentence1&quot;</span><span class="p">],</span> <span class="n">example</span><span class="p">[</span><span class="s2">&quot;sentence2&quot;</span><span class="p">],</span> <span class="n">truncation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="n">tokenized_datasets</span> <span class="o">=</span> <span class="n">raw_datasets</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">tokenize_function</span><span class="p">,</span> <span class="n">batched</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">label_names</span> <span class="o">=</span> <span class="n">raw_datasets</span><span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">features</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">names</span>

<span class="n">trn_dl</span> <span class="o">=</span> <span class="n">BlurrDataLoader</span><span class="p">(</span>
    <span class="n">tokenized_datasets</span><span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">],</span>
    <span class="n">hf_arch</span><span class="o">=</span><span class="n">hf_arch</span><span class="p">,</span>
    <span class="n">hf_config</span><span class="o">=</span><span class="n">hf_config</span><span class="p">,</span>
    <span class="n">hf_tokenizer</span><span class="o">=</span><span class="n">hf_tokenizer</span><span class="p">,</span>
    <span class="n">hf_model</span><span class="o">=</span><span class="n">hf_model</span><span class="p">,</span>
    <span class="n">preproccesing_func</span><span class="o">=</span><span class="n">preproc_hf_dataset</span><span class="p">,</span>
    <span class="n">batch_tfm_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;labels&#39;</span><span class="p">:</span> <span class="n">label_names</span><span class="p">},</span>
    <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">val_dl</span> <span class="o">=</span> <span class="n">BlurrDataLoader</span><span class="p">(</span>
    <span class="n">tokenized_datasets</span><span class="p">[</span><span class="s2">&quot;validation&quot;</span><span class="p">],</span>
    <span class="n">hf_arch</span><span class="o">=</span><span class="n">hf_arch</span><span class="p">,</span>
    <span class="n">hf_config</span><span class="o">=</span><span class="n">hf_config</span><span class="p">,</span>
    <span class="n">hf_tokenizer</span><span class="o">=</span><span class="n">hf_tokenizer</span><span class="p">,</span>
    <span class="n">hf_model</span><span class="o">=</span><span class="n">hf_model</span><span class="p">,</span>
    <span class="n">preproccesing_func</span><span class="o">=</span><span class="n">preproc_hf_dataset</span><span class="p">,</span>
    <span class="n">batch_tfm_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;labels&#39;</span><span class="p">:</span> <span class="n">label_names</span><span class="p">},</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">dls</span> <span class="o">=</span> <span class="n">DataLoaders</span><span class="p">(</span><span class="n">trn_dl</span><span class="p">,</span> <span class="n">val_dl</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">BlearnerForSequenceClassification</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">hf_model</span><span class="p">,</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">HF_PreCalculatedLoss</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(valley=0.00010964782268274575)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.513924</td>
      <td>0.461048</td>
      <td>00:13</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">unfreeze</span><span class="p">()</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mf">1e-8</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.524431</td>
      <td>0.461661</td>
      <td>00:26</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.490433</td>
      <td>0.460616</td>
      <td>00:26</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">learner</span><span class="o">=</span><span class="n">learn</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">trunc_at</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>target</th>
      <th>prediction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Spansion products are to be available from both AMD and Fujitsu, AMD said. Spansion Flash memory solutions are available worldwide from AMD and Fujitsu.</td>
      <td>equivalent</td>
      <td>equivalent</td>
    </tr>
    <tr>
      <th>1</th>
      <td>However, EPA officials would not confirm the 20 percent figure. Only in the past few weeks have officials settled on the 20 percent figure.</td>
      <td>not_equivalent</td>
      <td>not_equivalent</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tests">Tests<a class="anchor-link" href="#Tests"> </a></h2><p>The tests below to ensure the core training code above works for <strong>all</strong> pretrained sequence classification models available in Hugging Face.  These tests are excluded from the CI workflow because of how long they would take to run and the amount of data that would be required to download.</p>
<p><strong>Note</strong>: Feel free to modify the code below to test whatever pretrained classification models you are working with ... and if any of your pretrained sequence classification models fail, please submit a github issue <em>(or a PR if you'd like to fix it yourself)</em></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>arch</th>
      <th>tokenizer</th>
      <th>model</th>
      <th>result</th>
      <th>error</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>albert</td>
      <td>AlbertTokenizerFast</td>
      <td>AlbertForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>bart</td>
      <td>BartTokenizerFast</td>
      <td>BartForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>bert</td>
      <td>BertTokenizerFast</td>
      <td>BertForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>big_bird</td>
      <td>BigBirdTokenizerFast</td>
      <td>BigBirdForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>bigbird_pegasus</td>
      <td>PegasusTokenizerFast</td>
      <td>BigBirdPegasusForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>5</th>
      <td>ctrl</td>
      <td>CTRLTokenizer</td>
      <td>CTRLForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>6</th>
      <td>camembert</td>
      <td>CamembertTokenizerFast</td>
      <td>CamembertForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>7</th>
      <td>canine</td>
      <td>CanineTokenizer</td>
      <td>CanineForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>8</th>
      <td>convbert</td>
      <td>ConvBertTokenizerFast</td>
      <td>ConvBertForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>9</th>
      <td>deberta</td>
      <td>DebertaTokenizerFast</td>
      <td>DebertaForSequenceClassification</td>
      <td>FAILED</td>
      <td>mat1 and mat2 shapes cannot be multiplied (2x32 and 768x768)</td>
    </tr>
    <tr>
      <th>10</th>
      <td>deberta_v2</td>
      <td>DebertaV2Tokenizer</td>
      <td>DebertaV2ForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>11</th>
      <td>distilbert</td>
      <td>DistilBertTokenizerFast</td>
      <td>DistilBertForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>12</th>
      <td>electra</td>
      <td>ElectraTokenizerFast</td>
      <td>ElectraForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>13</th>
      <td>fnet</td>
      <td>FNetTokenizerFast</td>
      <td>FNetForSequenceClassification</td>
      <td>FAILED</td>
      <td>forward() got an unexpected keyword argument 'output_attentions'</td>
    </tr>
    <tr>
      <th>14</th>
      <td>flaubert</td>
      <td>FlaubertTokenizer</td>
      <td>FlaubertForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>15</th>
      <td>funnel</td>
      <td>FunnelTokenizerFast</td>
      <td>FunnelForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>16</th>
      <td>gpt2</td>
      <td>GPT2TokenizerFast</td>
      <td>GPT2ForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>17</th>
      <td>gptj</td>
      <td>GPT2TokenizerFast</td>
      <td>GPTJForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>18</th>
      <td>gpt_neo</td>
      <td>GPT2TokenizerFast</td>
      <td>GPTNeoForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>19</th>
      <td>ibert</td>
      <td>RobertaTokenizer</td>
      <td>IBertForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>20</th>
      <td>led</td>
      <td>LEDTokenizerFast</td>
      <td>LEDForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>21</th>
      <td>longformer</td>
      <td>LongformerTokenizerFast</td>
      <td>LongformerForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>22</th>
      <td>mbart</td>
      <td>MBartTokenizerFast</td>
      <td>MBartForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>23</th>
      <td>mpnet</td>
      <td>MPNetTokenizerFast</td>
      <td>MPNetForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>24</th>
      <td>mobilebert</td>
      <td>MobileBertTokenizerFast</td>
      <td>MobileBertForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>25</th>
      <td>openai</td>
      <td>OpenAIGPTTokenizerFast</td>
      <td>OpenAIGPTForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>26</th>
      <td>reformer</td>
      <td>ReformerTokenizerFast</td>
      <td>ReformerForSequenceClassification</td>
      <td>FAILED</td>
      <td>If training, make sure that config.axial_pos_shape factors: (512, 1024) multiply to sequence length. Got prod((512, 1024)) != sequence_length: 32. You might want to consider padding your sequence length to 524288 or changing config.axial_pos_shape.</td>
    </tr>
    <tr>
      <th>27</th>
      <td>rembert</td>
      <td>RemBertTokenizerFast</td>
      <td>RemBertForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>28</th>
      <td>roformer</td>
      <td>RoFormerTokenizerFast</td>
      <td>RoFormerForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>29</th>
      <td>roberta</td>
      <td>RobertaTokenizerFast</td>
      <td>RobertaForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>30</th>
      <td>squeezebert</td>
      <td>SqueezeBertTokenizerFast</td>
      <td>SqueezeBertForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>31</th>
      <td>transfo_xl</td>
      <td>TransfoXLTokenizer</td>
      <td>TransfoXLForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>32</th>
      <td>xlm</td>
      <td>XLMTokenizer</td>
      <td>XLMForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>33</th>
      <td>xlm_roberta</td>
      <td>XLMRobertaTokenizerFast</td>
      <td>XLMRobertaForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>34</th>
      <td>xlnet</td>
      <td>XLNetTokenizerFast</td>
      <td>XLNetForSequenceClassification</td>
      <td>PASSED</td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This module includes the fundamental building blocks for training using Blurr</p>

</div>
</div>
</div>
</div>
 

